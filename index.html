<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£ 2569</title>
  
  <!-- CSS Libs -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.11.0/dist/sweetalert2.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;800&display=swap" rel="stylesheet">

  <style>
    :root { --primary: #004085; --secondary: #6610f2; }
    body { font-family: 'Sarabun', sans-serif; background: #f4f7f6; padding-top: 80px; }
    .main-card { border-radius: 20px; border: none; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
    .banner { background: linear-gradient(135deg, #001a4d 0%, #6610f2 100%); color: white; padding: 40px 20px; border-radius: 20px 20px 0 0; text-align: center; }
    .camera-box { width: 200px; height: 200px; border-radius: 50%; border: 5px solid white; overflow: hidden; margin: 0 auto 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); position: relative; background: #eee; }
    #webcam { width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); }
  </style>
</head>
<body>

  <div id="app" class="container">
    <nav class="navbar navbar-expand-lg fixed-top bg-white shadow-sm">
      <div class="container">
        <a class="navbar-brand fw-bold text-primary" href="#"><i class="fa-solid fa-user-nurse me-2"></i>Conference 2026</a>
      </div>
    </nav>

    <div class="row justify-content-center">
      <div class="col-md-8">
        <div class="card main-card mb-5">
          <div class="banner">
            <h2 class="fw-800">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•</h2>
            <p class="mb-0">‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå</p>
          </div>

          <div class="card-body p-4 p-md-5">
            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á -->
            <div class="text-center mb-4">
              <div class="camera-box">
                <video v-show="isCameraActive" id="webcam" autoplay playsinline></video>
                <img v-if="profilePreview" :src="profilePreview" style="width:100%; height:100%; object-fit:cover; position:absolute; top:0; left:0;">
                <div v-if="!isCameraActive && !profilePreview" class="h-100 d-flex align-items-center justify-content-center">
                  <i class="fa-solid fa-camera fa-3x text-muted opacity-50"></i>
                </div>
              </div>
              
              <button v-if="!isCameraActive" @click="startWebcam" class="btn btn-outline-primary rounded-pill px-4">
                <i class="fa-solid fa-video me-2"></i>‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ
              </button>
              <button v-else @click="capturePhoto" class="btn btn-success rounded-pill px-4">
                <i class="fa-solid fa-camera me-2"></i>‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
              </button>
            </div>

            <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label fw-bold">‡∏ä‡∏∑‡πà‡∏≠</label>
                <input type="text" v-model="form.firstName" class="form-control" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢">
              </div>
              <div class="col-md-6">
                <label class="form-label fw-bold">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                <input type="text" v-model="form.lastName" class="form-control" placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢">
              </div>
              <div class="col-12">
                <label class="form-label fw-bold">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                <input type="email" v-model="form.email" class="form-control" placeholder="example@gmail.com">
              </div>
            </div>

            <div class="text-center mt-5">
              <button @click="submitData" :disabled="loading" class="btn btn-primary btn-lg rounded-pill px-5 shadow">
                <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span>
                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <canvas id="canvas" class="d-none"></canvas>
  </div>

  <!-- JS Libs -->
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.11.0/dist/sweetalert2.all.min.js"></script>
  <script src="https://unpkg.com/webcam-easy/dist/webcam-easy.min.js"></script>

  <script>
    // üî¥ 1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏ß‡∏≤‡∏á URL /exec ‡∏Ç‡∏≠‡∏á Google Script ‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
    const GAS_URL = "https://script.google.com/macros/s/AKfycbzfOu3S0v5_u0XJi-IdwTIx6HecySKswYFt05wjfCBbu5pyEYy2LPsFSUkL7d4dmdVK/exec";

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Script
    const callGAS = async (action, data = null) => {
      const response = await fetch(GAS_URL, {
        method: 'POST',
        body: JSON.stringify({ action, data })
      });
      return await response.json();
    };

    const { createApp, ref, onMounted } = Vue;

    createApp({
      setup() {
        const form = ref({ firstName: '', lastName: '', email: '' });
        const loading = ref(false);
        const isCameraActive = ref(false);
        const profilePreview = ref(null);
        let webcam = null;

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á (‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô GitHub ‡πÑ‡∏î‡πâ 100%)
        const startWebcam = async () => {
          isCameraActive.value = true;
          try {
            // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô
            await navigator.mediaDevices.getUserMedia({ video: true });
            const webcamElement = document.getElementById('webcam');
            const canvasElement = document.getElementById('canvas');
            webcam = new Webcam(webcamElement, 'user', canvasElement);
            await webcam.start();
          } catch (err) {
            Swal.fire("Error", "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ: " + err.message, "error");
            isCameraActive.value = false;
          }
        };

        // ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ
        const capturePhoto = () => {
          const photo = webcam.snap();
          profilePreview.value = photo;
          webcam.stop();
          isCameraActive.value = false;
        };

        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        const submitData = async () => {
          if(!form.value.firstName) return Swal.fire("‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô", "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠", "warning");
          loading.value = true;
          
          const res = await callGAS('processForm', {
            ...form.value,
            profilePreview: profilePreview.value
          });

          loading.value = false;
          if (res.success) {
            Swal.fire("‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", res.message, "success").then(() => location.reload());
          } else {
            Swal.fire("‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", res.message, "error");
          }
        };

        return { form, loading, isCameraActive, profilePreview, startWebcam, capturePhoto, submitData };
      }
    }).mount('#app');
  </script>
</body>
</html>
