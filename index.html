<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πà‡∏á‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á</title>

  <!-- ================= LIBRARIES (CDN) ================= -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!--===== Library JS =====-->
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- SheetJS (xlsx)-->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <style>
    /* ================= 1. VARIABLES & GLOBAL CONFIG ================= */
    :root {
      /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ò‡∏µ‡∏° ‡πÇ‡∏ó‡∏ô‡∏°‡πà‡∏ß‡∏á */
      --primary-color: #6a1b9a;
      /* ‡∏°‡πà‡∏ß‡∏á‡πÄ‡∏Ç‡πâ‡∏°‡∏´‡∏•‡∏±‡∏Å */
      --secondary-color: #4a148c;
      /* ‡∏°‡πà‡∏ß‡∏á‡πÄ‡∏Ç‡πâ‡∏°‡∏û‡∏¥‡πÄ‡∏®‡∏© */
      --bg-gradient-start: #7b1fa2;
      /* ‡∏°‡πà‡∏ß‡∏á‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Gradient */
      --bg-gradient-end: #4a148c;
      /* ‡∏°‡πà‡∏ß‡∏á‡πÄ‡∏Ç‡πâ‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Gradient */
      --bg-body: #f3f0f7;
      /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏ó‡∏≤‡∏≠‡∏°‡∏°‡πà‡∏ß‡∏á‡∏à‡∏≤‡∏á‡πÜ */
      --text-main: #333;

      /* Status Colors */
      --color-success: #2e7d32;
      --color-warning: #f57f17;
      --color-danger: #c62828;

      /* Layout */
      --font-family: 'Sarabun', sans-serif;

      /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà */
      /* --w-ward-name: ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö ‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏≠‡∏á */

      --w-capacity: 3.0%;
      /* 2. ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡πÄ‡∏ï‡πá‡∏° (3 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå) */
      --w-patients: 4.5%;
      /* 3. ‡∏¢‡∏≠‡∏î‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ */
      --w-empty: 3.0%;
      /* 4. ‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡∏ß‡πà‡∏≤‡∏á */
      --w-critical-vent: 6.5%;
      /* 5. ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå Vent/ECMO/CRRT  */
      --w-critical-hold: 3.5%;
      /* 6. ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡∏Ñ‡∏á‡∏Ñ‡πâ‡∏≤‡∏á ICU  */
      --w-surgery: 3.2%;
      /* 7. ‡∏ú‡πà‡∏≤‡∏ï‡∏±‡∏î (2 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå) */

      /* ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á */
      --w-reduction: 2.8%;
      /* 8. ‡∏õ‡∏£‡∏±‡∏ö‡∏•‡∏î‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á (4 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå) */
      --w-remaining: 2.8%;
      /* 9. ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (4 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå) */
      --w-workload: 2.8%;
      /* 10. ‡∏†‡∏≤‡∏£‡∏∞‡∏á‡∏≤‡∏ô (8 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå) */
    }

    /* ‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô HTML ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
    .col-ward {
      width: auto !important;
    }

    .col-grp-cap {
      width: var(--w-capacity) !important;
    }

    .col-grp-patients {
      width: var(--w-patients) !important;
    }

    .col-grp-empty {
      width: var(--w-empty) !important;
    }

    .col-grp-crit-vent {
      width: var(--w-critical-vent) !important;
    }

    .col-grp-crit-hold {
      width: var(--w-critical-hold) !important;
    }

    .col-grp-surg {
      width: var(--w-surgery) !important;
    }

    .col-grp-red {
      width: var(--w-reduction) !important;
    }

    .col-grp-rem {
      width: var(--w-remaining) !important;
    }

    .col-grp-work {
      width: var(--w-workload) !important;
    }

    .badge-time-close {
      color: #0d47a1;
      background: #e3f2fd;
      padding: 3px 10px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      border: 1px solid #bbdefb;
      display: inline-flex;
      align-items: center;
    }

    body {
      font-family: var(--font-family);
      background-color: var(--bg-body);
      color: var(--text-main);
      font-size: 14px;
      overflow-x: hidden;
      /* ‡∏ã‡πà‡∏≠‡∏ô Scrollbar ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
    }

    /* ================= 2. NAVBAR & LAYOUT ================= */
    .navbar-custom {
      background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
      padding: 0.6rem 1rem;
      transition: all 0.3s ease;
    }

    .navbar-brand {
      font-weight: 800;
      font-size: 1.35rem;
      letter-spacing: 0.5px;
      color: #fff !important;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .navbar-nav .nav-link {
      color: rgba(255, 255, 255, 0.85) !important;
      border-radius: 50px;
      padding: 8px 16px !important;
      margin: 0 4px;
      transition: all 0.2s ease-in-out;
      font-weight: 500;
    }

    .navbar-nav .nav-link:hover {
      color: #fff !important;
      background-color: rgba(255, 255, 255, 0.15);
      transform: translateY(-1px);
    }

    .navbar-nav .nav-link.active {
      color: var(--primary-color) !important;
      background-color: #fff;
      font-weight: 700;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    /* ‡πÄ‡∏°‡∏ô‡∏π‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå */
    .user-dropdown .dropdown-toggle {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white !important;
      border-radius: 50px;
      padding: 6px 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .user-dropdown .dropdown-toggle:hover,
    .user-dropdown.show .dropdown-toggle {
      background: rgba(255, 255, 255, 0.2);
      color: white !important;
    }

    .dropdown-menu-custom {
      border: none;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      margin-top: 10px;
      overflow: hidden;
    }

    .dropdown-item {
      padding: 10px 20px;
      font-size: 0.9rem;
      transition: background 0.2s;
    }

    .dropdown-item:hover {
      background-color: #f0f7ff;
      color: var(--primary-color);
    }

    .dropdown-item i {
      width: 20px;
      text-align: center;
      margin-right: 8px;
    }

    /* Mobile Responsive */
    @media (max-width: 991px) {
      .navbar-collapse {
        background: rgba(0, 0, 0, 0.9);
        backdrop-filter: blur(10px);
        margin-top: 15px;
        padding: 15px;
        border-radius: 15px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .navbar-nav .nav-link {
        margin-bottom: 5px;
        border-radius: 8px;
      }

      .user-dropdown {
        margin-top: 15px;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
        padding-top: 15px;
      }

      .user-dropdown .dropdown-toggle {
        width: 100%;
        justify-content: center;
      }
    }

    /* [MODIFIED] Container Layout - ‡πÄ‡∏ß‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏ã‡πâ‡∏≤‡∏¢‡∏Ç‡∏ß‡∏≤ */
    .container-wide {
      width: 98% !important;
      /* ‡∏Å‡∏ß‡πâ‡∏≤‡∏á 98% ‡∏Ç‡∏≠‡∏á‡∏à‡∏≠ */
      max-width: 100% !important;
      margin: 0 auto !important;
      /* ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á */
      padding: 0 !important;
    }

    /* ================= 3. CARDS & SECTIONS ================= */
    .card {
      border: none;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      margin-bottom: 15px;
    }

    .card-header {
      background-color: #fff;
      border-bottom: 2px solid #f0f0f0;
      font-weight: 600;
      border-radius: 8px 8px 0 0 !important;
      padding: 10px 15px;
    }

    .section-title {
      font-size: 1rem;
      color: var(--primary-color);
      font-weight: 700;

      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;

      border-left: 5px solid var(--primary-color);
      padding: 6px 10px;
      margin-bottom: 15px;

      background-color: #eef5fa;
      border-radius: 0 6px 6px 0;
    }

    /* ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏≠‡∏á / ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ */
    .section-title .sub-note {
      font-size: 0.75rem;
      font-weight: 400;
      color: #dc3545;
      /* bootstrap danger */
      margin-left: 6px;
    }

    /* ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤ (‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£) */
    .section-title .right-info {
      font-size: 0.9rem;
      font-weight: 600;
      color: #495057;
      white-space: nowrap;
    }

    .section-title .right-info span {
      margin-left: 12px;
    }

    /* ================= 4. FORMS ================= */
    .form-label {
      font-weight: 600;
      color: #495057;
      font-size: 0.85rem;
      margin-bottom: 0.2rem;
    }

    .form-control,
    .form-select {
      font-size: 0.9rem;
      padding: 0.4rem 0.7rem;
    }

    /* ============================================================ */
    /* [FIX] ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏µ Placeholder ‡πÉ‡∏´‡πâ‡∏à‡∏≤‡∏á‡∏•‡∏á ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏≤ */
    /* ============================================================ */
    .form-control::placeholder {
      color: #adb5bd !important;
      /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏à‡∏≤‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô Bootstrap */
      opacity: 1 !important;
      /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ Opacity (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Firefox) */
      font-weight: 400 !important;
      /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏ö‡∏≤‡∏á (‡πÅ‡∏°‡πâ Input ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô fw-bold) */
      font-size: 0.9em;
      /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á */
    }

    /* ‡∏Å‡∏£‡∏ì‡∏µ Browser ‡πÄ‡∏Å‡πà‡∏≤ (Webkit/Edge) */
    .form-control::-webkit-input-placeholder {
      color: #adb5bd !important;
      font-weight: 400 !important;
    }

    /* ‡∏Å‡∏£‡∏ì‡∏µ Browser ‡πÄ‡∏Å‡πà‡∏≤ (Moz) */
    .form-control:-moz-placeholder {
      color: #adb5bd !important;
      opacity: 1 !important;
      font-weight: 400 !important;
    }

    /* ================= 5. TABLES (DASHBOARD - HEADER WRAP ONLY) ================= */

    /* Table Layout - ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏û‡∏≠‡∏î‡∏µ‡∏à‡∏≠ */
    .table-dashboard {
      width: 100% !important;
      table-layout: fixed;
      /* ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏î‡∏±‡∏ô‡∏à‡∏ô‡∏•‡πâ‡∏ô */
      border-collapse: collapse;
      border-spacing: 0;
      font-size: 10px !important;
      /* ‡∏•‡∏î‡∏Ç‡∏ô‡∏≤‡∏î Font ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ô‡πà‡∏ô‡πÜ ‡∏û‡∏≠‡∏î‡∏µ‡∏à‡∏≠ */
    }

    /* ============================================================ */
    /* [NEW] ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á Dashboard ‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô */
    /* ============================================================ */

    /* 1. ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÅ‡∏£‡∏Å: "‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô" */
    .table-dashboard tbody td:first-child {
      font-size: 14px !important;
      /* <-- ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏∂‡∏Å‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ */
      font-weight: 600 !important;
      /* ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤ (600=‡∏Å‡∏∂‡πà‡∏á‡∏´‡∏ô‡∏≤, 700=‡∏´‡∏ô‡∏≤‡∏°‡∏≤‡∏Å) */
      color: #000;
      /* ‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ */
      padding-left: 0.75rem !important;
      /* ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏£‡∏∞‡∏¢‡∏∞ ms-3 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô */
      text-align: left !important;
      /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢ */
    }

    /* 2. ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ: "‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•" */
    .table-dashboard tbody td:not(:first-child) {
      font-size: 14px !important;
      /* <-- ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ 12-14px) */
      font-weight: 700 !important;
      /* ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡πâ‡∏´‡∏ô‡∏≤‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ */
      letter-spacing: -0.3px;
      /* ‡∏ö‡∏µ‡∏ö‡∏ä‡πà‡∏≠‡∏á‡πÑ‡∏ü‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏Ç‡πÄ‡∏¢‡∏≠‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÑ‡∏°‡πà‡∏•‡πâ‡∏ô */
    }

    /* ----------------------------------------------------------- */
    /* 1. ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ "‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á (TH)" */
    /* ----------------------------------------------------------- */
    .table-dashboard th {
      background-color: #e9ecef;
      vertical-align: middle;
      text-align: center;
      padding: 8px 3px !important;
      /* ‡πÄ‡∏î‡∏¥‡∏° 3px -> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 8px ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏î‡∏π‡πÑ‡∏°‡πà‡∏≠‡∏∂‡∏î‡∏≠‡∏±‡∏î */
      line-height: 1.4 !important;
      /* ‡πÄ‡∏î‡∏¥‡∏° 1.1 -> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 1.4 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏™‡∏£‡∏∞/‡∏ß‡∏£‡∏£‡∏ì‡∏¢‡∏∏‡∏Å‡∏ï‡πå */
      border: 1px solid #dee2e6;
      white-space: normal !important;
      overflow: visible !important;
      text-overflow: clip !important;
      word-wrap: break-word;
    }

    /* ----------------------------------------------------------- */
    /* 2. ‡∏™‡πà‡∏ß‡∏ô "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (TD)" */
    /* ----------------------------------------------------------- */
    .table-dashboard td {
      vertical-align: middle;
      padding: 6px 3px !important;
      /* ‡πÄ‡∏î‡∏¥‡∏° 3px -> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 6px */
      line-height: 1.4 !important;
      /* ‡πÄ‡∏î‡∏¥‡∏° 1.1 -> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 1.4 */
      border: 1px solid #dee2e6;
      white-space: nowrap !important;
      overflow: hidden !important;
      text-overflow: ellipsis !important;
    }

    /* ============================================================ */
    /* [NEW] ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á (Thead) ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô */
    /* ============================================================ */

    /* 1. ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ (‡∏°‡∏∏‡∏°‡∏ã‡πâ‡∏≤‡∏¢‡∏ö‡∏ô) - ‡πÉ‡∏´‡πâ‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î */
    .table-dashboard thead th:first-child {
      font-size: 14px !important;
      font-weight: 900 !important;
      color: #000;
    }

    /* 2. ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏´‡∏•‡∏±‡∏Å (‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 2) */
    /* ‡πÄ‡∏ä‡πà‡∏ô "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡πÄ‡∏ï‡πá‡∏°", "‡∏õ‡∏£‡∏±‡∏ö‡∏•‡∏î‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á", "‡∏†‡∏≤‡∏£‡∏∞‡∏á‡∏≤‡∏ô" -> ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏ç‡πà‡∏£‡∏≠‡∏á‡∏•‡∏á‡∏°‡∏≤ */
    .table-dashboard thead tr:nth-child(2) th {
      font-size: 13px !important;
      font-weight: 800 !important;
      color: #333;
    }

    /* 3. ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏¢‡πà‡∏≠‡∏¢ (‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 3) */
    /* ‡πÄ‡∏ä‡πà‡∏ô "‡∏™‡∏≤‡∏°‡∏±‡∏ç", "‡∏û‡∏¥‡πÄ‡∏®‡∏©", "‡πÄ‡∏ß‡∏£‡∏ö‡πà‡∏≤‡∏¢", "‡πÄ‡∏ß‡∏£‡∏î‡∏∂‡∏Å" -> ‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏•‡∏≤‡∏á */
    .table-dashboard thead tr:nth-child(3) th {
      font-size: 11px !important;
      font-weight: 700 !important;
      color: #444;
    }

    /* 4. ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î (‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 4) */
    /* ‡πÄ‡∏ä‡πà‡∏ô "RN", "PN", "‡∏£‡∏±‡∏ö‡πÉ‡∏´‡∏°‡πà", "‡∏¢‡πâ‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å" -> ‡πÄ‡∏•‡πá‡∏Å‡∏™‡∏∏‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏•‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÅ‡∏Ñ‡∏ö‡πÑ‡∏î‡πâ */
    .table-dashboard thead tr:nth-child(4) th {
      font-size: 10px !important;
      font-weight: 600 !important;
      letter-spacing: -0.2px;
      /* ‡∏ö‡∏µ‡∏ö‡∏ä‡πà‡∏≠‡∏á‡πÑ‡∏ü‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
      color: #555;
    }

    .main-line-header {
      background: linear-gradient(to right, #1565c0, var(--secondary-color)) !important;
      color: white !important;
      padding: 6px 10px !important;
      font-size: 1rem !important;
      font-weight: bold;
      border-radius: 4px 4px 0 0;
      border-bottom: 2px solid #002171;
      text-transform: uppercase;
    }

    .group-header-row td {
      /* ‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡πÑ‡∏•‡πà‡πÄ‡∏â‡∏î‡∏™‡∏µ‡∏à‡∏≤‡∏Å‡∏ü‡πâ‡∏≤‡∏≠‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏Ç‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏°‡∏µ‡∏°‡∏¥‡∏ï‡∏¥ */
      background: linear-gradient(to right, #e3f2fd, #ffffff) !important;
      color: #0d47a1 !important;
      /* ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢ */
      font-size: 13px !important;
      /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
      font-weight: 800 !important;
      padding: 8px 15px !important;
      /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÉ‡∏à */

      /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏ã‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏´‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ô‡πâ‡∏ô‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏° */
      border-left: 5px solid #1976d2 !important;
      border-top: 2px solid #90caf9 !important;
      border-bottom: 2px solid #90caf9 !important;

      text-transform: uppercase;
      /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏∂‡πâ‡∏ô (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©) */
      letter-spacing: 0.5px;
    }

    /* Highlight */
    .table-hover tbody tr:hover>td,
    .table-hover tbody tr:hover>th {
      background-color: #e2e6ea !important;
    }

    .col-highlight {
      background-color: #e2e6ea !important;
    }

    .table-hover tbody tr:hover>td.col-highlight {
      background-color: #c5d7f2 !important;
      font-weight: bold;
      border: 2px solid var(--secondary-color) !important;
    }

    /* ============================================================ */
    /* [NEW] ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡∏¢‡∏≠‡∏î‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ (Metric Highlight) */
    /* ============================================================ */
    /* ‡∏Ñ‡∏•‡∏≤‡∏™‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á 3 ‡∏™‡∏µ) */
    .metric-highlight {
      border-radius: 6px;
      padding: 1px 8px;
      font-weight: 800 !important;
      font-size: 14px !important;
      display: inline-block;
      min-width: 35px;
      text-align: center;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
    }

    /* ‡∏™‡∏µ‡∏ü‡πâ‡∏≤ - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏¢‡∏≠‡∏î‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ (‡∏õ‡∏Å‡∏ï‡∏¥) */
    .metric-blue {
      color: #0d47a1;
      background-color: #e3f2fd;
      border: 1px solid #90caf9;
    }

    /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡∏ß‡πà‡∏≤‡∏á (‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á) */
    .metric-green {
      color: #2e7d32;
      background-color: #e8f5e9;
      border: 1px solid #a5d6a7;
    }

    /* ‡∏™‡∏µ‡πÅ‡∏î‡∏á - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡∏•‡πâ‡∏ô / ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡∏¢‡∏≠‡∏î */
    .metric-red {
      color: #c62828;
      background-color: #fdecea;
      border: 1px solid #ef9a9a;
    }

    /* ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏•‡∏Ç 0 ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
    .metric-zero {
      color: #adb5bd;
      /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏à‡∏≤‡∏á */
      font-weight: normal;
    }

    /* ================= 6. UTILITIES ================= */
    .fade-in {
      animation: fadeIn 0.4s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .ward-clickable {
      cursor: pointer;
      color: var(--secondary-color);
      font-weight: bold;
      text-decoration: none;
      transition: all 0.2s;
    }

    .ward-clickable:hover {
      color: #0a58ca;
      text-decoration: underline;
      background-color: #e7f1ff;
      border-radius: 4px;
      padding: 0 4px;
    }

    .nav-tabs-scroll {
      flex-wrap: nowrap;
      overflow-x: auto;
      white-space: nowrap;
      border-bottom: 1px solid #dee2e6;
    }

    .nav-tabs-scroll .nav-link {
      color: #555;
      border: none;
      border-bottom: 3px solid transparent;
      margin-bottom: -1px;
      cursor: pointer;
    }

    .nav-tabs-scroll .nav-link.active {
      color: var(--secondary-color);
      background-color: transparent;
      border-bottom: 3px solid var(--secondary-color);
      font-weight: bold;
    }

    .detail-label {
      font-weight: 600;
      color: #555;
      font-size: 0.85rem;
    }

    .detail-value {
      color: #000;
      font-weight: 500;
      font-size: 0.9rem;
      border-bottom: 1px dotted #ccc;
      padding-bottom: 2px;
    }

    .detail-box {
      background: #fff;
      border: 1px solid #e9ecef;
      border-radius: 6px;
      padding: 10px;
      height: 100%;
    }

    .pre-wrap-text {
      white-space: pre-wrap;
      font-family: var(--font-family);
      background-color: #f8f9fa;
      padding: 8px;
      border-radius: 4px;
      font-size: 0.85rem;
      border: 1px solid #dee2e6;
    }

    /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå */
    .phone-badge {
      display: inline-block;
      /* ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• */
      font-size: 0.75rem;
      /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÄ‡∏•‡πá‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢ */
      color: #555;
      /* ‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡πÄ‡∏Ç‡πâ‡∏° */
      background-color: #f8f9fa;
      /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏à‡∏≤‡∏á‡πÜ */
      border: 1px solid #dee2e6;
      /* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö */
      border-radius: 4px;
      /* ‡∏°‡∏∏‡∏°‡∏°‡∏ô */
      padding: 0 4px;
      /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô */
      margin-left: 5px;
      /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô */
      font-weight: normal;
      /* ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏õ‡∏Å‡∏ï‡∏¥ (‡πÑ‡∏°‡πà‡∏´‡∏ô‡∏≤) */
    }

    .phone-badge i {
      color: #198754;
      /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå */
      margin-right: 2px;
    }

    /* ================= 7. PRINT STYLES ================= */
    @media print {
      @page {
        size: legal landscape;
        margin: 10mm;
      }

      body {
        width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        background-color: white !important;
        color: black !important;
        -webkit-print-color-adjust: economy !important;
      }

      * {
        background-color: transparent !important;
        box-shadow: none !important;
        text-shadow: none !important;
        border-color: #000 !important;
      }

      .no-print,
      .navbar,
      .scroll-btn-group,
      .nav-tabs,
      .btn,
      .pagination-container,
      .search-box,
      .modal {
        display: none !important;
      }

      .container-wide {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
      }

      .col-12,
      .col-md-12 {
        padding: 0 !important;
        width: 100% !important;
      }

      .card {
        border: none !important;
        margin-bottom: 0 !important;
        break-inside: auto !important;
        display: block !important;
      }

      .card[style*="display: none"] {
        display: none !important;
      }

      .table-dashboard {
        width: 100% !important;
        border-collapse: collapse !important;
        font-size: 10px !important;
        margin-bottom: 10px !important;
      }

      .table-dashboard th,
      .table-dashboard td {
        padding: 3px 2px !important;
        border: 1px solid #000 !important;
        line-height: 1.15 !important;
      }

      tr {
        break-inside: avoid;
        page-break-inside: avoid;
      }

      thead {
        display: table-header-group;
      }

      tfoot {
        display: table-footer-group;
      }
    }

    /* ================= 8. MODERN PAGINATION & COMPONENTS ================= */
    .pagination-wrapper {
      background: linear-gradient(to right, #f8f9fa, #ffffff);
      border: 1px solid #e9ecef;
      border-radius: 8px;
      padding: 10px 15px;
      margin-top: 15px;
    }

    .pagination-info {
      font-size: 0.9rem;
      color: #6c757d;
      font-weight: 500;
    }

    .pagination-info b {
      color: var(--primary-color);
      font-weight: 700;
    }

    .btn-page {
      background-color: #fff;
      border: 1px solid #dee2e6;
      color: #555;
      font-size: 0.85rem;
      padding: 6px 15px;
      transition: all 0.2s ease;
    }

    .btn-page:hover:not(.disabled) {
      background-color: #f1f3f5;
      color: var(--primary-color);
      border-color: var(--primary-color);
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .btn-page.disabled {
      background-color: #f8f9fa;
      color: #adb5bd;
      cursor: not-allowed;
      opacity: 0.7;
    }

    .btn-page-display {
      background-color: var(--primary-color) !important;
      color: #fff !important;
      border: 1px solid var(--primary-color) !important;
      opacity: 1 !important;
      font-weight: 600;
      min-width: 80px;
    }

    .input-group-flat {
      background-color: #f8f9fa;
      border-radius: 6px;
      border: 1px solid #e9ecef;
      transition: all 0.2s;
    }

    .input-group-flat:focus-within {
      background-color: #fff;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(13, 110, 253, 0.15);
    }

    #supervisorModal .modal-dialog {
      max-width: 90%;
      width: 1200px;
    }

    @media (max-width: 768px) {
      #supervisorModal .modal-dialog {
        max-width: 95%;
        margin: 10px auto;
      }
    }

    /* ================= 9. MODERN LOGIN PAGE ================= */
    .login-container {
      /* ‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Navbar ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡∏°‡πÇ‡∏ó‡∏ô */
      background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    /* ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏à‡∏≤‡∏á‡πÜ ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏°‡∏µ‡∏°‡∏¥‡∏ï‡∏¥ */
    .login-deco-circle {
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      z-index: 0;
    }

    .circle-1 {
      width: 300px;
      height: 300px;
      top: -50px;
      left: -50px;
    }

    .circle-2 {
      width: 400px;
      height: 400px;
      bottom: -100px;
      right: -100px;
    }

    /* ‡∏Å‡∏≤‡∏£‡πå‡∏î Login ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Å‡∏£‡∏∞‡∏à‡∏Å (Glassmorphism) */
    .login-card-modern {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      /* ‡πÄ‡∏ö‡∏•‡∏≠‡∏â‡∏≤‡∏Å‡∏´‡∏•‡∏±‡∏á */
      -webkit-backdrop-filter: blur(20px);
      border-radius: 24px;
      border: 1px solid rgba(255, 255, 255, 0.5);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
      width: 100%;
      max-width: 420px;
      padding: 40px 30px;
      position: relative;
      z-index: 10;
      transform: translateY(0);
      transition: transform 0.3s;
    }

    .login-header-icon {
      width: 80px;
      height: 80px;

      background-image: url('https://lh5.googleusercontent.com/d/1ho87dNmtrctiPR1ER6xSYcr5KHP1RMty');
      background-repeat: no-repeat;
      background-position: center;
      background-size: 70%;

      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;

      margin: 0 auto 20px;

      box-shadow:
        0 10px 20px rgba(0, 78, 146, 0.3),
        inset 0 0 0 1px rgba(255, 255, 255, .3);

      transition: transform .3s ease;
    }

    .login-header-icon:hover {
      transform: scale(1.15);
    }

    .brand-logo {
      width: 36px;
      height: 36px;

      background: #fff url("https://lh5.googleusercontent.com/d/1ho87dNmtrctiPR1ER6xSYcr5KHP1RMty") center / 80% no-repeat;
      border-radius: 50%;

      border: 1px solid rgba(0, 0, 0, .2);
      box-shadow: 0 3px 8px rgba(0, 0, 0, .3);

      transition: transform .2s ease;
    }

    .navbar-brand:hover .brand-logo {
      transform: scale(1.15);
    }

    /* Input Fields ‡∏ó‡∏µ‡πà‡∏î‡∏π‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏ï‡∏≤ */
    .input-modern {
      border: 2px solid #eef2f6;
      background-color: #f8fafc;
      border-radius: 12px;
      padding: 12px 15px;
      padding-left: 45px;
      /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ icon */
      transition: all 0.3s ease;
      font-size: 1rem;
    }

    .input-modern:focus {
      border-color: var(--primary-color);
      background-color: #fff;
      box-shadow: 0 0 0 4px rgba(0, 78, 146, 0.1);
    }

    .input-icon-wrapper {
      position: relative;
    }

    .input-icon-wrapper i {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #94a3b8;
      font-size: 1.1rem;
      transition: color 0.3s;
    }

    .input-modern:focus+i,
    .input-modern:focus~i {
      /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏ü‡∏Å‡∏±‡∏™ */
      color: var(--primary-color);
    }

    /* ‡∏õ‡∏∏‡πà‡∏° Login */
    .btn-login-modern {
      background: linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      border: none;
      border-radius: 12px;
      padding: 12px;
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.5px;
      color: white;
      box-shadow: 0 10px 20px rgba(0, 78, 146, 0.2);
      transition: all 0.3s;
    }

    .btn-login-modern:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 15px 30px rgba(0, 78, 146, 0.4);
      color: white;
    }

    .btn-login-modern:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    /* ================= 10. STEPPER UI (‡∏õ‡∏∏‡πà‡∏° +/-) ================= */
    /* ‡∏ã‡πà‡∏≠‡∏ô‡∏•‡∏π‡∏Å‡∏®‡∏£‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á Browser */
    .no-spinners::-webkit-outer-spin-button,
    .no-spinners::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    .no-spinners {
      -moz-appearance: textfield;
    }

    /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç */
    .input-stepper {
      text-align: center;
      font-weight: 800;
      font-size: 1.1rem !important;
      padding: 4px !important;
      z-index: 0 !important;
    }

    /* ============================================================ */
    /* 11. DASHBOARD SUMMARY / FORM PULL CONFIG (‡∏î‡∏∂‡∏á‡∏¢‡∏≠‡∏î / ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤) */
    /* ============================================================ */

    /* ---------- Card ---------- */
    .summary-card {
      background: #fff;
      border-radius: 16px;
      border: 1px solid rgba(0, 0, 0, 0.05);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
      overflow: hidden;
      height: 100%;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .summary-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    }

    /* ---------- Card Content ---------- */
    .summary-card-body {
      padding: 1rem;
      height: 100%;
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    /* ---------- Labels & Values ---------- */
    /* ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≤‡∏ß) */
    .summary-label {
      font-size: 0.85rem;
      font-weight: 600;
      color: #495057;
    }

    /* ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏° */
    .summary-card--primary .summary-label,
    .summary-card--success .summary-label {
      color: rgba(255, 255, 255, 0.85);
    }

    .summary-value {
      font-size: 2.2rem;
      font-weight: 800;
      line-height: 1.2;
    }

    /* ---------- Dashboard Input (‡∏î‡∏∂‡∏á‡∏¢‡∏≠‡∏î / ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤) ---------- */
    .summary-input {
      width: 100%;
      font-size: 2.4rem;
      font-weight: 800;
      background: transparent;
      border: none;
      color: inherit;
      padding: 0;
      text-align: left;
    }

    .summary-input:focus {
      outline: none;
      box-shadow: none;
    }

    /* ---------- Action Button (‡∏î‡∏∂‡∏á‡∏¢‡∏≠‡∏î / Save) ---------- */
    .summary-circle-btn {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      background: rgba(255, 255, 255, 0.25);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 5;
    }

    /* ---------- Background Icon ---------- */
    .summary-bg-icon {
      position: absolute;
      right: -10px;
      bottom: -10px;
      font-size: 5rem;
      opacity: 0.15;
      pointer-events: none;
    }

    /* ---------- Theme Variants ---------- */
    .summary-card--primary {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: #fff;
    }

    .summary-card--success {
      background: linear-gradient(135deg, #198754, #146c43);
      color: #fff;
    }

    /* ================= SCROLL TO TOP-BOTTOM BUTTONS ================= */
    .scroll-btn-group {
      position: fixed;
      bottom: 80px;
      /* ‡∏Ç‡∏¢‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏ô‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡πâ‡∏≤‡∏¢‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
      right: 15px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 1050;
      /* ‡∏•‡∏î‡∏•‡∏á‡∏°‡∏≤‡πÉ‡∏´‡πâ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ Modal (1055) ‡πÅ‡∏ï‡πà‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤ Navbar */
      opacity: 0.4;
      /* ‡πÉ‡∏´‡πâ‡∏à‡∏≤‡∏á‡∏•‡∏á‡∏°‡∏≤‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô */
      transition: opacity 0.3s ease;
    }

    .scroll-btn-group:hover {
      opacity: 1;
      /* ‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÑ‡∏õ‡∏ä‡∏µ‡πâ */
    }

    .btn-scroll {
      width: 38px;
      /* ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏•‡∏á‡∏à‡∏≤‡∏Å 45px */
      height: 38px;
      border-radius: 50%;
      background: var(--primary-color);
      color: white;
      border: 1.5px solid white;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .btn-scroll:hover {
      opacity: 1;
      transform: scale(1.1);
      background: var(--secondary-color);
    }

    .btn-scroll i {
      font-size: 1.2rem;
    }

    /* ‡∏ã‡πà‡∏≠‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠ Print */
    @media print {
      .scroll-btn-group {
        display: none !important;
      }
    }

    /* ================= CUSTOM DASHBOARD TABS ================= */
    .custom-dashboard-tabs {
      display: flex;
      gap: 8px;
      padding: 10px;
      background: #fff;
      border-radius: 15px;
      box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);

      /* üì± ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ã‡πâ‡∏≤‡∏¢-‡∏Ç‡∏ß‡∏≤‡πÑ‡∏î‡πâ */
      overflow-x: auto;
      white-space: nowrap;
      flex-wrap: nowrap;
      scrollbar-width: none;
    }

    /* üíª ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå (768px ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ) ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡πÑ‡∏°‡πà‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô */
    @media (min-width: 768px) {
      .custom-dashboard-tabs {
        flex-wrap: wrap;
        /* ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏¢‡∏≠‡∏∞ */
        overflow-x: visible;
        /* ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
        white-space: normal;
        /* ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏Å‡∏ï‡∏¥ */
      }
    }

    .custom-dashboard-tabs::-webkit-scrollbar {
      display: none;
    }

    .custom-dashboard-tabs .nav-link {
      border-radius: 10px !important;
      padding: 10px 20px !important;
      color: #555;
      font-weight: 600;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid transparent;
      background: #f8f9fa;
      display: flex;
      /* ‡∏Ñ‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÄ‡∏î‡∏¥‡∏° */
      align-items: center;
      /* ‡∏Ñ‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÄ‡∏î‡∏¥‡∏° */
      justify-content: space-between;
      /* ‡∏Ñ‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡πÄ‡∏î‡∏¥‡∏° */
    }

    /* Hover Effect */
    .custom-dashboard-tabs .nav-link:hover {
      background-color: #e9ecef;
      transform: translateY(-2px);
    }

    /* Active State - ‡πÅ‡∏ó‡πá‡∏ö‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ */
    .custom-dashboard-tabs .nav-link.active {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)) !important;
      color: #fff !important;
      box-shadow: 0 4px 12px rgba(0, 78, 146, 0.3);
    }

    /* ‡πÅ‡∏ó‡πá‡∏ö‡∏û‡∏¥‡πÄ‡∏®‡∏©: Ventilator */
    .tab-ventilator {
      color: var(--color-danger) !important;
      border: 1px solid #ffcdd2 !important;
    }

    .tab-ventilator.active {
      background: linear-gradient(135deg, #d32f2f, #b71c1c) !important;
      color: #fff !important;
      border: none !important;
      box-shadow: 0 4px 12px rgba(211, 47, 47, 0.3) !important;
    }

    /* ‡πÅ‡∏ó‡πá‡∏ö‡∏û‡∏¥‡πÄ‡∏®‡∏©: Report */
    .tab-report {
      color: var(--color-success) !important;
      border: 1px solid #c8e6c9 !important;
    }

    .tab-report.active {
      background: linear-gradient(135deg, #2e7d32, #1b5e20) !important;
      color: #fff !important;
      border: none !important;
      box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3) !important;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö */
    .custom-dashboard-tabs .nav-link i {
      font-size: 1.1rem;
      vertical-align: middle;
    }

    /* ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á Badge ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç */
    .badge-count {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      background-color: rgba(0, 0, 0, 0.1);
      color: inherit;
      font-size: 0.75rem;
      font-weight: 700;
      padding: 2px 8px;
      border-radius: 50px;
      margin-left: 8px;
      min-width: 24px;
      transition: all 0.3s ease;
    }

    .nav-link.active .badge-count {
      background-color: rgba(255, 255, 255, 0.3);
      color: #fff;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö tab-ventilator ‡πÅ‡∏•‡∏∞ tab-report ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Active */
    .tab-ventilator:not(.active) .badge-count {
      background-color: #ffebee;
      color: #c62828;
    }

    .tab-report:not(.active) .badge-count {
      background-color: #e8f5e9;
      color: #2e7d32;
    }

    /* Badge ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Vent ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡∏≤‡∏¢ */
    .badge-vent-inline {
      margin-left: 5px;
      font-size: 0.7rem;
      background-color: #ffebee;
      color: #c62828;
      padding: 1px 6px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      gap: 3px;
      border: 1px solid #ffcdd2;
    }

    .nav-link.active .badge-vent-inline {
      background-color: rgba(255, 255, 255, 0.9);
      border-color: #fff;
      color: #b71c1c;
    }

    .nav-link[title] {
      cursor: help;
    }

    @media (max-width: 576px) {

      /* ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á (Full Width) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏á‡πà‡∏≤‡∏¢ */
      .d-grid.gap-2 .btn {
        width: 100%;
        padding-top: 10px;
        padding-bottom: 10px;
        font-size: 0.9rem;
        /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ô‡∏¥‡∏î‡∏´‡∏ô‡πà‡∏≠‡∏¢ */
        display: flex;
        justify-content: center;
        align-items: center;
      }

      /* ‡∏õ‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á */
      .form-control-sm {
        height: calc(1.5em + 1rem + 2px);
        font-size: 1rem;
      }
    }

    /* ‡πÄ‡∏û‡∏¥‡πà‡∏° Effect ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ä‡∏µ‡πâ‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢ */
    .btn-sm {
      transition: all 0.2s ease;
      border-radius: 8px;
      /* ‡∏°‡∏∏‡∏°‡∏°‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏π Modern */
    }

    .btn-sm:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    }

    /* ================= 12. STICKY FOOTER BAR ================= */
    .footer-bar-custom {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: linear-gradient(135deg, #7b1fa2 0%, #4a148c 100%);
      color: white;
      text-align: center;
      padding: 8px 0;
      font-size: 0.9rem;
      z-index: 1000;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏ô Footer ‡∏ö‡∏±‡∏á */
    .main-content {
      padding-bottom: 60px !important;
    }

    @media print {
      .footer-bar-custom {
        display: none !important;
      }
    }

    /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (Active) */
    /* ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏±‡∏ï‡∏∏‡∏£‡∏±‡∏™ */
    .btn-number {
      min-width: 42px;
      height: 38px;
      font-weight: 600;
      border: 1px solid #dee2e6;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô */
    .btn-page-active {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)) !important;
      color: white !important;
      border-color: var(--secondary-color) !important;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    /* ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
    .pagination-numbers-container {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤-‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏∏‡∏î‡∏Å‡∏±‡∏ô */
    .btn-page {
      padding: 8px 16px;
      border: 1px solid #dee2e6;
    }

    /* ‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏Å‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏ô */
    @media (max-width: 576px) {
      .pagination-numbers-container {
        display: none;
      }

      .pagination-wrapper {
        flex-direction: column;
        text-align: center;
      }
    }

    /* *********************** */
    /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏° "‡∏à‡∏î‡∏à‡∏≥‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" ‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á */
    .remember-me-wrapper {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 15px;
      font-size: 0.85rem;
      color: #666;
    }

    .remember-me-wrapper input {
      cursor: pointer;
      width: 16px;
      height: 16px;
      accent-color: var(--primary-color);
    }

    /* ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á (Toast) */
    .logout-timer-toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #fff;
      border-left: 5px solid #ff9800;
      /* ‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô */
      padding: 15px 25px;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      z-index: 9999;
      display: flex;
      align-items: center;
      gap: 15px;
      animation: slideInRight 0.5s ease-out;
    }

    .logout-timer-content {
      display: flex;
      flex-direction: column;
    }

    .logout-timer-title {
      font-weight: bold;
      color: #d32f2f;
      margin-bottom: 2px;
    }

    .logout-timer-bar {
      height: 4px;
      background: #eee;
      width: 100%;
      margin-top: 8px;
      border-radius: 2px;
      overflow: hidden;
    }

    .logout-timer-progress {
      height: 100%;
      background: #ff9800;
      transition: width 1s linear;
    }

    @keyframes slideInRight {
      from {
        transform: translateX(100%);
        opacity: 0;
      }

      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    /* ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á Group Input ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢ */
    .modern-form-group {
      background: #ffffff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03);
      border: 1px solid #edf2f7;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á Label ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏´‡∏£‡∏π‡∏Ç‡∏∂‡πâ‡∏ô */
    .modern-label {
      font-size: 0.85rem;
      font-weight: 700;
      color: #4a5568;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .modern-label i {
      color: var(--primary-color);
      font-size: 1rem;
      width: 24px;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ä‡πà‡∏≠‡∏á Input/Select ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏°‡∏µ‡∏°‡∏¥‡∏ï‡∏¥ */
    .modern-input {
      border: 2px solid #e2e8f0 !important;
      border-radius: 10px !important;
      padding: 10px 12px !important;
      font-weight: 500;
      transition: all 0.2s ease-in-out;
      background-color: #f8fafc !important;
    }

    .modern-input:focus {
      background-color: #fff !important;
      border-color: var(--primary-color) !important;
      box-shadow: 0 0 0 4px rgba(106, 27, 154, 0.1) !important;
      transform: translateY(-1px);
    }

    .modern-input:disabled {
      background-color: #f1f5f9 !important;
      border-color: #e2e8f0 !important;
      color: #94a3b8;
    }

    .disabled-look {
      background-color: #f1f5f9 !important;
      border-color: #e2e8f0 !important;
      color: #94a3b8 !important;
      cursor: not-allowed !important;
      pointer-events: none;
    }

    /* ================= WARD SEARCHABLE DROPDOWN ================= */
    .ward-search-wrapper {
      position: relative;
    }

    .ward-dropdown-menu {
      position: absolute;
      z-index: 1050;
      left: 0;
      right: 0;
      top: calc(100% + 4px);
      background: #fff;
      border: 1px solid #ced4da;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      max-height: 300px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      animation: dropdownFadeIn 0.2s ease-out;
    }

    @keyframes dropdownFadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .ward-dropdown-search-box {
      padding: 10px;
      border-bottom: 1px solid #f0f0f0;
      flex-shrink: 0;
    }

    .ward-dropdown-list {
      overflow-y: auto;
      flex: 1;
    }

    .ward-dropdown-group-header {
      padding: 6px 12px;
      font-size: 11px;
      font-weight: 800;
      color: #6a1b9a;
      text-transform: uppercase;
      background: #f8f0fb;
      letter-spacing: 0.5px;
      border-bottom: 1px solid #eee;
    }

    .ward-dropdown-item {
      padding: 10px 15px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      border-bottom: 1px solid #f9f9f9;
    }

    .ward-dropdown-item:hover {
      background-color: #f3f0f7;
      padding-left: 20px;
    }

    .ward-dropdown-item.selected {
      background: #ede7f6 !important;
      color: #6a1b9a;
      font-weight: 600;
    }

    .ward-dropdown-no-result {
      padding: 20px;
      text-align: center;
      color: #adb5bd;
      font-size: 13px;
    }

    /* ‡πÅ‡∏ñ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡∏ö Soft UI */
    .date-badge-soft {
      display: inline-flex;
      align-items: center;
      background: #f0fdf4;
      color: #166534;
      padding: 4px 10px;
      border-radius: 8px;
      font-size: 0.75rem;
      margin-top: 6px;
      border: 1px solid #dcfce7;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Navbar Mobile - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏°‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
    @media (max-width: 991px) {
      .navbar-collapse {
        /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á‡πÄ‡∏Ç‡πâ‡∏° (Theme ‡∏´‡∏•‡∏±‡∏Å) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏î‡∏Å‡∏±‡∏ö Badge ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡∏µ‡∏≠‡πà‡∏≠‡∏ô */
        background: linear-gradient(135deg, var(--secondary-color) 0%, #310d5e 100%);
        margin-top: 10px;
        padding: 15px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.4);
        max-height: 85vh;
        overflow-y: auto;
        border: 1px solid rgba(255,255,255,0.1); /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏°‡∏ô‡∏π‡∏î‡∏π‡∏ä‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô */
      }

      /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å */
      .navbar-nav .nav-link {
        color: rgba(255,255,255,0.85) !important; /* ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏Ç‡∏≤‡∏ß‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÅ‡∏™‡∏á */
        padding: 12px 20px !important;
        border-radius: 10px;
        margin-bottom: 5px;
        display: flex;
        align-items: center;
      }

      /* ‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å */
      .navbar-nav .nav-link.active {
        background-color: rgba(255,255,255,0.15) !important;
        color: #ffffff !important;
        font-weight: bold;
      }

      /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Dropdown ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
      .dropdown-menu-custom {
        background-color: rgba(0, 0, 0, 0.2) !important; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏î‡∏£‡∏≠‡∏õ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏°‡∏ô‡∏π‡∏ô‡∏¥‡∏î‡∏ô‡∏∂‡∏á */
        border: none !important;
        box-shadow: none !important;
        padding: 10px;
        margin-top: 5px !important;
      }

      .dropdown-item {
        color: rgba(255,255,255,0.8) !important; /* ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏Ç‡∏≤‡∏ß */
        padding: 10px 15px !important;
        border-radius: 8px;
      }

      .dropdown-item:hover {
        background-color: rgba(255,255,255,0.1) !important;
        color: #fff !important;
      }

      /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡∏≠‡∏á User ‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
      .dropdown-menu-custom .bg-light {
        background-color: rgba(255, 255, 255, 0.1) !important; /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å‡∏™‡∏µ‡∏™‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡πâ‡∏° */
        border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
        color: #fff !important;
      }

      /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ Badge ‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏î */
      .badge.bg-info {
        background-color: #0dcaf0 !important; /* ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏™‡∏ß‡πà‡∏≤‡∏á */
        color: #000 !important;
        font-weight: 700;
      }

      .dropdown-divider {
        border-top: 1px solid rgba(255,255,255,0.1) !important;
      }
    }

    /* ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á Card ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    .mobile-ward-card {
      background: #fff;
      border-radius: 12px;
      border-left: 5px solid var(--primary-color);
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      transition: transform 0.2s;
      cursor: pointer;
    }

    .mobile-ward-card:active {
      transform: scale(0.98);
      background-color: #f8f9fa;
    }

    .mobile-metric-box {
      text-align: center;
      padding: 5px;
      border-radius: 8px;
      min-width: 60px;
    }

    .mobile-label {
      font-size: 0.65rem;
      display: block;
      color: #6c757d;
      font-weight: bold;
    }

    .mobile-value {
      font-size: 1.1rem;
      font-weight: 800;
    }

    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÉ‡∏ï‡πâ Metrics ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    .mobile-special-row {
        display: flex;
        flex-wrap: wrap;
        gap: 4px;
        margin-top: 6px;
    }

    .badge-special {
        font-size: 0.65rem;
        padding: 2px 6px;
        border-radius: 4px;
        font-weight: 700;
        border: 1px solid transparent;
    }

    /* ‡∏™‡∏µ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó */
    .badge-ods { background-color: #e0f2fe; color: #0369a1; border-color: #bae6fd; }
    .badge-emu { background-color: #fef3c7; color: #92400e; border-color: #fde68a; }
    .badge-crit { background-color: #fee2e2; color: #b91c1c; border-color: #fecaca; }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Group Header ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏π‡πÄ‡∏î‡πà‡∏ô */
    .mobile-group-header {
      background: #eef2f7;
      padding: 8px 15px;
      border-radius: 8px;
      font-weight: 800;
      color: #495057;
      margin: 15px 0 10px 0;
      font-size: 0.9rem;
    }
    /* ‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î (‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏î‡∏π‡πÄ‡∏ö‡∏≤‡∏•‡∏á) */
    .card-holiday-mode {
      background-color: #fcfcfc !important;
      border-left-color: #ffc107 !important;
      opacity: 0.85;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    .sticky-top {
      position: -webkit-sticky; /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Safari */
      position: sticky;
      top: 0;                   /* ‡∏ï‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á container */
      z-index: 10;              /* ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÜ */
      background-color: #f8f9fa !important; /* ‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏ó‡∏∂‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô */
      border-bottom: 1px solid #dee2e6;
    }

    .mobile-ward-card {
      transition: all 0.2s ease;
      border: 1px solid rgba(0,0,0,0.05);
    }

    /* ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏ï‡∏∞ (Touch) ‡∏à‡∏∞‡∏°‡∏µ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏¢‡∏∏‡∏ö‡∏ï‡∏±‡∏ß */
    .mobile-ward-card:active {
      transform: scale(0.97);
      box-shadow: none;
    }

    /* 1. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å (‡πÉ‡∏ä‡πâ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á ‡πÅ‡∏•‡∏∞ ‡∏†‡∏≤‡∏£‡∏∞‡∏á‡∏≤‡∏ô) */
    .mobile-staff-row {
        display: flex;
        gap: 5px;
        margin-top: 8px;
    }

    .mobile-staff-box {
        flex: 1;
        padding: 6px 4px; /* ‡∏õ‡∏£‡∏±‡∏ö Padding ‡πÉ‡∏´‡πâ‡πÅ‡∏Ñ‡∏ö‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πà‡∏•‡πâ‡∏ô */
        border-radius: 8px;
        font-size: 0.7rem;
        min-width: 0; /* ‡∏Å‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏î‡∏±‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏•‡πâ‡∏ô */
    }

    /* 2. ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏¢‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó */
    .bg-staff-aft { background-color: #e7f1ff; border: 1px solid #cfe2ff; color: #084298; }
    .bg-staff-mid { background-color: #f8f9fa; border: 1px solid #dee2e6; color: #212529; }
    .bg-workload-mini { background-color: #fff8e1; border: 1px solid #ffecb3; color: #856404; }

    /* 3. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏†‡∏≤‡∏¢‡πÉ‡∏ô (Workload Item) */
    .workload-item {
        display: flex;
        align-items: center;
        gap: 3px;
        margin-bottom: 3px; /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î */
        white-space: nowrap; /* ‡∏´‡πâ‡∏≤‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà */
    }

    .workload-item i {
        width: 14px;
        text-align: center;
        font-size: 0.75rem;
    }

    .workload-item b { 
        font-size: 0.8rem; /* ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô */
    }

    /* 4. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏© */
    .text-death-red { color: #d32f2f !important; font-weight: 800; }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÅ‡∏ñ‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á Card ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    .mobile-status-footer {
      background-color: #fff9db; /* ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏à‡∏≤‡∏á‡πÜ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î */
      border-radius: 8px;
      padding: 8px 12px;
      border: 1px solid #ffe066;
      word-break: break-word; /* ‡∏ï‡∏±‡∏î‡∏Ñ‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô */
      white-space: normal;
      display: block;
    }

    .mission-badge-mobile {
      background: linear-gradient(135deg, #e7f1ff 0%, #fff 100%);
      border: 1px solid #0d6efd;
      color: #0d6efd;
      border-radius: 8px;
      padding: 10px;
      font-size: 0.85rem;
    }

    /* ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏£‡∏ß‡∏° Search + Tabs ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    /* ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏•‡∏≠‡∏¢‡∏ï‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö */
    /* --- ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÅ‡∏¢‡∏Å‡πÇ‡∏´‡∏°‡∏î --- */
    @media (min-width: 992px) {
      .view-mobile-only { display: none !important; }
      .view-pc-only { display: block !important; }
    }

    /* ============================================================ */
    /* [PC MODE] Sticky Tabs & Line Info Header (Non-Table) */
    /* ============================================================ */
    @media (min-width: 992px) {
      /* 1. ‡∏ï‡∏±‡∏ß‡∏´‡∏∏‡πâ‡∏°‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏¥‡∏î‡∏´‡∏ô‡∏∂‡∏ö */
      .sticky-pc-control-wrapper {
        position: -webkit-sticky;
        position: sticky;
        top: 56px;      /* ‡∏ï‡∏∂‡∏á‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å Navbar */
        z-index: 1025;
        background-color: var(--bg-body); /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏ß‡πá‡∏ö */
        padding: 10px 0 5px 0;
        margin-bottom: 0;
      }

      .pc-sticky-line-banner {
        background: linear-gradient(to right, #1565c0, var(--secondary-color));
        color: white;
        padding: 8px 20px;
        border-radius: 10px;
        margin-top: 8px;
        font-size: 1rem;
        font-weight: bold;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 10px;
      }
    }
    /* <!-- ************************************************* --> */

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Z-index ‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏° Scroll Up/Down ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏ô‡∏ó‡∏±‡∏ö */
    .scroll-btn-group {
      z-index: 2000 !important;
    }

    @media (max-width: 991.98px) {
      .view-mobile-only { display: block !important; }
      .view-pc-only { display: none !important; }
    }

    @media (max-width: 991.98px) {
      .view-mobile-only .btn-mobile-stack {
          display: inline-flex !important;
          /* ‡∏õ‡∏£‡∏±‡∏ö flex ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏î‡∏ô‡∏ö‡∏µ‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏∑‡∏î‡πÉ‡∏ô‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏£‡∏¥‡∏á */
          flex: 0 0 auto !important; 
          flex-direction: column !important;
          justify-content: center !important;
          align-items: center !important;

          /* --- ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏ô‡∏≤‡∏î --- */
          height: 60px !important;      /* ‡∏•‡πá‡∏≠‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà 60px ‡∏ï‡∏•‡∏≠‡∏î‡πÄ‡∏ß‡∏•‡∏≤ */
          min-width: 60px !important;   /* ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà 60px (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏±‡∏ï‡∏∏‡∏£‡∏±‡∏™‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡πâ‡∏ô) */
          width: auto !important;       /* ‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß ‡πÉ‡∏´‡πâ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ */
          
          /* --- ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° --- */
          white-space: nowrap !important; /* ‡∏´‡πâ‡∏≤‡∏°‡∏ï‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏¢‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≤‡∏á */
          padding: 0 10px !important;     /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢-‡∏Ç‡∏ß‡∏≤ ‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏ï‡∏¥‡∏î‡∏Ç‡∏≠‡∏ö */
          
          gap: 4px !important;
          line-height: 1 !important;
      }

      /* ‡∏™‡∏±‡πà‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏•‡∏≤‡∏™‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô */
      .view-mobile-only .btn-mobile-stack i {
        margin: 0 !important;
        line-height: 1 !important;
        font-size: 1.3rem !important;
      }

      /* ‡∏™‡∏±‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏•‡∏≤‡∏™‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô */
      .view-mobile-only .btn-mobile-stack span {
        display: block !important;
        font-size: 0.75rem !important;
        line-height: 1 !important;
      }
    }
    
    /* --- ‡πÅ‡∏ñ‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏ß‡∏° (‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ô‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤) --- */
    /* --- ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 1: ‡πÅ‡∏ñ‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Search + Tabs --- */
    .mobile-sticky-header {
      position: sticky;
      top: 60px;      /* ‡∏ï‡∏∂‡∏á‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å Navbar */
      z-index: 1020;  /* ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 2 ‡∏°‡∏∏‡∏î‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ï‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô */
      background-color: var(--bg-body);
      padding: 10px 8px 5px 8px;
      border-bottom: 1px solid rgba(0,0,0,0.05);
      box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
    }

    /* --- ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 2: ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô) --- */
    .view-mobile-only .main-line-header {
      position: sticky !important;
      /* ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å: Navbar(56px) + ‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 1(‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 110px) = 166px */
      top: 178px !important; 
      z-index: 1010; /* ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà 1 */
      background: linear-gradient(to right, #1565c0, var(--secondary-color)) !important;
      margin-bottom: 10px;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ä‡πà‡∏≠‡∏á Search ‡πÉ‡∏´‡πâ‡∏î‡∏π Soft */
    .search-wrapper-mobile {
      background: white;
      border-radius: 12px;
      padding: 2px 12px;
      border: 1px solid #e2e8f0;
      display: flex;
      align-items: center;
      margin-bottom: 10px;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Tabs ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏™‡∏°‡∏π‡∏ó */
    .custom-dashboard-tabs {
      display: flex !important;
      overflow-x: auto !important;
      white-space: nowrap !important;
      gap: 8px;
      scrollbar-width: none;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 5px;
    }
    .custom-dashboard-tabs::-webkit-scrollbar { display: none; }

    .custom-dashboard-tabs .nav-link {
      padding: 8px 16px !important;
      font-size: 0.9rem;
      border-radius: 10px !important;
      background: #fff;
      border: 1px solid #eef2f7 !important;
      color: #64748b !important;
    }

    .custom-dashboard-tabs .nav-link.active {
      background: var(--primary-color) !important;
      color: white !important;
      border-color: var(--primary-color) !important;
    }
    /* ==== ‡∏à‡∏ö ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ =======*/

    /* ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    /* ‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÅ‡∏ö‡∏ö‡πÄ‡∏ô‡πâ‡∏ô‡πÉ‡∏ä‡πâ Logic ‡πÄ‡∏î‡∏¥‡∏° */
    .history-card-mobile {
      background: #fff;
      border-radius: 12px;
      border: 1px solid #e9ecef;
      margin-bottom: 16px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      overflow: hidden;
    }

    .h-header {
      background: #f8fafc;
      padding: 10px 16px;
      border-bottom: 1px solid #f1f3f5;
    }

    .h-body {
      padding: 16px;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å renderHistoryInfo */
    .h-metric-content {
      line-height: 1.6;
      font-size: 1rem;
    }

    /* ‡∏™‡πà‡∏ß‡∏ô subMetric (‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡∏ß‡πà‡∏≤‡∏á ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏ß‡∏•‡∏≤) ‡πÉ‡∏´‡πâ‡πÅ‡∏¢‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô */
    .h-sub-content {
      background-color: #f8f9fa;
      border-radius: 8px;
      padding: 10px;
      margin-top: 12px;
      border: 1px solid #eee;
      text-align: center;
    }

    /* ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡∏á‡πà‡∏≤‡∏¢) */
    .h-btn-footer {
      width: 100%;
      padding: 14px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å */
      /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏°‡πÅ‡∏ö‡∏ö‡∏ó‡∏∂‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á --primary-color ‡∏Å‡πá‡πÑ‡∏î‡πâ */
      background-color: #0d6efd; 
      color: #ffffff; /* ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏î‡∏Å‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
      font-weight: 700;
      border: none;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      transition: all 0.2s ease;
      /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏°‡∏∏‡∏°‡∏•‡πà‡∏≤‡∏á‡∏°‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ç‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î */
      border-bottom-left-radius: 12px;
      border-bottom-right-radius: 12px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.2); /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏°‡∏¥‡∏ï‡∏¥‡∏Ç‡∏≠‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
    }

    /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Å‡∏î (‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™) */
    .h-btn-footer:active {
      background-color: #0056b3; /* ‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î */
      transform: scale(0.99); /* ‡∏¢‡∏∏‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏î‡∏à‡∏£‡∏¥‡∏á */
    }

    /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏Ç‡∏¢‡∏±‡∏ö‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏î‡∏π‡∏î‡∏™‡∏≤‡∏¢‡∏ï‡∏≤ */
    .h-btn-footer i {
      font-size: 1.1rem;
      transition: transform 0.2s;
    }
    /* ==== ‡∏à‡∏ö ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ =======*/

    /* ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Multi/Viewer (Mobile) */
    .multi-unit-card {
        background: #fff;
        border: 2px solid #edf2f7;
        border-radius: 12px;
        padding: 12px;
        transition: all 0.2s ease;
        cursor: pointer;
        text-align: center;
        position: relative;
        min-height: 70px;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    .multi-unit-card.selected {
        border-color: var(--primary-color);
        background-color: #f3e5f5;
    }
    .multi-unit-card .unit-name {
        font-weight: 700;
        font-size: 0.9rem;
        color: #333;
    }
    .multi-unit-card .unit-line {
        font-size: 0.65rem;
        color: #666;
    }
    .multi-unit-card .check-icon {
        position: absolute;
        top: 5px;
        right: 5px;
        color: var(--primary-color);
    }
    /*===== ‡∏à‡∏ö ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ =====*/
  </style>

</head>

<body>

  <div id="app" v-cloak>
    
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg fixed-top">
      <div class="container">
        <a class="navbar-brand" href="#" @click.prevent="selectMenu('form'); resetForm()">
          <i class="fa-solid fa-user-nurse me-2"></i>‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£ 2569
        </a>
        
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto align-items-center">
            
            <li class="nav-item" v-if="isAdminLoggedIn">
              <a class="nav-link" 
                :class="{ active: currentView === 'scanner' }" 
                @click.prevent="selectMenu('scanner')" 
                style="cursor: pointer;">
                <i class="fa-solid fa-qrcode me-1"></i> ‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
              </a>
            </li>

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" 
                 href="#" 
                 role="button" 
                 data-bs-toggle="dropdown" 
                 data-bs-auto-close="outside"
                 :class="{ active: ['form', 'schedule', 'AssessmentForm', 'contact'].includes(currentView) }">
                <i class="fa-solid fa-bars-staggered me-1"></i> ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å
              </a>

              <ul class="dropdown-menu shadow border-0 rounded-4 mt-2" style="min-width: 220px; padding: 0.5rem;">
                <li>
                  <a class="dropdown-item" 
                     :class="{ active: currentView === 'form' }" 
                     href="#" 
                     @click.prevent="selectMenu('form'); resetForm()">
                    <i class="fa-solid fa-address-card me-2"></i> ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                  </a>
                </li>
                <li>
                  <a class="dropdown-item" 
                     :class="{ active: currentView === 'schedule' }" 
                     href="#" 
                     @click.prevent="selectMenu('schedule'); navToSchedule()">
                    <i class="fa-solid fa-calendar-check me-2"></i> ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£
                  </a>
                </li>
                <li>
                  <a class="dropdown-item" 
                     :class="{ active: currentView === 'AssessmentForm' }" 
                     href="#" 
                     @click.prevent="selectMenu('AssessmentForm')">
                    <i class="fa-solid fa-circle-check me-2"></i> ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•
                  </a>
                </li>
                <li><hr class="dropdown-divider my-2"></li>
                <li>
                  <a class="dropdown-item" 
                     :class="{ active: currentView === 'contact' }" 
                     href="#" 
                     @click.prevent="selectMenu('contact')">
                    <i class="fa-solid fa-headset me-2"></i> ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤
                  </a>
                </li>
              </ul>
            </li>

            <li class="nav-item dropdown" v-if="isAdminLoggedIn">
              <a class="nav-link dropdown-toggle" 
                href="#" 
                role="button" 
                data-bs-toggle="dropdown" 
                data-bs-auto-close="outside"
                :class="{ active: ['dashboard', 'summary'].includes(currentView) }">
                <i class="fa-solid fa-toolbox me-1"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö
              </a>
              <ul class="dropdown-menu shadow border-0 rounded-4 mt-2" style="min-width: 200px; padding: 0.5rem;">
                <li>
                  <a class="dropdown-item" 
                    :class="{ active: currentView === 'dashboard' }" 
                    href="#" 
                    @click.prevent="selectMenu('dashboard')">
                    <i class="fa-solid fa-gauge me-2"></i> Dashboard
                  </a>
                </li>
                <li><hr class="dropdown-divider my-2"></li>
                <li>
                  <a class="dropdown-item" 
                    :class="{ active: currentView === 'summary' }" 
                    href="#" 
                    @click.prevent="selectMenu('summary'); navToSummary()">
                    <i class="fa-solid fa-chart-pie me-2"></i> ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à
                  </a>
                </li>
              </ul>
            </li>

            <li class="nav-item ms-lg-3 mt-2 mt-lg-0">
              
              <a class="btn btn-outline-primary btn-sm rounded-pill px-3 w-100 w-lg-auto" 
                v-if="!isAdminLoggedIn"
                href="#" @click.prevent="selectMenu('dashboard'); navToAdmin()">
                <i class="fa-solid fa-lock-open me-1"></i> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
              </a>

              <div v-else class="dropdown">
                <button class="btn btn-primary btn-sm rounded-pill px-3 dropdown-toggle d-flex align-items-center w-100 w-lg-auto justify-content-center" 
                        type="button" 
                        data-bs-toggle="dropdown">
                  <i class="fa-solid fa-user-shield me-2"></i> 
                  <span class="fw-bold">{{login.user}}</span>
                  <span class="badge bg-light text-primary ms-2 rounded-pill" style="font-size: 0.7rem; text-transform: uppercase;">
                    {{ userRole }}
                  </span>
                </button>
                
                <ul class="dropdown-menu dropdown-menu-end shadow border-0 rounded-3 mt-2">
                  <li class="px-3 py-2 text-muted small border-bottom bg-light rounded-top-3">
                    <div class="fw-bold text-dark">{{ login.user }}</div>
                    <div style="font-size: 0.75rem;">Role: <span class="text-primary fw-bold text-uppercase">{{ userRole }}</span></div>
                  </li>
                  <li>
                    <a class="dropdown-item text-danger mt-1 fw-bold" href="#" @click.prevent="selectMenu('form'); logoutAdmin()">
                      <i class="fa-solid fa-right-from-bracket me-2"></i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                    </a>
                  </li>
                </ul>
              </div>

            </li>
            
          </ul>
        </div>
      </div>
    </nav>


    <div :class="currentView === 'dashboard' ? 'container-fluid px-md-5 py-4' : 'container py-4'">
      <div class="row justify-content-center">

        <div class="container-fluid">

          <div class="main-card mb-4" >

            <!-- Header Section -->
            <div class="form-header-banner" v-if="currentView === 'form'">
              <div class="container text-center">
                <!-- Logo Container -->
                <div class="header-logo-container d-flex justify-content-center align-items-center gap-3 gap-md-4 mb-2">
                  <!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ 1 -->
                  <div class="logo-wrapper">
                    <img src="https://lh5.googleusercontent.com/d/1WNPE166t9BOZzIgrCfHTZUITcLSoLMvh" class="header-logo" alt="Logo 1">
                  </div>
                  <!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ 2 -->
                  <div class="logo-wrapper">
                    <img src="https://lh5.googleusercontent.com/d/1ZJlIKLuMhMnM1gi8qL7YOOmlxl86oYeg" class="header-logo" alt="Logo 2">
                  </div>
                </div>

                <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° -->
                <div class="header-content-text px-2">
                  <h1 class="conference-main-title fw-800">‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ 2569</h1>
                  <h2 class="conference-sub-title fw-400">‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå ‡∏™‡∏†‡∏≤‡∏Å‡∏≤‡∏ä‡∏≤‡∏î‡πÑ‡∏ó‡∏¢</h2>
                  
                  <div class="header-theme-box my-4">
                    <span class="theme-badge-pill">
                      Integrating Humanity, Spirituality and Smart Nurse
                    </span>
                  </div>

                  <div class="header-info-details d-flex flex-wrap justify-content-center gap-3 gap-md-4 mt-3">
                    <div class="info-item-top">
                      <i class="fa-solid fa-calendar-days me-2"></i> ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25-26 ‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏° 2569
                    </div>
                    <div class="info-item-top">
                      <i class="fa-solid fa-location-dot me-2"></i> ‡∏ì ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° 1210 ‡∏ä‡∏±‡πâ‡∏ô 12 ‡πÇ‡∏ã‡∏ô B ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏¥‡∏£‡∏¥‡∏°‡∏±‡∏á‡∏Ñ‡∏•‡∏≤‡∏ô‡∏∏‡∏™‡∏£‡∏ì‡πå
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- üü¢ 1. ‡∏´‡∏ô‡πâ‡∏≤ Login (‡πÉ‡∏™‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô) -->
            <div v-if="currentView === 'dashboard' && !isAdminLoggedIn" class="container py-5">
              <div class="row justify-content-center">
                <div class="col-md-4">
                  <div class="card shadow-lg border-0 rounded-4 overflow-hidden">
                    <div class="bg-primary p-4 text-center text-white">
                      <i class="fa-solid fa-lock fa-3x mb-2"></i>
                      <h4 class="fw-bold mb-0">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
                    </div>

                    <div class="card-body p-4">
                      <div class="mb-3">
                        <label class="form-label small fw-bold">‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</label>
                        <div class="input-group shadow-sm">
                          <input 
                            :type="showPassword ? 'text' : 'password'" 
                            v-model="login.pass" 
                            class="form-control form-control-lg bg-light border-0" 
                            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
                            @keyup.enter="handleAdminLogin"
                            @input="formatPassword" 
                          >
                          <button 
                            class="btn btn-light border-0" 
                            type="button" 
                            @click="showPassword = !showPassword"
                          >
                            <i :class="showPassword ? 'fa-solid fa-eye-slash' : 'fa-solid fa-eye'"></i>
                          </button>
                        </div>
                      </div>

                      <button class="btn btn-primary w-100 py-2 rounded-pill shadow" @click="handleAdminLogin" :disabled="loading">
                        <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span> 
                        {{ loading ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...' : '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö' }}
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- üü¢ ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü -->
            <div v-if="currentView === 'dashboard' && isAdminLoggedIn" class="container-fluid py-2">
              <div class="row g-3 mb-4" v-if="!loading">
                <div class="col-md-4">
                  <div class="card border-0 shadow-sm rounded-4 p-3 h-100">
                    <h6 class="fw-bold text-muted mb-3"><i class="fa-solid fa-chart-pie me-2"></i>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h6>
                    <canvas id="typeChart"></canvas>
                  </div>
                </div>
                <div class="col-md-8">
                  <div class="card border-0 shadow-sm rounded-4 p-3 h-100">
                    <h6 class="fw-bold text-muted mb-3"><i class="fa-solid fa-chart-column me-2"></i>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h6>
                    <canvas id="statusChart"></canvas>
                  </div>
                </div>
              </div>
            </div>

            <!-- ‚úÖ ‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£ (Batch) -->
            <div v-if="currentView === 'dashboard' && isAdminLoggedIn && userRole === 'admin'" class="container-fluid px-md-5 mb-3">
              <div class="alert alert-primary d-flex flex-column flex-md-row justify-content-between align-items-center rounded-4 shadow-sm p-4 border-0" style="background: linear-gradient(135deg, #e0e7ff 0%, #f1f5f9 100%);">
                <div class="mb-3 mb-md-0 text-center text-md-start">
                  <h5 class="fw-bold text-primary mb-1">
                    <i class="fa-solid fa-file-pdf me-2"></i>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£
                  </h5>
                  <p class="text-muted mb-0 small">
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 2 ‡∏ß‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£ PDF ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                  </p>
                </div>
                <button @click="runBatchCert" :disabled="loading" class="btn btn-primary btn-lg rounded-pill px-5 shadow-sm">
                  <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span>
                  <i v-else class="fa-solid fa-magic me-2"></i> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• PDF ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
              </div>
            </div>

            <!-- üü¢ 2. ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
            <div v-if="currentView === 'dashboard' && isAdminLoggedIn" class="container-fluid py-2">
              <div class="card border-0 shadow-sm rounded-4">

                <div v-if="loading" class="text-center py-5">
                  <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;"></div>
                  <p class="mt-3 text-muted fw-bold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>

                <div v-else>

                  <div class="card-header bg-white p-4 border-0">
                    <div class="row align-items-center g-3">
                      
                      <div class="col-xl-3 col-lg-12">
                        <h4 class="fw-800 text-primary mb-0 d-flex align-items-center">
                          <i class="fa-solid fa-gauge-high me-2"></i>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </h4>
                        <small class="text-muted">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</small>
                      </div>

                      <div class="col-xl-9 col-lg-12">
                        <div class="row g-2 justify-content-xl-end align-items-center">
                          
                          <div class="col-md-4 col-lg-3">
                            <div class="input-group input-group-sm shadow-sm">
                              <span class="input-group-text bg-light border-0">
                                <i class="fa-solid fa-filter text-muted"></i>
                              </span>
                              <select v-model="filterRegType" class="form-select border-0 bg-light fw-600">
                                <option value="">--‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó--</option>
                                <option :value="REG_STATUS.INTERNAL">‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡∏à‡∏∏‡∏¨‡∏≤‡∏Ø</option>
                                <option :value="REG_STATUS.QUOTA">‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤</option>
                                <option :value="REG_STATUS.EXTERNAL">‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å</option>
                              </select>
                            </div>
                          </div>

                          <div class="col-md-5 col-lg-5">
                            <div class="input-group input-group-sm shadow-sm">
                              <span class="input-group-text bg-white border-end-0">
                                <i class="fa-solid fa-magnifying-glass text-primary"></i>
                              </span>
                              <input type="text" 
                                    v-model="searchAdminQuery" 
                                    class="form-control border-start-0 ps-0" 
                                    placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ID, ‡∏ä‡∏∑‡πà‡∏≠, ‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ø, ‡∏≠‡∏µ‡πÄ‡∏°‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô...">
                              <button v-if="searchAdminQuery" 
                                      class="btn btn-white border-start-0 text-danger" 
                                      @click="searchAdminQuery = ''">
                                <i class="fa-solid fa-circle-xmark"></i>
                              </button>
                            </div>
                          </div>

                          <div class="col-md-3 col-lg-auto">
                            <button class="btn btn-primary btn-sm rounded-pill px-4 shadow-sm w-100 d-flex align-items-center justify-content-center" 
                                    @click="loadAdminTable" :disabled="loading" style="min-height: 31px;">
                              <i :class="['fa-solid fa-sync-alt me-2', { 'fa-spin': loading }]"></i>
                              <span class="fw-600">{{ loading ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...' : '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó' }}</span>
                            </button>
                          </div>

                        </div>
                      </div>

                    </div>
                  </div>

                  <div v-if="filterRegType || searchAdminQuery" class="px-4 pb-2">
                    <span class="badge bg-primary-subtle text-primary rounded-pill fw-normal">
                      ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç {{ filteredAdminData.length }} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                    </span>
                    <button class="btn btn-link btn-sm text-decoration-none" @click="filterRegType = ''; searchAdminQuery = ''">‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á</button>
                  </div>

                  <div class="table-responsive admin-desktop-table">
                    <table class="table table-hover align-middle mb-0" style="font-size: 0.8rem;">
                      <thead class="table-light text-nowrap">
                        <tr>
                          <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                          <th>ID</th>                          
                          <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                          <th class="text-center">‡∏™‡∏•‡∏¥‡∏õ</th>
                          <th width="200">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Pay-in</th>
                          <th width="200">‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</th>
                          <th width="150">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25</th>
                          <th width="150">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 26</th>
                          <th class="text-center" width="180">‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£</th>
                          <th v-if="userRole !== 'viewer'" class="text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr v-for="(item, index) in paginatedAdminData" :key="item.rowNumber"
                          :style="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL ? 'background-color: #f0f7ff;' : ''">

                          <td class="text-center fw-bold text-muted">
                            {{ ((currentPage - 1) * itemsPerPage) + index + 1 }}
                          </td>                       
                          <td><span class="badge bg-secondary">{{ item[COL.ID] }}</span></td>

                          <td>
                            <div class="fw-bold">{{item[COL.TITLE]}}{{item[COL.FNAME]}} {{item[COL.LNAME]}}</div>
                            
                            <div class="text-muted small">
                              <span v-if="item[COL.LICENSE] && item[COL.LICENSE] !== '-'">
                                <i class="fa-solid fa-id-card me-1"></i> {{ item[COL.LICENSE] }}
                              </span>
                              
                              <span v-else-if="item[COL.EMAIL] && item[COL.EMAIL] !== '-'">
                                <i class="fa-solid fa-envelope me-1"></i> {{ item[COL.EMAIL] }}
                              </span>
                              
                              <span v-else class="opacity-50">- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ -</span>
                            </div>
                          </td>
                          
                          <!-- üîµ 3. ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏•‡∏¥‡∏Å‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ -->
                          <td class="text-center">
                            <button v-if="item[COL.SLIP] && item[COL.SLIP] !== '-'" 
                                    type="button" 
                                    class="btn btn-sm btn-outline-info rounded-circle shadow-sm"
                                    style="width: 32px; height: 32px; padding: 0;"
                                    title="‡∏Ñ‡∏•‡∏¥‡∏Å‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô"
                                    @click="openSpeakerModal({ 
                                      img: item[COL.SLIP], 
                                      name: '‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô', 
                                      dept: item[COL.RECEIPT_NAME] || (item[COL.TITLE] + item[COL.FNAME] + ' ' + item[COL.LNAME]) 
                                    }, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ')">
                              <i class="fa-solid fa-receipt"></i>
                            </button>
                            <span v-else class="text-muted opacity-50 small">-</span>
                          </td>
                          
                          <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Pay-in -->
                          <td class="text-center">
                            <div v-if="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL">
                              <select v-model="item[COL.PAYIN_STATUS]" 
                                      class="status-badge-select shadow-sm"
                                      :class="{
                                        'status-empty': !item[COL.PAYIN_STATUS],
                                        'status-pending': item[COL.PAYIN_STATUS] === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                                        'status-success': item[COL.PAYIN_STATUS] === '‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß'
                                      }"
                                      :disabled="!['admin', 'finance'].includes(userRole)">
                                <option value="">- ‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß">‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß</option>
                              </select>
                            </div>
                            <div v-else><span class="text-muted small">-</span></div>
                          </td>

                          <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô -->
                          <td class="text-center">
                            <div v-if="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL">
                              <select v-model="item[COL.PAYMENT_STATUS]" 
                                      class="status-badge-select shadow-sm"
                                      :class="{
                                        'status-empty': !item[COL.PAYMENT_STATUS],
                                        'status-pending': item[COL.PAYMENT_STATUS] === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                                        'status-success': item[COL.PAYMENT_STATUS] === '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'
                                      }"
                                      :disabled="!['admin', 'finance'].includes(userRole)">
                                <option value="">- ‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö -</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</option>
                              </select>
                            </div>
                            <div v-else><span class="text-muted small">-</span></div>
                          </td>

                          <td class="text-center">
                            <select v-model="item[COL.ATTEND_1]" 
                                    class="status-badge-select shadow-sm"
                                    :class="{
                                      'status-empty': !item[COL.ATTEND_1],
                                      'status-success': item[COL.ATTEND_1] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°',
                                      'status-danger': item[COL.ATTEND_1] === '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°'
                                    }"
                                    :disabled="!['admin', 'editor'].includes(userRole)">
                              <option value="">- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -</option>
                              <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                              <option value="‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                            </select>
                          </td>

                          <td class="text-center">
                            <select v-model="item[COL.ATTEND_2]" 
                                    class="status-badge-select shadow-sm"
                                    :class="{
                                      'status-empty': !item[COL.ATTEND_2],
                                      'status-success': item[COL.ATTEND_2] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°',
                                      'status-danger': item[COL.ATTEND_2] === '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°'
                                    }"
                                    :disabled="!['admin', 'editor'].includes(userRole)">
                              <option value="">- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -</option>
                              <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                              <option value="‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                            </select>
                          </td>

                          <td class="text-center">
                            <div class="d-flex align-items-center justify-content-center">
                              <!-- <template v-if="item[COL.CERT_URL] && item[COL.CERT_URL] !== '-'"> -->
                              <template v-if="canDownload(item)">
                                <a :href="item[COL.CERT_URL]" 
                                  target="_blank" 
                                  class="btn btn-primary btn-sm rounded-pill px-3 shadow-sm d-flex align-items-center gap-2"
                                  style="font-size: 0.75rem;"
                                  @click="onDownloadClick(item.rowNumber)">
                                  <i class="fa-solid fa-file-arrow-down"></i> 
                                  <span>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</span>
                                  <span class="badge bg-white text-primary rounded-pill" style="font-size: 0.7rem; min-width: 20px;">
                                    {{ item[COL.DOWNLOAD] || 0 }}
                                  </span>
                                </a>
                              </template>
                              
                              <template v-else>
                                <span class="text-muted small">
                                  <i class="fa-solid fa-hourglass-start me-1 opacity-50"></i> ‡∏£‡∏≠‡πÑ‡∏ü‡∏•‡πå...
                                </span>
                              </template>
                            </div>
                          </td>
                          
                          <td v-if="userRole !== 'viewer'" class="text-center">
                            <div class="btn-group shadow-sm rounded-pill overflow-hidden">

                              <button class="btn btn-success btn-sm" 
                                  @click="saveAdminUpdate(item)" 
                                  :disabled="savingRows[item.rowNumber] || !isRowChanged(item)" 
                                  :class="!isRowChanged(item) ? 'opacity-50' : ''"
                                  title="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞">
                                  
                                  <span v-if="savingRows[item.rowNumber]" class="spinner-border spinner-border-sm"></span>
                                  
                                  <i v-else :class="isRowChanged(item) ? 'fa-solid fa-save' : 'fa-solid fa-check'" class="animate__animated animate__fadeIn"></i>
                              </button>
                              
                              <button class="btn btn-info btn-sm text-white" 
                                  @click="openAdminEditModal(item)" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å">
                                  <i class="fa-solid fa-user-pen"></i>
                              </button>
                              <button v-if="['admin', 'editor'].includes(userRole)" class="btn btn-danger btn-sm" 
                                  @click="confirmDelete(item.rowNumber)" title="‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                                  <i class="fa-solid fa-trash"></i>
                              </button>
                            </div>
                          </td>
                        </tr>

                        <tr v-if="filteredAdminData.length === 0">
                          <td colspan="8" class="text-center py-5 text-muted">
                            <i class="fa-solid fa-magnifying-glass fa-2x mb-3 opacity-25"></i>
                            <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <!-- üü¢ ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (Pagination Controls) -->
                  <div v-if="totalPagesSummary > 1" class="d-flex flex-column flex-md-row justify-content-between align-items-center px-4 py-3 bg-light border-top gap-3">
                    <div class="small text-muted fw-bold">
                      ‡∏´‡∏ô‡πâ‡∏≤ {{ currentPageSummary }} / {{ totalPagesSummary }}
                    </div>
                    
                    <nav>
                      <ul class="pagination pagination-sm mb-0 shadow-sm">
                        <li class="page-item" :class="{ disabled: currentPageSummary === 1 }">
                          <a class="page-link px-3" href="#" @click.prevent="changePageSummary(currentPageSummary - 1)">
                            <i class="fa-solid fa-angle-left"></i>
                          </a>
                        </li>

                        <!-- ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤ (‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á) -->
                        <li v-for="p in totalPagesSummary" :key="p" 
                            v-show="p >= currentPageSummary - 2 && p <= currentPageSummary + 2"
                            class="page-item" :class="{ active: currentPageSummary === p }">
                          <a class="page-link px-3" href="#" @click.prevent="changePageSummary(p)">{{ p }}</a>
                        </li>

                        <li class="page-item" :class="{ disabled: currentPageSummary === totalPagesSummary }">
                          <a class="page-link px-3" href="#" @click.prevent="changePageSummary(currentPageSummary + 1)">
                            <i class="fa-solid fa-angle-right"></i>
                          </a>
                        </li>
                      </ul>
                    </nav>
                  </div>

                  <!-- Mobile View -->
                  <div class="admin-mobile-card p-2">
                    <div v-for="item in paginatedAdminData" :key="item.rowNumber" class="data-card animate__animated animate__fadeIn mb-3 shadow-sm border-0 rounded-4">
                      
                      <div class="d-flex justify-content-between align-items-center mb-3 p-3 bg-light rounded-top-4 border-bottom">
                        <div>
                          <span class="badge bg-primary px-3 rounded-pill">ID: {{item[COL.ID]}}</span>
                          <small class="text-muted ms-2">‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà: {{item.rowNumber}}</small>
                        </div>
                        <span class="badge bg-secondary-subtle text-secondary border rounded-pill">{{item[COL.REG_TYPE]}}</span>
                      </div>

                      <div class="px-3 pb-3">
                        <div class="mb-3">
                          <div class="card-label mb-1"><i class="fa-solid fa-user me-1"></i> ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</div>
                          <div class="fw-bold text-dark fs-5">{{item[COL.TITLE]}}{{item[COL.FNAME]}} {{item[COL.LNAME]}}</div>
                          <div class="text-muted small"><i class="fa-solid fa-envelope me-1"></i> {{item[COL.EMAIL]}}</div>
                        </div>

                        <div class="row g-3">
                          <template v-if="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL">
                            <div class="col-6">
                              <label class="card-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Pay-in</label>
                              <select v-model="item[COL.PAYIN_STATUS]" class="status-badge-select shadow-sm"
                                      :class="{'status-empty': !item[COL.PAYIN_STATUS], 'status-pending': item[COL.PAYIN_STATUS] === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', 'status-success': item[COL.PAYIN_STATUS] === '‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß'}"
                                      :disabled="!['admin', 'finance'].includes(userRole)">
                                <option value="">- ‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß">‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß</option>
                              </select>
                            </div>
                            <div class="col-6">
                              <label class="card-label">‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</label>
                              <select v-model="item[COL.PAYMENT_STATUS]" class="status-badge-select shadow-sm"
                                      :class="{'status-empty': !item[COL.PAYMENT_STATUS], 'status-pending': item[COL.PAYMENT_STATUS] === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', 'status-success': item[COL.PAYMENT_STATUS] === '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'}"
                                      :disabled="!['admin', 'finance'].includes(userRole)">
                                <option value="">- ‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö -</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</option>
                              </select>
                            </div>
                          </template>

                          <div :class="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL ? 'col-6' : 'col-12 col-sm-6'">
                            <label class="card-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25</label>
                            <select v-model="item[COL.ATTEND_1]" class="status-badge-select shadow-sm"
                                    :class="{'status-empty': !item[COL.ATTEND_1], 'status-success': item[COL.ATTEND_1] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°', 'status-danger': item[COL.ATTEND_1] === '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°'}"
                                    :disabled="!['admin', 'editor'].includes(userRole)">
                              <option value="">- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -</option>
                              <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                              <option value="‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                            </select>
                          </div>
                          <div :class="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL ? 'col-6' : 'col-12 col-sm-6'">
                            <label class="card-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 26</label>
                            <select v-model="item[COL.ATTEND_2]" class="status-badge-select shadow-sm"
                                    :class="{'status-empty': !item[COL.ATTEND_2], 'status-success': item[COL.ATTEND_2] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°', 'status-danger': item[COL.ATTEND_2] === '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°'}"
                                    :disabled="!['admin', 'editor'].includes(userRole)">
                              <option value="">- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -</option>
                              <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                              <option value="‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                            </select>
                          </div>
                        </div>

                        <div class="mb-3">
                          <div class="card-label mb-2">‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£</div>
                          <template v-if="canDownload(item)">
                            <a :href="item[COL.CERT_URL]" target="_blank" class="btn btn-outline-primary btn-sm w-100 rounded-pill py-2" 
                                @click="onDownloadClick(item.rowNumber)">
                                <i class="fa-solid fa-file-arrow-down me-2"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î ({{ item[COL.DOWNLOAD] || 0 }})
                            </a>
                          </template>
                          <div v-else class="alert alert-light py-2 mb-0 text-center border rounded-pill">
                            <small class="text-muted"><i class="fa-solid fa-hourglass-start me-1"></i> ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå/‡∏£‡∏≠‡πÑ‡∏ü‡∏•‡πå...</small>
                          </div>
                        </div>

                        <div v-if="userRole !== 'viewer'" class="row g-2 mt-2">
                          <div class="col-8">
                            <button 
                              class="btn btn-success w-100 rounded-pill py-2 shadow-sm" 
                              @click="saveAdminUpdate(item)" 
                              :disabled="savingRows[item.rowNumber] || !isRowChanged(item)">
                              <span v-if="savingRows[item.rowNumber]" class="spinner-border spinner-border-sm me-2"></span>
                              
                              <i v-else :class="isRowChanged(item) ? 'fa-solid fa-save' : 'fa-solid fa-check-circle'" class="me-2"></i>
                              {{ isRowChanged(item) ? '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç' : '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô' }}

                            </button>
                          </div>

                          <div class="col-2 text-center">
                            <button class="btn btn-info text-white rounded-circle py-2 shadow-sm  me-2" 
                              @click="openAdminEditModal(item)">
                              <i class="fa-solid fa-user-pen"></i>
                            </button>
                          </div>

                          <div class="col-2 text-center" v-if="['admin', 'editor'].includes(userRole)">
                            <button class="btn btn-danger rounded-circle py-2 shadow-sm" 
                              @click="confirmDelete(item.rowNumber)">
                              <i class="fa-solid fa-trash"></i>
                            </button>
                          </div>

                        </div>
                      </div>
                    </div>

                    <div v-if="filteredAdminData.length === 0" class="text-center py-5 text-muted">
                      <i class="fa-solid fa-magnifying-glass fa-2x mb-3 opacity-25"></i>
                      <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                    </div>
                  </div>

                  <div v-if="totalPages > 1" class="d-flex flex-column flex-md-row justify-content-between align-items-center px-4 py-3 bg-white border-top gap-3 rounded-bottom-4 shadow-sm">
                    <div class="small text-muted fw-bold">
                      ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ {{ currentPage }} / {{ totalPages }} (‡∏û‡∏ö {{ filteredAdminData.length }} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
                    </div>
                    
                    <nav>
                      <ul class="pagination pagination-sm mb-0 shadow-sm">
                        <li class="page-item" :class="{ disabled: currentPage === 1 }">
                          <a class="page-link px-3" href="#" @click.prevent="changePage(currentPage - 1)">
                            <i class="fa-solid fa-angle-left"></i>
                          </a>
                        </li>

                        <li v-for="p in totalPages" :key="p" 
                            v-show="p >= currentPage - 2 && p <= currentPage + 2"
                            class="page-item" :class="{ active: currentPage === p }">
                          <a class="page-link px-3" href="#" @click.prevent="changePage(p)">{{ p }}</a>
                        </li>

                        <li class="page-item" :class="{ disabled: currentPage === totalPages }">
                          <a class="page-link px-3" href="#" @click.prevent="changePage(currentPage + 1)">
                            <i class="fa-solid fa-angle-right"></i>
                          </a>
                        </li>
                      </ul>
                    </nav>
                  </div>

                </div>
              </div>
            </div>

            <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Step 1) -->
            <div v-show="currentView === 'form'">
              <div class="card-body p-4 p-md-5" v-if="step === 1">

                <!-- üü¢ ‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (View Search) -->
                <div class="search-integrated-container mb-5 p-4 rounded-4 shadow-sm border-dashed">
                  <div class="row align-items-center">
                    <div class="col-md-6">
                      <h5 class="fw-bold text-primary mb-1">
                        <i class="fa-solid fa-user-check me-2"></i>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                      </h5>
                      <p class="text-muted small mb-3 mb-md-0">‡∏´‡∏≤‡∏Å‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏¢‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                    </div>
                    <div class="col-md-6">
                      <div class="input-group shadow-sm">
                        <input type="text" v-model="searchQuery" class="form-control" placeholder="ID / ‡∏≠‡∏µ‡πÄ‡∏°‡∏• / ‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ø" @keyup.enter="handleSearch">
                        <button class="btn btn-primary px-4" @click="handleSearch" :disabled="loading">
                          <span v-if="loading" class="spinner-border spinner-border-sm me-1"></span> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- üîµ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤) -->
                  <div v-if="searchResult && searchResult.length > 0" id="search-result-section" class="mt-4 animate__animated animate__fadeIn">

                    <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-md-between mb-3 px-2 gap-2">
                      <h5 class="fw-bold text-primary mb-0">
                        <i class="fa-solid fa-clipboard-list me-2"></i>‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô
                      </h5>
                      <span class="badge bg-primary rounded-pill py-2 px-3 shadow-sm">
                        ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î {{ searchResult.length }} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                      </span>
                    </div>

                    <div v-for="(item, index) in searchResult" :key="index" class="card mb-2 border-0 shadow-sm rounded-4 overflow-hidden result-card">
                      <!-- ‡πÅ‡∏ñ‡∏ö‡∏™‡∏µ‡∏ö‡πà‡∏á‡∏ö‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô -->
                      <div :class="['category-strip', 
                        item[COL.REG_TYPE] === REG_STATUS.INTERNAL ? 'bg-internal' : 
                        item[COL.REG_TYPE] === REG_STATUS.QUOTA ? 'bg-quota' : 'bg-external']">
                      </div>

                      <div class="card-body p-0">
                        <div class="row g-0">
                          
                          <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å (Main Info) -->
                          <div class="col-lg-7 p-4">
                            <div class="d-flex flex-column flex-sm-row align-items-center align-items-sm-start mb-3">

                              <div class="avatar-icon mb-2 mb-sm-0 me-sm-3 flex-shrink-0">
                                
                                <!-- üü¢ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û -->
                                <img v-if="item[COL.IMAGE] && item[COL.IMAGE] !== '-'" 
                                    :src="item[COL.IMAGE]" 
                                    class="rounded-circle border border-2 border-primary shadow-sm" 
                                    style="width: 80px; height: 80px; object-fit: cover;">

                                <i v-else class="fa-solid fa-circle-user fa-5x text-primary opacity-50"></i>
                                
                              </div>
                              
                              <div class="text-center text-sm-start w-100" style="min-width: 0;">
                                <h4 class="fw-bold mb-2 text-dark text-break">{{ item[COL.TITLE] }}{{item[COL.FNAME]}}  {{item[COL.LNAME]}}</h4>

                                <div class="d-flex flex-wrap justify-content-center justify-content-sm-start gap-2">
                                  <span class="badge badge-custom bg-dark text-white text-wrap shadow-sm">
                                    <i class="fa-solid fa-hashtag me-1"></i> ID: {{ item[COL.ID] }}
                                  </span>
                                  <span class="badge badge-custom bg-soft-primary text-primary text-wrap border border-primary border-opacity-10">
                                    <i class="fa-solid fa-id-card-clip me-1"></i> {{item[COL.REG_TYPE]}}
                                  </span>
                                  <span class="badge badge-custom bg-soft-warning text-dark text-wrap border border-warning border-opacity-10">
                                    <i class="fa-solid fa-user-tag me-1"></i> {{item[COL.POSITION]}}
                                  </span>
                                </div>
                              </div>
                            </div>

                            <div class="info-grid mt-4">
                              <div class="row g-3">
                                <!-- [1] ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô: ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå -->
                                <div class="col-sm-6">
                                  <div class="info-item">
                                    <label>‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û</label>
                                    <p>{{item[COL.LICENSE] || '-'}}</p>
                                  </div>
                                </div>
                                <div class="col-sm-6">
                                  <div class="info-item">
                                    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                                    <p>{{item[COL.PHONE] || '-'}}</p>
                                  </div>
                                </div>

                                <!-- [2] ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô / ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î: ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå -->
                                <div class="col-12">
                                  <div class="info-item">
                                    <label>
                                      {{ item[COL.REG_TYPE] === REG_STATUS.INTERNAL ? '‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô / ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô' : '‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î / ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô' }}
                                    </label>
                                    <p>
                                      <i class="fa-solid fa-hospital-alt me-1 text-muted"></i>
                                      <!-- ‡∏Å‡∏£‡∏ì‡∏µ: ‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô -->
                                      <span v-if="item[COL.REG_TYPE] === REG_STATUS.INTERNAL">
                                        {{ item[COL.DEPARTMENT] }} ({{ item[COL.WORK_GROUP] }})
                                      </span>
                                      <!-- ‡∏Å‡∏£‡∏ì‡∏µ: ‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å -->
                                      <span v-else>
                                        {{ item[COL.WORKPLACE] }}
                                      </span>
                                    </p>
                                  </div>
                                </div>

                                <!-- [3] ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ "‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å" 
                                    (‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•) -->
                                <div class="col-12" v-if="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL">
                                  <div class="info-item">
                                    <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</label>
                                    <p>
                                      <i class="fa-solid fa-map-location-dot me-1 text-muted"></i>
                                      {{ item[COL.ADDRESS] || '-' }}
                                    </p>
                                  </div>
                                  <!-- ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ (‡πÅ‡∏™‡∏î‡∏á‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•) -->
                                  <div class="mt-2" v-if="item[COL.TAX_ID]">
                                    <label class="small text-muted text-uppercase" style="font-size: 0.65rem;">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</label>
                                    <p class="small fw-bold mb-0">{{ item[COL.TAX_ID] }}</p>
                                  </div>
                                </div>

                                <!-- [4] ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡∏¥‡∏°: ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå -->
                                <div class="col-sm-6">
                                  <div class="info-item">
                                    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
                                    <p><i class="fa-solid fa-utensils me-1 text-muted"></i> {{item[COL.FOOD]}}</p>
                                  </div>
                                </div>

                                <div class="col-sm-6">
                                  <div class="info-item">
                                    <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                                    <p><i class="fa-solid fa-envelope me-1 text-muted"></i>{{ item[COL.EMAIL] }}</p>
                                  </div>
                                </div>

                                <div class="col-sm-6">
                                  <div class="info-item">
                                    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</label>
                                    <p><i class="fa-solid fa-calendar-check me-1 text-muted"></i> {{ formatThaiDate(item[COL.TIMESTAMP, true]) }}</p>
                                  </div>
                                </div>

                              </div>
                            </div>
                            
                          </div>

                          <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (Status & Actions) -->
                          <div class="col-lg-5 bg-light-status p-4 border-start">
                            <template v-if="canUserEdit">
                              <div class="qr-section text-center mb-4 p-3 bg-white rounded-4 shadow-sm border">
                                <small class="text-primary fw-bold d-block mb-2">
                                  <i class="fa-solid fa-qrcode me-1"></i> QR Code ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
                                </small>
                                
                                <div class="d-inline-block p-2 border rounded-3 bg-white" style="max-width: 100%; height: auto;">
                                  <img :src="'https://quickchart.io/qr?text=' + encodeURIComponent(item[COL.ID] + '|' + item[COL.FNAME] + '|' + item[COL.LNAME]) + '&size=300'"
                                      alt="QR Code" 
                                      class="img-fluid"
                                      style="width: 100%; max-width: 250px; height: auto; aspect-ratio: 1 / 1; display: block; margin: auto; image-rendering: pixelated;">
                                </div>
                                
                                <div class="mt-2">
                                  <div class="fw-bold small mb-1">{{ item[COL.TITLE] }}{{ item[COL.FNAME] }}  {{ item[COL.LNAME] }}</div>
                                  <span class="badge bg-dark rounded-pill px-3 mb-2">ID: {{ item[COL.ID] }}</span>
                                  
                                  <button @click="downloadQr(item[COL.ID], item[COL.FNAME], item[COL.LNAME])" class="btn btn-outline-primary btn-sm w-100 rounded-pill mt-2">
                                    <i class="fa-solid fa-download me-1"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î QR Code
                                  </button>
                                </div>

                                <p class="text-dark mt-2 mb-0" style="font-size: 0.8rem;">
                                  ‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏™‡∏î‡∏á QR Code ‡∏ô‡∏µ‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà ‡∏ì ‡∏à‡∏∏‡∏î‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                                </p>
                              </div>
                            </template>

                            <!-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å) -->
                            <div v-if="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL" class="status-box mb-2">
                              <h6 class="fw-bold text-muted mb-3"><i class="fa-solid fa-wallet me-2"></i>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h6>
                              <div class="row g-2">
                                <div class="col-6">
                                  <div class="status-card text-center p-2 rounded-3 border bg-white shadow-sm">
                                    <div class="tiny-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Pay-in</div>
                                    <div :class="['fw-bold small', item[COL.PAYIN_STATUS] === '‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß' ? 'text-success' : 'text-secondary']">
                                      {{ item[COL.PAYIN_STATUS] || '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' }}
                                    </div>
                                  </div>
                                </div>
                                <div class="col-6">
                                  <div class="status-card text-center p-2 rounded-3 border bg-white shadow-sm">
                                    <div class="tiny-label">‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</div>
                                    <div :class="['fw-bold small', item[COL.PAYMENT_STATUS] === '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢' ? 'text-success' : 'text-secondary']">
                                      {{ item[COL.PAYMENT_STATUS] || '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' }}
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <!-- üîµ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ) -->
                              <div v-if="item[COL.SLIP] && item[COL.SLIP] !== '-'" class="mt-3">
                                <button type="button" 
                                        @click="openSpeakerModal({ 
                                          img: item[COL.SLIP], 
                                          name: '‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô', 
                                          dept: item[COL.RECEIPT_NAME] || (item[COL.TITLE] + item[COL.FNAME] + ' ' + item[COL.LNAME]) 
                                        }, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ')" 
                                        class="btn btn-outline-primary btn-sm w-100 rounded-pill shadow-sm">
                                  <i class="fa-solid fa-receipt me-2"></i>‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                                </button>
                              </div>

                            </div>

                            <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö Batch) -->
                            <div class="action-buttons d-grid gap-3">
                              
                              <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 2 ‡∏ß‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà -->
                              <div v-if="canDownload(item)">
                                  
                                  <div v-if="item[COL.CERT_URL] && item[COL.CERT_URL].startsWith('http')">
                                      
                                      <template v-if="isCertTimeOpen">
                                          <a :href="item[COL.CERT_URL]" target="_blank" @click="onDownloadClick(item.rowNumber)" 
                                            class="btn btn-success w-100 py-2 rounded-pill shadow btn-hover-grow d-flex align-items-center justify-content-center gap-2">
                                              <i class="fa-solid fa-certificate"></i>
                                              <span>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£</span>
                                              <span class="badge rounded-pill bg-white text-success small border" style="font-size: 0.7rem;">
                                                  {{ item[COL.DOWNLOAD] || 0 }} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                                              </span>
                                          </a>
                                          <p class="text-center text-success mt-2 mb-0" style="font-size: 0.75rem;">
                                              <i class="fa-solid fa-check-double"></i> ‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç
                                          </p>
                                      </template>

                                      <div v-else class="alert alert-warning border-0 mb-0 rounded-4 text-center shadow-sm">
                                          <i class="fa-solid fa-clock-rotate-left me-2"></i>
                                          <strong>‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</strong><br>
                                          <span class="small">{{ formatThaiDate(certDeadline, true) }}</span>
                                      </div>
                                  </div>

                                  <div v-else class="alert alert-info border-0 mb-0 rounded-4 shadow-sm text-center animate__animated animate__fadeIn">
                                      <div class="d-flex align-items-center justify-content-center gap-2 mb-1">
                                          <i class="fa-solid fa-hourglass-half fa-spin text-primary"></i>
                                          <strong class="text-primary">‡∏ó‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ø</strong>
                                      </div>
                                      <div class="small text-muted">‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÑ‡∏ü‡∏•‡πå PDF<br>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á</div>
                                  </div>
                                  
                              </div>
                              
                              <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏Å‡∏£‡∏ì‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö (‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö 2 ‡∏ß‡∏±‡∏ô) -->
                              <div v-else class="alert alert-warning border-0 small mb-0 rounded-4 shadow-sm text-center">
                                <i class="fa-solid fa-circle-info me-1"></i> 
                                ‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 2 ‡∏ß‡∏±‡∏ô
                                <div class="mt-1 opacity-75" style="font-size: 0.7rem;">
                                  (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25: {{item[COL.ATTEND_1] || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πÅ‡∏Å‡∏ô'}}, ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 26: {{item[COL.ATTEND_2] || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πÅ‡∏Å‡∏ô'}})
                                </div>
                              </div>

                              <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏ï‡∏≤‡∏°‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤) -->
                              <div class="action-buttons d-grid gap-3">
                                <template v-if="canUserEdit">
                                  <button @click="prepareEdit(item)" class="btn btn-outline-warning w-100 py-2 rounded-pill btn-hover-grow fw-600">
                                    <i class="fa-solid fa-user-pen me-2"></i>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                                  </button>
                                </template>

                                <div v-else-if="isTimerLoaded" class="alert alert-light border-0 py-3 mb-0 rounded-4 text-center shadow-sm" 
                                      style="background-color: #f8f9fa;">
                                  <div class="text-danger mb-1 fw-bold">
                                    <i class="fa-solid fa-clock-rotate-left me-2"></i>‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß
                                  </div>
                                  <div class="small text-muted">
                                    ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 30 ‡∏°‡∏¥.‡∏¢. 69 (18:00 ‡∏ô.)
                                  </div>
                                  <hr class="my-2 opacity-10">
                                  <div class="small fw-600 text-primary">
                                    <i class="fa-solid fa-headset me-1"></i> ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
                                  </div>
                                </div>
                              </div>

                            </div>
                        
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <div class="text-center mt-4">
                      <button class="btn btn-link text-secondary text-decoration-none" 
                        @click="searchResult = null; searchQuery = ''">
                        <i class="fa-solid fa-xmark me-1"></i> ‡∏õ‡∏¥‡∏î‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                      </button>
                    </div>
                  </div>

                </div>
                <!-- =================================================================== -->

                <template v-if="canUserEdit">
                  <form @submit.prevent="goToSummary">
                    <!-- ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‡πÅ‡∏•‡∏∞ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
                    <h4 :class="['section-title d-flex align-items-center mb-2', { 'text-warning': isEditMode }]">
                      <i :class="['me-2', isEditMode ? 'fa-solid fa-user-pen text-warning' : 'fa-solid fa-user-plus']"></i>
                      {{ isEditMode ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô' : '‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô' }}
                    </h4>

                    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ -->
                    <div v-if="isEditMode" class="mb-3 text-end">
                      <span class="badge bg-light text-dark border fw-normal">
                        <i class="fa-solid fa-clock-rotate-left me-1 text-primary"></i> 
                        ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠: {{ formatThaiDate(form.timestamp, true) }}
                      </span>
                    </div>

                    <div class="alert alert-info border-0 rounded-4 shadow-sm mb-4">
                      <i class="fa-solid fa-circle-info me-2"></i> 
                      ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏≠‡∏ö‡∏£‡∏° ‡∏Ñ‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô 2,000 ‡∏ö‡∏≤‡∏ó 
                      <br><small class="ms-4 text-danger font-weight-bold">*‡∏Ç‡∏≠‡∏™‡∏á‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏°‡πà‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏Å‡∏Å‡∏£‡∏ì‡∏µ*</small>
                    </div>

                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß + ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ (‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ñ‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô) -->
                    <div class="row g-4 mb-5">
                      
                      <!-- ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢: ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
                      <div class="col-lg-8 border-end-lg">
                        <h5 class="section-title d-flex align-items-center mb-4">
                          <i class="fa-solid fa-user-pen me-2"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
                        </h5>
                        
                        <div class="row g-3">
                          <div class="col-md-12">
                            <label class="form-label" :class="{'required': !OPTIONAL_POSITIONS.includes(form.internalPosition)}">
                              ‡∏≠‡∏µ‡πÄ‡∏°‡∏•
                            </label>
                            <div class="input-icon-wrapper">
                              <i class="fa-solid fa-envelope"></i>
                              <input type="email" v-model="form.email" class="form-control" placeholder="example@gmail.com" 
                                    @input="formatEmail(false)"
                                    :required="!OPTIONAL_POSITIONS.includes(form.internalPosition)">
                            </div>
                          </div>
                          
                          <div class="col-md-4">
                            <label class="form-label required">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
                            <div class="input-icon-wrapper">
                              <i class="fa-solid fa-user-tag"></i>
                              <select v-model="form.title_Name" class="form-select" required>
                                <option value="" disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option v-for="item in prefixOptions" :key="item" :value="item">{{ item }}</option>
                              </select>
                            </div>
                          </div>

                          <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏ä‡∏∑‡πà‡∏≠ -->
                          <div class="col-md-4">
                            <label class="form-label required">‡∏ä‡∏∑‡πà‡∏≠</label>
                            <input type="text" 
                                  v-model="form.firstName" 
                                  @input="formatName('firstName')" 
                                  class="form-control" 
                                  placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢" 
                                  required>
                          </div>

                          <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• -->
                          <div class="col-md-4">
                            <label class="form-label required">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                            <input type="text" 
                                  v-model="form.lastName" 
                                  @input="formatName('lastName')" 
                                  class="form-control" 
                                  placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢" 
                                  required>
                          </div>

                          <div class="col-md-6">
                            <label class="form-label" :class="{'required': !OPTIONAL_POSITIONS.includes(form.internalPosition)}">
                              ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå
                            </label>
                            <div class="input-icon-wrapper">
                              <i class="fa-solid fa-phone"></i>
                              <input type="text" v-model="form.phoneNumber" @input="formatPhone" class="form-control" 
                                    placeholder="0xx-xxx-xxxx" maxlength="12" 
                                    :required="!OPTIONAL_POSITIONS.includes(form.internalPosition)">
                            </div>
                          </div>

                          <div class="col-md-6">
                            <label class="form-label" :class="{'required': !OPTIONAL_POSITIONS.includes(form.internalPosition)}">
                              ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û (10 ‡∏´‡∏•‡∏±‡∏Å)
                            </label>
                            <div class="input-icon-wrapper">
                              <i class="fa-solid fa-id-card-clip"></i>
                              <input type="text" v-model="form.proLicense" @input="formatLicense" class="form-control" 
                                    placeholder="‡πÄ‡∏•‡∏Ç 10 ‡∏´‡∏•‡∏±‡∏Å" maxlength="10" 
                                    :required="!OPTIONAL_POSITIONS.includes(form.internalPosition)">
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤: ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ -->
                      <div class="col-lg-4 ps-lg-4">
                        <h5 class="section-title d-flex align-items-center mb-4">
                          <i class="fa-solid fa-camera me-2"></i> ‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
                        </h5>
                        <div class="camera-card border rounded-4 p-4 shadow-sm text-center">
                            <!-- ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏û‡∏£‡∏µ‡∏ß‡∏¥‡∏ß -->
                            <div class="camera-circle-wrapper mb-3">
                                <video v-if="isCameraActive" 
                                      id="webcam" 
                                      autoplay 
                                      playsinline 
                                      :style="{ transform: 'scaleX(-1) scale(' + cameraZoom + ')' }">
                                </video>
                                
                                <canvas id="canvas" class="d-none"></canvas>
                                
                                <!-- ‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏á‡∏ñ‡πà‡∏≤‡∏¢ -->
                                <img v-if="profilePreview" :src="profilePreview" class="photo-preview-img">
                                
                                <div v-if="!profilePreview && !isCameraActive" 
                                    class="camera-placeholder w-100 h-100 position-absolute top-0 start-0 d-flex align-items-center justify-content-center">
                                    <i class="fa-solid fa-user-nurse fa-4x opacity-25"></i>
                                </div>
                            </div>

                            <!-- ‡πÅ‡∏ñ‡∏ö‡∏ã‡∏π‡∏° -->
                            <div v-if="isCameraActive" class="zoom-control-wrapper animate__animated animate__fadeIn">
                                <div class="zoom-label">
                                    <span><i class="fa-solid fa-magnifying-glass-minus"></i></span>
                                    <span>‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢</span>
                                    <span><i class="fa-solid fa-magnifying-glass-plus"></i></span>
                                </div>
                                <input type="range" v-model="cameraZoom" class="form-range" min="1" max="3" step="0.1">
                            </div>

                            <div class="camera-btn-group">
                                
                                <button type="button" v-if="!isCameraActive && !profilePreview" 
                                    @click="startWebcam" 
                                    class="btn btn-outline-primary btn-sm rounded-pill px-4">
                                    <i class="fa-solid fa-video me-2"></i>‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
                                </button>

                                <button type="button" v-if="!isCameraActive && !profilePreview" 
                                    @click="$refs.fileInput.click()" 
                                    class="btn btn-outline-primary btn-sm rounded-pill px-3">
                                    <i class="fa-solid fa-image me-2"></i>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                                </button>
                                <input type="file" ref="fileInput" class="d-none" accept="image/*" @change="handleFileUpload">

                                <button type="button" v-if="isCameraActive" 
                                    @click="capturePhoto" class="btn btn-success btn-sm rounded-pill px-4">
                                    <i class="fa-solid fa-camera me-2"></i>‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ
                                </button>

                                <button type="button" v-if="isCameraActive" 
                                    @click="stopWebcam" class="btn btn-danger btn-sm rounded-pill px-4">
                                    <i class="fa-solid fa-video-slash me-2"></i>‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
                                </button>

                                <button type="button" v-if="profilePreview && !isCameraActive" 
                                    @click="retakePhoto" class="btn btn-outline-warning btn-sm rounded-pill px-4">
                                    <i class="fa-solid fa-rotate me-2"></i> {{ isEditMode ? '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ‡πÉ‡∏´‡∏°‡πà' : '‡∏ñ‡πà‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà' }}
                                </button>
                                
                            </div>
                        </div>
                      </div>

                    </div>

                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (‡∏¢‡πâ‡∏≤‡∏¢‡∏•‡∏á‡∏°‡∏≤‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≤‡∏á‡∏•‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô) -->
                      <h5 class="section-title d-flex align-items-center mb-4">
                        <i class="fa-solid fa-utensils"></i> ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£
                      </h5>    
                      <div class="registration-grid">
                        <label class="reg-item">
                          <input type="radio" class="reg-input" v-model="form.foodType" value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ" id="f1" required>
                          <div class="reg-card p-3">
                            <i class="fa-solid fa-plate-wheat"></i>
                            <span>‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</span>
                          </div>
                        </label>
                        <label class="reg-item">
                          <input type="radio" class="reg-input" v-model="form.foodType" value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏¥‡∏™‡∏•‡∏≤‡∏°" id="f2">
                          <div class="reg-card p-3">
                            <i class="fa-solid fa-mosque"></i>
                            <span>‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏¥‡∏™‡∏•‡∏≤‡∏°</span>
                          </div>
                        </label>
                      </div>

                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô -->
                    <h5 class="section-title d-flex align-items-center mt-4">
                      <i class="fa-solid fa-address-card"></i> ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                    </h5>

                    <div class="row g-4">

                      <div class="col-lg-4">
                        <div class="registration-grid d-flex flex-column gap-3">

                        <label class="reg-item w-100" 
                              :class="{ 'opacity-50': isExternalClosed && !isAdminLoggedIn && !isEditMode }">                          
                          <input type="radio" class="reg-input" 
                                v-model="form.status_Register" 
                                :value="REG_STATUS.EXTERNAL"
                                :disabled="isExternalClosed && !isAdminLoggedIn && !isEditMode"> <div class="reg-card p-3 h-100 justify-content-center" 
                              :class="{ 'border-danger': isExternalClosed && !isAdminLoggedIn && !isEditMode }">
                            <i class="fa-solid fa-globe mb-2"></i>
                            <span>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô<br>‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å (‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ)</span>
                            
                            <small v-if="isExternalClosed && !isAdminLoggedIn && !isEditMode" class="text-danger fw-bold mt-1">
                              ( ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß )
                            </small>
                          </div>
                        </label>

                          <label class="reg-item w-100" 
                                :class="{ 'opacity-50': !isEditMode && !isAdminLoggedIn && form.status_Register !== REG_STATUS.INTERNAL }">
                            <input type="radio" class="reg-input" v-model="form.status_Register" 
                                  :value="REG_STATUS.INTERNAL"
                                  :disabled="!isEditMode && !isAdminLoggedIn"> <div class="reg-card p-3 h-100 justify-content-center">
                              <i class="fa-solid fa-hospital-user mb-2"></i>
                              <span>‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•<br>‡∏£‡∏û.‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå</span>
                              <small v-if="!isEditMode && !isAdminLoggedIn" class="text-danger fw-bold mt-1">( ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÉ‡∏´‡πâ )</small>
                              <small v-else-if="isAdminLoggedIn && !isEditMode" class="text-success fw-bold mt-1">( ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÉ‡∏´‡πâ )</small>
                            </div>
                          </label>

                          <label class="reg-item w-100" 
                                :class="{ 'opacity-50': !isEditMode && !isAdminLoggedIn && form.status_Register !== REG_STATUS.QUOTA }">
                            <input type="radio" class="reg-input" v-model="form.status_Register" 
                                  :value="REG_STATUS.QUOTA"
                                  :disabled="!isEditMode && !isAdminLoggedIn"> <div class="reg-card p-3 h-100 justify-content-center">
                              <i class="fa-solid fa-envelope-circle-check mb-2"></i>
                              <span>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤<br>‡∏ï‡∏≤‡∏°‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏ä‡∏¥‡∏ç</span>
                              <small v-if="!isEditMode && !isAdminLoggedIn" class="text-danger fw-bold mt-1">( ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÉ‡∏´‡πâ )</small>
                              <small v-else-if="isAdminLoggedIn && !isEditMode" class="text-success fw-bold mt-1">( ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÉ‡∏´‡πâ )</small>
                            </div>
                          </label>

                        </div>
                      </div>

                      <div class="col-lg-8">
                        
                        <div v-if="!form.status_Register" class="status-section text-center py-5 d-flex flex-column align-items-center justify-content-center bg-white shadow-sm border-dashed" style="margin:0; min-height: 350px;">
                          <i class="fa-solid fa-arrow-left fa-3x mb-3 text-muted opacity-25 d-none d-lg-block"></i>
                          <i class="fa-solid fa-arrow-up fa-3x mb-3 text-muted opacity-25 d-lg-none"></i>
                          <h5 class="text-muted">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢</h5>
                        </div>

                        <div v-if="form.status_Register === REG_STATUS.INTERNAL" class="status-section shadow-sm m-0 animate__animated animate__fadeIn">
                          <div class="status-header text-internal">
                            <i class="fa-solid fa-hospital-user"></i>
                            <div>
                              <h5>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÉ‡∏ô‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏£‡∏û.‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå</h5>
                              <div class="deadline-info">
                                <i class="fa-solid fa-calendar-day me-1"></i> ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏û.‡∏Ñ. - 30 ‡∏°‡∏¥.‡∏¢. 2569
                              </div>
                            </div>
                          </div>
                          <div class="row g-3">
                            <div class="col-md-12">
                              <label class="form-label required">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
                              <div class="input-icon-wrapper">
                                <i class="fa-solid fa-user-nurse"></i>
                                <select v-model="form.internalPosition" class="form-select" :class="{'is-invalid-field': errors.internalPosition}" required>
                                  <option value="" disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á --</option>
                                  <option v-for="item in professionOptions" :key="item" :value="item">{{ item }}</option>
                                  <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á)</option>
                                </select>
                              </div>
                              <div v-if="form.internalPosition === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'" class="mt-2">
                                <input type="text" v-model="form.internalPosition_OtherText" class="form-control" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" :required="form.internalPosition === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'">
                              </div>
                            </div>
                            <div class="col-md-12" v-if="!OPTIONAL_POSITIONS.includes(form.internalPosition)">
                              <label class="form-label required">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô</label>
                              <select v-model="form.workGroup" @change="onWorkGroupChange" class="form-select">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô --</option>
                                <option v-for="(depts, group) in workGroupData" :value="group">{{ group }}</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á)</option>
                              </select>
                            </div>
                            <div class="col-md-12" v-if="!OPTIONAL_POSITIONS.includes(form.internalPosition)">
                              <label class="form-label required">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
                              <select v-model="form.department" class="form-select" :disabled="!form.workGroup">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô --</option>
                                <option v-for="dept in currentDepts" :value="dept">{{ dept }}</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á)</option>
                              </select>
                            </div>
                          </div>
                        </div>

                        <div v-if="form.status_Register === REG_STATUS.QUOTA" class="status-section shadow-sm m-0 animate__animated animate__fadeIn">
                          <div class="status-header text-quota">
                            <i class="fa-solid fa-envelope-circle-check"></i>
                            <div>
                              <h5>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏ä‡∏¥‡∏ç‡∏ñ‡∏∂‡∏á‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</h5>
                              <div class="deadline-info">
                                <i class="fa-solid fa-calendar-day me-1"></i> ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏û.‡∏Ñ. - 30 ‡∏°‡∏¥.‡∏¢. 2569
                              </div>
                            </div>
                          </div>
                          <label class="form-label required">‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
                          <div class="input-icon-wrapper mb-3">
                            <i class="fa-solid fa-building-circle-check"></i>
                            <select v-model="form.affiliation" class="form-select" required>
                              <option value="" disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î --</option>
                              <option v-for="item in affiliationOptions" :key="item" :value="item">{{ item }}</option>
                              <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">-- ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á) --</option>
                            </select>
                          </div>

                          <div v-if="['‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏≤‡∏Å 3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ', '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'].includes(form.affiliation)" 
                              class="animate__animated animate__fadeIn mt-2 p-3 bg-light rounded border-start border-4 border-warning shadow-sm">
                            
                            <label class="form-label required fw-bold text-primary">
                              <i class="fa-solid fa-pen-to-square me-1"></i> ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•
                            </label>
                            
                            <input type="text" 
                                  v-model="form.affiliation_otherText" 
                                  class="form-control" 
                                  :placeholder="form.affiliation === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà...' : '‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏û.‡∏¢‡∏∞‡∏•‡∏≤, ‡∏£‡∏û.‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ...'" 
                                  :required="['‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏≤‡∏Å 3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ', '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'].includes(form.affiliation)">
                            
                            <small class="text-danger fw-bold d-block mt-1" v-if="form.affiliation === '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏≤‡∏Å 3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ'">
                              * ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥: (3 ‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡πÉ‡∏ï‡πâ)
                            </small>
                            <small class="text-muted d-block mt-1" v-else>
                              * ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
                            </small>
                          </div>
                        </div>

                        <div v-if="form.status_Register === REG_STATUS.EXTERNAL" class="status-section shadow-sm m-0 animate__animated animate__fadeIn">
                          <div class="status-header text-external">
                            <div>
                              <h5><i class="fa-solid fa-earth-asia me-1"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å</h5>
                              <div class="deadline-info">
                                <i class="fa-solid fa-file-invoice me-1"></i> 
                                ‡∏´‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏ó‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á
                              </div>
                              <div v-if="externalDeadline" class="deadline-info" >
                                <i class="fa-solid fa-clock me-1"></i>
                                ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: {{ formatThaiDate(externalDeadline, true) }}
                              </div>
                            </div>
                          </div>

                          <div class="mb-3">
                            <label class="form-label required">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
                            <textarea v-model="form.workPlace" class="form-control" rows="2" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•" required></textarea>
                          </div>

                          <div class="border-top pt-3">
                            <h6 class="fw-bold mb-3 text-primary">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</h6>
                            <div class="mb-3">
                              <label class="form-label required">‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</label>
                              <div class="input-group">
                                <input type="text" v-model="form.name_Receipt" class="form-control" required>
                                <button type="button" class="btn btn-primary" @click="copyName">‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏â‡∏±‡∏ô</button>
                              </div>
                            </div>
                            <div class="row g-2">
                              <div class="col-md-6"><input type="text" id="sub_district" v-model="form.address_subdistrict" class="form-control" placeholder="‡∏ï‡∏≥‡∏ö‡∏•"></div>
                              <div class="col-md-6"><input type="text" id="district" v-model="form.address_district" class="form-control" placeholder="‡∏≠‡∏≥‡πÄ‡∏†‡∏≠"></div>
                              <div class="col-md-6"><input type="text" id="province" v-model="form.address_province" class="form-control" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î"></div>
                              <div class="col-md-6"><input type="text" id="postcode" v-model="form.address_postcode" class="form-control" placeholder="‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå"></div>
                            </div>
                            <div class="mt-3">
                              <label class="form-label required">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</label>
                              <input type="text" v-model="form.taxpayer_ID" @input="formatTaxID" class="form-control" placeholder="x-xxxx-xxxxx-xx-x" required>
                            </div>

                            <div class="mt-4 pt-3 border-top text-center bg-light rounded-4 p-3 shadow-sm border border-primary border-opacity-10">
                              <label class="form-label fw-bold text-primary d-block mb-3">
                                <i class="fa-solid fa-receipt me-2"></i>‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
                              </label>
                              
                              <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
                              <div v-if="form.slipImage" class="mb-3 animate__animated animate__zoomIn">
                                <img :src="form.slipImage" 
                                    style="max-height: 250px; border-radius: 12px; cursor: pointer;" 
                                    class="shadow border border-white border-4"
                                    title="‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏Ç‡∏¢‡∏≤‡∏¢"
                                    @click="openSpeakerModal({ 
                                      img: form.slipImage, 
                                      name: '‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô', 
                                      dept: form.name_Receipt || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à' 
                                    }, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ')">
                                <div class="small text-muted mt-2">
                                  <i class="fa-solid fa-search-plus me-1"></i> ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏ï‡πá‡∏°
                                </div>
                              </div>

                              <div class="d-flex flex-column align-items-center gap-2">
                                <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ: ‡∏à‡∏∞‡∏Å‡∏î‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ isEditMode ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô -->
                                <button type="button" 
                                        class="btn btn-primary rounded-pill px-4 shadow-sm" 
                                        @click="$refs.slipInput.click()"
                                        :disabled="!isEditMode">
                                  <i class="fa-solid fa-cloud-arrow-up me-2"></i> 
                                  {{ form.slipImage ? '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ' : '‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ' }}
                                </button>

                                <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á: ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç) -->
                                <div v-if="!isEditMode && form.status_Register === REG_STATUS.EXTERNAL" class="mt-1">
                                  <span class="badge bg-warning-subtle text-danger fw-normal" style="font-size: 0.75rem; white-space: normal;">
                                    <i class="fa-solid fa-circle-info me-1"></i> 
                                    ‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"
                                  </span>
                                </div>
                              </div>
                              
                              <input type="file" ref="slipInput" class="d-none" accept="image/*" @change="handleSlipUpload">
                              <small class="text-muted d-block mt-2">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏û .jpg, .png (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB)</small>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="text-center mt-5 d-flex flex-wrap justify-content-center gap-3">                      
                        <!-- ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (isEditMode === true) -->
                        <button v-if="isEditMode" type="button" class="btn btn-outline-danger btn-lg px-4 rounded-pill shadow-sm" 
                            @click="confirmCancelEdit">
                            <i class="fa-solid fa-rotate-left me-2"></i> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç / ‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
                        </button>

                        <button type="submit" class="btn btn-primary btn-lg px-5 rounded-pill shadow">
                            ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <i class="fa-solid fa-circle-arrow-right ms-2"></i>
                        </button>
                    </div>

                  </form>
                </template>

              </div>

              <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ (Step 2) -->
              <div class="card-body p-4 p-md-5" id="summary-content" v-if="step === 2">

                <!-- Header -->
                <div class="text-center mb-5">
                  <div class="display-5 text-success mb-3">
                    <i class="fa-solid fa-clipboard-check"></i>
                  </div>
                  <h3 class="fw-bold mb-2">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô</h3>
                  <p class="text-muted small mb-0">
                    ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                  </p>
                </div>

                <div class="row g-4">

                  <!-- LEFT COLUMN -->
                  <div class="col-lg-6">

                    <!-- PROFILE -->
                    <div class="d-flex flex-column align-items-center justify-content-center">                       
                      <div class="position-relative">
                        <img v-if="profilePreview"
                            :src="profilePreview"
                            class="rounded-circle border border-4 border-white shadow"
                            style="width: 200px; height: 200px; object-fit: cover; cursor: pointer;"
                            title="‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏£‡∏π‡∏õ"
                            @click="openSpeakerModal({ 
                              img: profilePreview, 
                              name: form.title_Name + form.firstName + ' ' + form.lastName, 
                              dept: '‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô' 
                            }, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢')">
                        
                        <div v-else
                            class="rounded-circle bg-white border border-4 border-white shadow d-flex align-items-center justify-content-center"
                            style="width: 200px; height: 200px;">
                          <i class="fa-solid fa-user-nurse fa-3x text-muted opacity-50"></i>
                        </div>
                      </div>
                      <span class="mt-3 small fw-bold text-secondary">
                        ‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
                      </span>
                    </div>

                    <!-- PERSONAL INFO -->
                    <div class="summary-card">
                      <h6 class="section-title">
                        <i class="fa-solid fa-user me-2"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
                      </h6>

                      <div class="summary-item">
                        <div class="summary-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</div>
                        <div class="summary-value">{{form.email}}</div>
                      </div>

                      <div class="summary-item">
                        <div class="summary-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</div>
                        <div class="summary-value">
                          {{form.title_Name}}{{form.firstName}} {{form.lastName}}
                        </div>
                      </div>

                      <div class="summary-item">
                        <div class="summary-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</div>
                        <div class="summary-value">{{form.phoneNumber}}</div>
                      </div>

                      <div class="summary-item">
                        <div class="summary-label">‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ø</div>
                        <div class="summary-value">{{form.proLicense}}</div>
                      </div>

                      <div class="summary-item">
                        <div class="summary-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£</div>
                        <div class="summary-value">{{form.foodType}}</div>
                      </div>

                      <div class="summary-item">
                        <div class="summary-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</div>
                        <div class="summary-value">
                          <span class="badge bg-primary">
                            {{form.status_Register}}
                          </span>
                        </div>
                      </div>
                    </div>

                  </div>

                  <!-- RIGHT COLUMN -->
                  <div class="col-lg-6">

                    <!-- INTERNAL -->
                    <template v-if="form.status_Register === REG_STATUS.INTERNAL">
                      <div class="summary-card mb-4">
                        <h6 class="section-title">
                          <i class="fa-solid fa-hospital-user me-2"></i>
                          ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î
                        </h6>

                        <div class="summary-item">
                          <div class="summary-label">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</div>
                          <div class="summary-value">{{form.internalPosition}}</div>
                        </div>

                        <div class="summary-item">
                          <div class="summary-label">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô</div>
                          <div class="summary-value">
                            {{ form.workGroup === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? form.workGroup_OtherText : form.workGroup }}
                          </div>
                        </div>

                        <div class="summary-item">
                          <div class="summary-label">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</div>
                          <div class="summary-value">
                            {{ form.department === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? form.department_OtherText : form.department }}
                          </div>
                        </div>
                      </div>
                    </template>

                    <!-- QUOTA -->
                    <template v-if="form.status_Register === REG_STATUS.QUOTA">
                      <div class="summary-card mb-4">
                        <h6 class="section-title">
                          <i class="fa-solid fa-building-circle-check me-2"></i>
                          ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î
                        </h6>

                        <div class="summary-item">
                          <div class="summary-label">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</div>
                          <div class="summary-value">
                            {{ form.affiliation === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? form.affiliation_otherText : form.affiliation }}
                          </div>
                        </div>
                      </div>
                    </template>

                    <!-- EXTERNAL -->
                    <template v-if="form.status_Register === REG_STATUS.EXTERNAL">
                      <div class="summary-card mb-4">
                        <h6 class="section-title">
                          <i class="fa-solid fa-briefcase me-2"></i>
                          ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à
                        </h6>

                        <div class="summary-item">
                          <div class="summary-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</div>
                          <div class="summary-value">{{form.workPlace}}</div>
                        </div>

                        <div class="summary-item">
                          <div class="summary-label">‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</div>
                          <div class="summary-value fw-bold text-dark">
                            {{form.name_Receipt}}
                          </div>
                        </div>

                        <div class="summary-item">
                          <div class="summary-label">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</div>
                          <div class="summary-value small">
                            {{form.address}} ‡∏ï.{{form.address_subdistrict}}
                            ‡∏≠.{{form.address_district}}
                            ‡∏à.{{form.address_province}}
                            {{form.address_postcode}}
                          </div>
                        </div>

                        <div class="summary-item">
                          <div class="summary-label">‡πÄ‡∏•‡∏Ç‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</div>
                          <div class="summary-value">
                            {{form.taxpayer_ID || '-'}}
                          </div>
                        </div>
                      </div>

                      <!-- SLIP -->
                      <div class="summary-card text-center">
                        <h6 class="section-title justify-content-center">
                          <i class="fa-solid fa-receipt me-2"></i>
                          ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                        </h6>

                        <div v-if="form.slipImage">
                          <img :src="form.slipImage"
                              class="img-fluid rounded-3 border shadow-sm"
                              style="max-height:300px; cursor:pointer;"
                              @click="openSpeakerModal({ img: form.slipImage, name: '‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô', dept: form.name_Receipt }, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ')">

                          <div class="small text-muted mt-2">
                            <i class="fa-solid fa-search-plus me-1"></i>
                            ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏£‡∏π‡∏õ
                          </div>
                        </div>

                        <div v-else class="p-4 border rounded-3 bg-light border-dashed">
                          <i class="fa-solid fa-file-circle-xmark fa-3x text-danger opacity-25 mb-2"></i>
                          <p class="text-danger small fw-bold mb-0">
                            ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ
                          </p>
                        </div>
                      </div>
                    </template>

                  </div>
                </div>

                <!-- BUTTONS -->
                <div class="d-flex gap-3 justify-content-center mt-5">
                  <button class="btn btn-outline-secondary btn-lg px-4 rounded-pill"
                          @click="step = 1">
                    <i class="fa-solid fa-pen-to-square me-2"></i>
                    ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                  </button>

                  <button class="btn btn-success btn-lg px-5 rounded-pill shadow"
                          @click="submitForm"
                          :disabled="loading">
                    <span v-if="loading"
                          class="spinner-border spinner-border-sm me-2"></span>
                    <i v-else class="fa-solid fa-circle-check me-2"></i>
                    ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                  </button>
                </div>

              </div>

            </div>

            <!-- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡πÅ‡∏•‡∏∞ ‡∏£‡∏π‡∏õ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£ -->
            <div v-if="currentView === 'schedule'" class="animate__animated animate__fadeIn">
              
              <div class="main-card shadow-lg border-0 overflow-hidden mb-4">
                
                <div class="form-header-banner" style="padding: 2rem 1rem;">
                  <h2 class="fw-800"><i class="fa-solid fa-calendar-days me-2"></i>‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h2>
                  <p class="mb-0">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ö‡∏ö Real-time</p>
                </div>

                <div class="card-body p-4 p-md-5">
                  
                  <div class="d-flex flex-column flex-md-row justify-content-end align-items-center mb-4 gap-2">
                    <a v-if="['admin'].includes(userRole)" 
                      :href="adminSheetUrl" target="_blank" 
                      class="btn btn-sm btn-outline-success rounded-pill px-3 shadow-sm">
                      <i class="fa-solid fa-file-excel me-1"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô Sheet
                    </a>

                    <button @click="handleDownload" 
                      class="btn btn-primary rounded-pill px-4 shadow-sm d-inline-flex align-items-center"
                      style="height: 45px;">
                      
                      <i class="fas fa-cloud-download-alt me-2"></i>
                      <span class="fw-600">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° (PDF)</span>
                      
                      <span class="badge rounded-pill bg-danger text-white ms-2 px-2">
                        {{ downloadCount }}
                      </span>
                    </button>
                  </div>

                  <div v-if="loadingSchedule" class="text-center py-5">
                    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;"></div>
                    <h5 class="mt-3 text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î...</h5>
                  </div>

                  <div v-else class="schedule-grid">
                    <div v-for="dayNum in [1, 2]" :key="dayNum" class="day-column">
                      <div class="modern-day-header" :style="dayNum === 2 ? 'background:linear-gradient(135deg, #6610f2, #0d6efd)' : ''">
                        <h4 class="mb-1 fw-800">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà {{ dayNum }}</h4>
                        <span>{{ dayNum === 1 ? '25 ‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏° 2569' : '26 ‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏° 2569' }}</span>
                      </div>

                      <div v-for="(item, idx) in (dayNum === 1 ? scheduleData.day1 : scheduleData.day2)" 
                          :key="idx" class="modern-session-card shadow-sm" :class="{'break-card': item.isBreak}">
                        
                        <div class="time-badge">{{ item.time }}</div>
                        
                        <div class="session-content">
                          <h5 :class="{'mb-0': item.isBreak}">
                            <i v-if="item.isBreak" :class="['fa-solid', item.icon, 'me-2']"></i>
                            {{ item.title }}
                          </h5>
                          
                          <div v-if="!item.isBreak && item.speaker.name" class="speaker-pill" 
                              @click="openSpeakerModal(item.speaker, item.title)">
                            <div class="img-wrapper">
                              <img v-if="hasImage(item.speaker.img)" :src="item.speaker.img" class="speaker-img-mini">
                              <div v-else class="icon-speaker-placeholder"><i class="fa-regular fa-circle-user"></i></div>
                              <div class="zoom-icon"><i class="fa-solid fa-search-plus"></i></div>
                            </div>
                            <div>
                              <div class="fw-bold text-dark">{{ item.speaker.name }}</div>
                              <div class="small text-muted">{{ item.speaker.dept }}</div>
                            </div>
                          </div>

                          <div v-if="!item.isBreak && item.file.url" class="mt-3">
                            <div v-if="!item.file.isOpen" class="badge bg-light text-muted border py-2 px-3 rounded-pill w-100">
                              <i class="fa-solid fa-lock me-2"></i> ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î: {{ formatThaiDate(item.file.openDateStr, false) }}
                            </div>

                            <a v-else 
                              :href="item.file.url" 
                              target="_blank" 
                              @click="onScheduleDownload(item)"
                              class="btn btn-primary btn-sm rounded-pill px-4 shadow-sm w-100 w-md-auto d-flex align-items-center justify-content-center gap-2">
                              <i class="fa-solid fa-file-arrow-down"></i>
                              <span>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢</span>
                              
                              <span class="badge rounded-pill bg-white text-primary border shadow-sm" style="font-size: 0.7rem;">
                                {{ item.file.count }}
                              </span>
                            </a>

                          </div>

                        </div>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤ (Contact Us) -->
            <div v-if="currentView === 'contact'" class="animate__animated animate__fadeIn">
              <div class="main-card shadow-lg border-0 overflow-hidden mb-4">
                <!-- Header ‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ -->
                <div class="form-header-banner" style="padding: 2rem 1rem;">
                  <h2 class="fw-800"><i class="fa-solid fa-address-book me-2"></i>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h2>
                  <p class="mb-0">‡∏´‡∏≤‡∏Å‡∏ó‡πà‡∏≤‡∏ô‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</p>
                </div>

                <div class="card-body p-4 p-md-5">
                  <div class="row g-4">
                    
                    <!-- ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ -->
                    <div class="col-lg-5">
                      <h5 class="section-title mt-0"><i class="fa-solid fa-circle-info me-2"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h5>
                      
                      <div class="contact-info-list mt-4">
                        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 1: ‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• -->
                        <div class="d-flex align-items-start mb-4">
                          <div class="flex-shrink-0 bg-soft-primary p-3 rounded-circle me-3">
                            <i class="fa-solid fa-hospital text-primary fs-4"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå</h6>
                            <p class="text-muted small">‡∏™‡∏†‡∏≤‡∏Å‡∏≤‡∏ä‡∏≤‡∏î‡πÑ‡∏ó‡∏¢ ‡∏ñ‡∏ô‡∏ô‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏°‡∏ó‡∏µ‡πà 4 ‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10330</p>
                          </div>
                        </div>

                        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå -->
                        <div class="d-flex align-items-start mb-4">
                          <div class="flex-shrink-0 bg-soft-primary p-3 rounded-circle me-3">
                            <i class="fa-solid fa-phone-volume text-primary fs-4"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h6>
                            <p class="mb-0">02-256-xxxx ‡∏ï‡πà‡∏≠ xxxx</p>
                            <p class="text-muted small">(‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ 08:00 - 16:00 ‡∏ô.)</p>
                            <a href="tel:022564000" class="btn btn-sm btn-outline-primary rounded-pill mt-2">
                              <i class="fa-solid fa-phone me-1"></i> ‡πÇ‡∏ó‡∏£‡∏≠‡∏≠‡∏Å
                            </a>
                          </div>
                        </div>

                        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 3: ‡∏≠‡∏µ‡πÄ‡∏°‡∏• -->
                        <div class="d-flex align-items-start mb-4">
                          <div class="flex-shrink-0 bg-soft-primary p-3 rounded-circle me-3">
                            <i class="fa-solid fa-envelope-open-text text-primary fs-4"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏ó‡∏≤‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•</h6>
                            <p class="mb-0">nursing.chula@gmail.com</p>
                            <a href="mailto:nursing.chula@gmail.com" class="btn btn-sm btn-outline-primary rounded-pill mt-2">
                              <i class="fa-solid fa-paper-plane me-1"></i> ‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•
                            </a>
                          </div>
                        </div>
                      </div>

                      <div class="alert alert-secondary border-0 rounded-4 p-3 mt-4">
                        <small class="fw-bold text-dark d-block mb-1"><i class="fa-solid fa-clock me-1"></i> ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£:</small>
                        <small class="text-muted">‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå - ‡∏®‡∏∏‡∏Å‡∏£‡πå (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå)<br>‡πÄ‡∏ß‡∏•‡∏≤ 08.00 ‡∏ô. - 16.00 ‡∏ô.</small>
                      </div>
                    </div>

                    <!-- ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤: ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà Google Maps -->
                    <div class="col-lg-7">
                      <h5 class="section-title mt-0"><i class="fa-solid fa-map-location-dot me-2"></i>‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</h5>
                      <div class="map-container mt-4 border rounded-4 shadow-sm overflow-hidden" style="height: 400px; border: 2px solid #fff !important;">
                        <!-- ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á -->
                        <iframe 
                          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3875.772583857503!2d100.53504867588147!3d13.73219468665796!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x30e29ed800000001%3A0x67396696b0c26806!2z4Lit4Liy4LiE4Liy4Lij4Lig4Li54Lih4Li04Liq4Li04Lij4Li04Lih4Lix4LiZ4LiE4Lil4Liy4LiZ4Li44Liq4Lij4LiN4LqU4Lih4Liy!5e0!3m2!1sth!2sth!4v1708150000000!5m2!1sth!2sth" 
                          width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                      </div>
                      <div class="d-flex justify-content-between align-items-center mt-3 px-2">
                        <span class="text-muted small">
                          <i class="fa-solid fa-location-arrow me-1"></i> ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏¥‡∏£‡∏¥‡∏°‡∏±‡∏á‡∏Ñ‡∏•‡∏≤‡∏ô‡∏∏‡∏™‡∏£‡∏ì‡πå
                        </span>
                        <a href="https://www.google.com/maps/search/?api=1&query=‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏¥‡∏£‡∏¥‡∏°‡∏±‡∏á‡∏Ñ‡∏•‡∏≤‡∏ô‡∏∏‡∏™‡∏£‡∏ì‡πå+‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå" 
                            target="_blank" 
                            class="btn btn-sm btn-success rounded-pill px-3 shadow-sm">
                            <i class="fa-solid fa-map me-1"></i> ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô Google Maps
                        </a>
                      </div>
                    </div>

                  </div>
                </div>
              </div>
            </div>


            <!-- Modal ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£ -->
            <div id="speakerDetailModal" class="speaker-modal-overlay" style="display:none;" @click.self="closeSpeakerModal">
                <div class="speaker-modal-content animate__animated animate__zoomIn">
                    <span class="speaker-modal-close-button" @click="closeSpeakerModal">&times;</span>
                    <img id="modalImageExpanded" src="" alt="Speaker Image">
                    <div class="p-4 text-center">
                        <h4 id="modalSpeakerNameExpanded" class="fw-bold text-primary mb-2"></h4>
                        <p id="modalSpeakerAffiliationExpanded" class="text-muted mb-0"></p>
                    </div>
                </div>
            </div>

            <!-- ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à -->
            <div v-if="currentView === 'AssessmentForm'" class="animate__animated animate__fadeIn">

              <template v-if="canAccessAssessment">
                <div class="main-card shadow-lg border-0 overflow-hidden mb-2">
                  <div class="form-header-banner">
                    <h2 class="fw-800">‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</h2>
                    <p class="mb-0">‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ 2569</p>
                  </div>

                  <!-- ‡πÅ‡∏™‡∏î‡∏á Spinner ‡∏Ç‡∏ì‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£‡∏à‡∏≤‡∏Å Sheet -->
                  <div v-if="loadingEval" class="text-center py-5 bg-white rounded-4 shadow-sm">
                    <div class="spinner-border text-primary" role="status"></div>
                    <p class="mt-2 text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô...</p>
                  </div>
                  
                  <div class="card-body p-4 p-md-5">
                    <div class="text-center py-2">
                      <div class="btn-group shadow-sm rounded-pill p-1 bg-light">
                        <button type="button" class="btn rounded-pill px-4 me-2" 
                          :disabled="!isDay1Active"
                          :class="evalDay === 1 ? 'btn-primary' : 'btn-light'" 
                          @click="changeDay(1)">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25 ‡∏™.‡∏Ñ.
                        </button>
                        <button type="button" class="btn rounded-pill px-4" 
                          :disabled="!isDay2Active"
                          :class="evalDay === 2 ? 'btn-primary' : 'btn-light'" 
                          @click="changeDay(2)">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 26 ‡∏™.‡∏Ñ.
                        </button>
                      </div>
                    </div>

                    <form @submit="submitEvaluation">
                      <h5 class="section-title"><i class="fa-solid fa-user-check me-2"></i>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</h5>
                      
                      <div class="row g-3 mb-2">

                        <!-- ‡∏Ç‡πâ‡∏≠ 1 -->
                        <div class="col-md-6">
                          <div class="card">
                            <div class="card-body">

                              <label class="form-label fw-bold mb-3">
                                1. ‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏à‡∏≤‡∏Å <span class="text-danger">*</span>
                              </label>

                              <div class="row g-3">
                                <div class="col-6">
                                  <label class="reg-item w-100 h-100">
                                    <input type="radio"
                                          class="reg-input"
                                          v-model="evalForm.origin"
                                          value="‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå"
                                          required>

                                    <div class="reg-card p-4 h-100 d-flex flex-column justify-content-center align-items-center text-center">
                                      <i class="fa-solid fa-hospital-user mb-2 fs-2"></i>
                                      <span>‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏£‡∏û.‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå</span>
                                    </div>
                                  </label>
                                </div>

                                <div class="col-6">
                                  <label class="reg-item w-100 h-100">
                                    <input type="radio"
                                          class="reg-input"
                                          v-model="evalForm.origin"
                                          value="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ"
                                          required>

                                    <div class="reg-card p-4 h-100 d-flex flex-column justify-content-center align-items-center text-center">
                                      <i class="fa-solid fa-building mb-2 fs-2"></i>
                                      <span>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô / ‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ</span>
                                    </div>
                                  </label>
                                </div>
                              </div>

                            </div>
                          </div>
                        </div>

                        <!-- ‡∏Ç‡πâ‡∏≠ 2 -->
                        <div class="col-md-6">
                          <div class="card">
                            <div class="card-body">

                              <label class="form-label fw-bold mb-3">
                                2. ‡∏ó‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? <span class="text-danger">*</span>
                              </label>

                              <div class="row g-3">
                                <div class="col-6">
                                  <label class="reg-item w-100 h-100">
                                    <input type="radio"
                                          class="reg-input"
                                          v-model="evalForm.gift"
                                          value="‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å"
                                          required>
                                    <div class="reg-card p-4 h-100 d-flex flex-column justify-content-center align-items-center text-center">
                                      <i class="fa-solid fa-gift mb-2 fs-2"></i>
                                      <span>‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å</span>
                                    </div>
                                  </label>
                                </div>
                                <div class="col-6">
                                  <label class="reg-item w-100 h-100">
                                    <input type="radio"
                                          class="reg-input"
                                          v-model="evalForm.gift"
                                          value="‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏£‡∏±‡∏ö"
                                          required>
                                    <div class="reg-card p-4 h-100 d-flex flex-column justify-content-center align-items-center text-center">
                                      <i class="fa-solid fa-hand-holding-heart mb-2 fs-2"></i>
                                      <span>‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏£‡∏±‡∏ö</span>
                                    </div>
                                  </label>
                                </div>
                              </div>

                            </div>
                          </div>
                        </div>

                      </div>

                      <h5 class="section-title"><i class="fa-solid fa-list-check me-2"></i>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2 ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÉ‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£</h5>
                      <span class="bg-warning-subtle py-2 px-2 rounded">
                        <i class="fa-solid fa-circle-info me-1"></i>
                        ‡∏Ñ‡∏≥‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á: ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡πà‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÜ
                      </span>


                      <div class="table-responsive rounded-4 border-0 mt-3 shadow-sm">
                        <table class="table align-middle mb-0 questions-table">
                          <thead class="table-dark d-none d-md-table-header-group">
                            <tr>
                              <th class="text-start py-3">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</th>
                              <th width="350">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</th>
                            </tr>
                          </thead>
                          <tbody>

                            <template v-for="q in (evalDay === 1 ? day1Questions : day2Questions)" :key="q.id">
                              <tr>
                                <td colspan="2" class="p-3 p-md-4 border-0">
                                  <div class="d-flex flex-column flex-md-row align-items-center align-items-md-center gap-3">
                                    
                                    <div v-for="(speaker, index) in q.speakers" :key="index" 
                                        class="speaker-avatar-circle" 
                                        @click="openSpeakerModal(speaker, q.title)" style="cursor: pointer;">
                                      <img v-if="hasImage(speaker.img)" :src="speaker.img" class="img-speaker-fluid">
                                      <div v-else class="icon-speaker-placeholder">
                                        <i class="fa-regular fa-circle-user"></i>
                                      </div>
                                    </div>

                                    <div class="flex-grow-1 mt-2 mt-md-0 text-center text-md-start">
                                      <span class="lecturer-title d-block mb-1">{{ q.title }}</span>
                                      
                                      <div v-for="(speaker, sIdx) in q.speakers" :key="'info_'+sIdx" class="mb-2">
                                        <div class="small fw-bold text-dark">{{ speaker.name }}</div>
                                        <div class="small text-muted" style="line-height: 1.2;">{{ speaker.dept }}</div>
                                      </div>
                                    </div>
                                    
                                  </div>
                                </td>
                              </tr>

                              <tr v-for="sub in subItems" :key="q.id + '_' + sub.id">
                                <td class="ps-md-5 py-3 sub-text-large">
                                  <span class="sub-number">{{ q.id }}.{{ sub.id }}</span> {{ sub.text }}
                                </td>
                                <td>
                                  <div class="rating-container">
                                    <div v-for="val in ['‡∏°‡∏≤‡∏Å', '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á', '‡∏ô‡πâ‡∏≠‡∏¢']" :key="val" class="rating-item">
                                      <input type="radio" 
                                            :id="'q' + q.id + '_' + sub.id + '_' + val" 
                                            :name="'q' + q.id + '_' + sub.id" 
                                            :value="val" 
                                            v-model="evalForm['q' + q.id + '_' + sub.id]" 
                                            class="rating-input" 
                                            required>
                                      <label :for="'q' + q.id + '_' + sub.id + '_' + val" 
                                            class="rating-label" 
                                            :class="'rating-' + val">
                                        {{ val }}
                                      </label>
                                    </div>
                                  </div>
                                </td>
                              </tr>
                            </template>

                          </tbody>
                        </table>
                      </div>

                      <h5 class="section-title mt-5"><i class="fa-solid fa-comment-dots me-2"></i>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</h5>

                      <div class="p-4 bg-light rounded-4 border shadow-sm">
                        <div class="mb-2">
                          <label class="form-label fw-bold sub-text-large mb-3">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ï‡πà‡∏≠‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</label>
                          
                          <div class="rating-container">
                            <div v-for="val in ['‡∏°‡∏≤‡∏Å', '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á', '‡∏ô‡πâ‡∏≠‡∏¢']" :key="'overall_'+val" class="rating-item">
                              <input type="radio" 
                                    :id="'overall_' + val" 
                                    name="overallRating" 
                                    :value="val" 
                                    v-model="evalForm.overallRating" 
                                    class="rating-input" 
                                    required>
                              <label :for="'overall_' + val" class="rating-label" :class="'rating-' + val">
                                {{ val }}
                              </label>
                            </div>
                          </div>
                        </div>

                        <div class="mb-3">
                          <label class="form-label fw-bold small">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ</label>
                          <textarea class="form-control" v-model="evalForm.nextTopic" rows="2" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏ô‡πÉ‡∏à..."></textarea>
                        </div>
                        <div class="mb-0">
                          <label class="form-label fw-bold small">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
                          <textarea class="form-control" v-model="evalForm.feedback" rows="2" placeholder="‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤..."></textarea>
                        </div>
                      </div>

                      <div class="text-center mt-5">
                        <button type="submit" class="btn btn-primary btn-lg rounded-pill px-5 shadow-lg" :disabled="loading">
                          <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span>
                          <i class="fa-solid fa-paper-plane me-2"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
                        </button>
                      </div>
                    </form>
                  </div>
                </div>
              </template>

              <!-- ‡∏Å‡∏£‡∏ì‡∏µ‡∏£‡∏∞‡∏ö‡∏ö "‡∏õ‡∏¥‡∏î" -->
              <div v-else-if="isAssessmentTimerLoaded" class="container">
                <div class="card border-0 shadow-sm rounded-4 text-center p-5 mt-4">
                  <div class="mb-4">
                    <i class="fa-solid fa-clock-rotate-left fa-5x text-muted opacity-25"></i>
                  </div>
                  <h3 class="fw-bold text-primary">‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
                  <p class="text-muted">‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£ ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ</p>
                  
                  <div class="row justify-content-center mt-4 g-3">
                    <div class="col-md-5">
                      <div class="p-3 bg-light rounded-4 border">
                        <h6 class="fw-bold mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 (25 ‡∏™.‡∏Ñ. 69)</h6>
                        <div class="small text-primary">‡πÄ‡∏õ‡∏¥‡∏î: {{ formatThaiDate(assessmentTimer?.day1Open, true) }}</div>
                        <div class="small text-danger">‡∏õ‡∏¥‡∏î: {{ formatThaiDate(assessmentTimer?.day1Close, true) }}</div>
                      </div>
                    </div>
                    <div class="col-md-5">
                      <div class="p-3 bg-light rounded-4 border">
                        <h6 class="fw-bold mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2 (26 ‡∏™.‡∏Ñ. 69)</h6>
                        <div class="small text-primary">‡πÄ‡∏õ‡∏¥‡∏î: {{ formatThaiDate(assessmentTimer?.day2Open, true) }}</div>
                        <div class="small text-danger">‡∏õ‡∏¥‡∏î: {{ formatThaiDate(assessmentTimer?.day2Close, true) }}</div>
                      </div>
                    </div>
                  </div>
                  <div class="mt-5">
                    <button class="btn btn-outline-primary rounded-pill px-4" @click="currentView = 'form'">
                      ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                    </button>
                  </div>
                </div>
              </div>

            </div>

            <!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à -->
            <div v-if="currentView === 'summary'" class="animate__animated animate__fadeIn">
              <div class="overflow-hidden">

                <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£) -->
                <div class="bg-primary text-white p-4 text-center">
                  <h3 class="fw-bold mb-3">‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•</h3>
                  <div class="row g-2 justify-content-center">
                    <div class="col-md-4">
                      <select class="form-select border-0 shadow-sm" 
                            v-model="summaryFilter.date" 
                            @change="loadSummary">
                        <option value="">‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option>
                        <option value="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 (25 ‡∏™.‡∏Ñ.)</option>
                        <option value="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2 (26 ‡∏™.‡∏Ñ.)</option>
                      </select>
                    </div>
                    <div class="col-md-4">
                      <select class="form-select border-0 shadow-sm" 
                            v-model="summaryFilter.origin" 
                            @change="loadSummary">
                        <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</option>
                        <option value="‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå">‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏à‡∏∏‡∏¨‡∏≤‡∏Ø</option>
                        <option value="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å</option>
                      </select>
                    </div>

                    <div class="col-md-4 alert alert-light border text-center mb-3 rounded-pill">
                      ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <strong>{{ summaryData.totalResponses }}</strong> ‡∏ó‡πà‡∏≤‡∏ô
                    </div>
                  </div>
                </div>

                <div class="card-body p-4 p-md-5">
                  
                  <!-- 1. ‡πÅ‡∏™‡∏î‡∏á Spinner ‡∏Ç‡∏ì‡∏∞‡πÇ‡∏´‡∏•‡∏î -->
                  <div v-if="loading" class="text-center py-5">
                    <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;"></div>
                    <p class="mt-3 text-muted fw-bold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ...</p>
                  </div>

                  <!-- 2. ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•-->
                  <div v-else-if="summaryData && summaryData.totalResponses > 0">                

                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á Progress Bar -->
                    <div v-for="q in filteredQuestionsForSummary" :key="q.id" class="mb-4 border rounded-4 overflow-hidden shadow-sm">
                      <div class="bg-light p-3 border-bottom">
                        <div class="lecturer-title text-primary small fw-bold">{{ q.title }}</div>
                      </div>
                      <div class="p-3">
                        <div v-for="sub in subItems" :key="q.id + '_' + sub.id" class="mb-3">
                          <div class="fw-bold mb-2 small text-secondary">{{ q.id }}.{{ sub.id }} {{ sub.text }}</div>

                          <div class="progress" style="height: 30px; font-size: 0.85rem; border-radius: 10px; box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);">

                            <div class="progress-bar bg-success" :style="{ width: (summaryData.results['q'+q.id+'_'+sub.id]['‡∏°‡∏≤‡∏Å'] / summaryData.totalResponses * 100) + '%' }">
                              <span v-if="summaryData.results['q'+q.id+'_'+sub.id]['‡∏°‡∏≤‡∏Å'] > 0">
                                ‡∏°‡∏≤‡∏Å: {{ summaryData.results['q'+q.id+'_'+sub.id]['‡∏°‡∏≤‡∏Å'] }} 
                                ({{ getPercent(summaryData.results['q'+q.id+'_'+sub.id]['‡∏°‡∏≤‡∏Å'], summaryData.totalResponses) }}) </span>
                            </div>

                            <div class="progress-bar bg-warning text-dark" :style="{ width: (summaryData.results['q'+q.id+'_'+sub.id]['‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á'] / summaryData.totalResponses * 100) + '%' }">
                              <span v-if="summaryData.results['q'+q.id+'_'+sub.id]['‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á'] > 0">
                                ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á: {{ summaryData.results['q'+q.id+'_'+sub.id]['‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á'] }} 
                                ({{ getPercent(summaryData.results['q'+q.id+'_'+sub.id]['‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á'], summaryData.totalResponses) }}) </span>
                            </div>

                            <div class="progress-bar bg-danger" :style="{ width: (summaryData.results['q'+q.id+'_'+sub.id]['‡∏ô‡πâ‡∏≠‡∏¢'] / summaryData.totalResponses * 100) + '%' }">
                              <span v-if="summaryData.results['q'+q.id+'_'+sub.id]['‡∏ô‡πâ‡∏≠‡∏¢'] > 0">
                                ‡∏ô‡πâ‡∏≠‡∏¢: {{ summaryData.results['q'+q.id+'_'+sub.id]['‡∏ô‡πâ‡∏≠‡∏¢'] }} 
                                ({{ getPercent(summaryData.results['q'+q.id+'_'+sub.id]['‡∏ô‡πâ‡∏≠‡∏¢'], summaryData.totalResponses) }}) </span>
                            </div>

                          </div>

                        </div>
                      </div>
                    </div>

                    <hr class="my-4 border-primary border-2 opacity-50">

                    <div v-if="summaryData.comments && summaryData.comments.length > 0" class="animate__animated animate__fadeIn">
                      <div class="d-flex align-items-center mb-3">
                        <div class="flex-shrink-0 bg-primary text-white rounded-3 p-2 me-3">
                          <i class="fa-solid fa-comments fs-4"></i>
                        </div>
                        <h5 class="fw-bold text-primary mb-0">‡∏™‡∏£‡∏∏‡∏õ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏à‡∏±‡∏î‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ</h5>
                      </div>

                      <div class="card border-0 shadow-sm rounded-4 overflow-hidden mb-3">
                        <div class="table-responsive">
                          <table class="table table-hover mb-0">
                            <thead class="bg-primary text-white">
                              <tr>
                                <th class="py-3 ps-4 text-center" width="8%">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th class="py-3" width="40%">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏à‡∏±‡∏î‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ</th>
                                <th class="py-3" width="52%">‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</th>
                              </tr>
                            </thead>
                            <tbody>
                              <!-- ‡πÉ‡∏ä‡πâ paginatedComments ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ -->
                              <tr v-for="(item, idx) in paginatedComments" :key="'msg_'+idx">
                                <td class="text-center fw-bold text-muted">
                                  {{ ((currentPageSummary - 1) * itemsPerPageSummary) + idx + 1 }}
                                </td>
                                <td class="py-3">
                                  <div class="fw-600 text-dark"><i class="fa-solid fa-lightbulb text-warning me-2"></i> {{ item.topic }}</div>
                                </td>
                                <td class="py-3">
                                  <div class="text-muted italic" style="font-size: 0.9rem;"><i class="fa-solid fa-comment-dots me-2 opacity-50"></i> {{ item.feedback }}</div>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>

                        <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (Pagination) -->
                        <div v-if="totalPagesSummary > 1" class="d-flex flex-column flex-md-row justify-content-between align-items-center px-4 py-3 bg-light border-top gap-3">
                          <div class="small text-muted fw-bold">‡∏´‡∏ô‡πâ‡∏≤ {{ currentPageSummary }} / {{ totalPagesSummary }}</div>
                          <nav>
                              <ul class="pagination pagination-sm mb-0">
                                <li class="page-item" :class="{ disabled: currentPageSummary === 1 }">
                                    <a class="page-link" href="#" @click.prevent="changePageSummary(currentPageSummary - 1)"><i class="fa-solid fa-angle-left"></i></a>
                                </li>
                                <li v-for="p in totalPagesSummary" :key="p" v-show="p >= currentPageSummary - 2 && p <= currentPageSummary + 2" class="page-item" :class="{ active: currentPageSummary === p }">
                                    <a class="page-link" href="#" @click.prevent="changePageSummary(p)">{{ p }}</a>
                                </li>
                                <li class="page-item" :class="{ disabled: currentPageSummary === totalPagesSummary }">
                                    <a class="page-link" href="#" @click.prevent="changePageSummary(currentPageSummary + 1)"><i class="fa-solid fa-angle-right"></i></a>
                                </li>
                              </ul>
                          </nav>
                        </div>
                      </div>
                    </div>

                    <!-- üü¢ ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏≠‡∏¢‡∏π‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ summaryData) -->
                    <div v-else class="alert alert-light border-0 text-center py-4 rounded-4 shadow-sm">
                      <i class="fa-solid fa-comment-slash fa-2x mb-2 opacity-25"></i>
                      <p class="mb-0 text-muted">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</p>
                    </div>

                  </div>

                  <!-- 3. ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏•‡∏¢ (v-else) -->
                  <div v-else class="text-center py-5 text-muted">
                    <i class="fa-solid fa-folder-open fa-3x mb-3 opacity-25"></i>
                    <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</p>
                  </div>

                </div>
              </div>
            </div>

            <!--++++ SCAN QR Code +++++-->
            <div v-if="currentView === 'scanner'" class="container py-4">
              <div class="card shadow-sm mx-auto animate__animated animate__fadeIn" style="max-width: 600px; border-radius: 20px; overflow: hidden;">
                <div class="card-header bg-primary text-white text-center py-3">
                  <h5 class="mb-0 fw-bold">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πÅ‡∏Å‡∏ô‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô</h5>
                </div>
                
                <div class="card-body text-center p-4">
                  <div class="mb-4">
                    <label class="form-label small fw-bold text-muted text-uppercase mb-2 d-block">
                      <i class="fa-solid fa-calendar-day me-1"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </label>
                    <div class="btn-group w-100 shadow-sm rounded-pill p-1 bg-light" role="group">
                      <button type="button" class="btn rounded-pill py-2 fw-bold transition-all me-3" 
                              :class="scanDay === '1' ? 'btn-success shadow' : 'btn-light text-muted'" @click="scanDay = '1'">
                        ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 (25 ‡∏™.‡∏Ñ.)
                      </button>
                      <button type="button" class="btn rounded-pill py-2 fw-bold transition-all" 
                              :class="scanDay === '2' ? 'btn-success shadow' : 'btn-light text-muted'" @click="scanDay = '2'">
                        ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2 (26 ‡∏™.‡∏Ñ.)
                      </button>
                    </div>
                  </div>

                  <div class="row g-2">
                    <div class="col-6">
                      <button v-if="!isScanning" class="btn btn-outline-success w-100 h-100 rounded-pill shadow-sm py-2" 
                              @click="startScanner" :disabled="loadingScanner || loadingUpload">
                        <div v-if="loadingScanner">
                          <span class="spinner-border spinner-border-sm d-block mx-auto mb-1"></span>
                          <span style="font-size: 0.85rem;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á...</span>
                        </div>
                        <div v-else>
                          <i class="fa-solid fa-camera d-block mb-1"></i>
                          <span style="font-size: 0.85rem;">‡∏™‡πÅ‡∏Å‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á</span>
                        </div>
                      </button>

                      <button v-else class="btn btn-danger w-100 h-100 rounded-pill shadow-sm py-2" :disabled="loadingScanner">
                        <div v-if="loadingScanner">
                          <span class="spinner-border spinner-border-sm d-block mx-auto mb-1"></span>
                          <span style="font-size: 0.85rem;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πÅ‡∏Å‡∏ô...</span>
                        </div>
                        <div v-else @click="stopScanner">
                          <i class="fa-solid fa-video-slash d-block mb-1"></i>
                          <span style="font-size: 0.85rem;">‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á</span>
                        </div>
                      </button>
                    </div>

                    <div class="col-6">
                      <button v-if="!isScanning" class="btn btn-outline-primary w-100 h-100 rounded-pill py-2" 
                              @click="$refs.qrFileInput.click()" :disabled="loadingUpload || loadingScanner">
                        <div v-if="loadingUpload">
                          <span class="spinner-border spinner-border-sm d-block mx-auto mb-1"></span>
                          <span style="font-size: 0.85rem;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå...</span>
                        </div>
                        <div v-else>
                          <i class="fa-solid fa-image d-block mb-1"></i>
                          <span style="font-size: 0.85rem;">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ QR</span>
                        </div>
                      </button>
                      <input type="file" ref="qrFileInput" class="d-none" accept="image/*" @change="handleQrUpload">
                    </div>
                  </div>
                  
                  <!-- ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡πÅ‡∏Å‡∏ô Qr code ‡πÅ‡∏•‡∏∞ ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î -->
                  <div v-show="isScanning  && !loadingScanner" class="scanner-container mt-3 shadow-inner" 
                      style="width: 100%; min-height: 450px; border-radius: 12px; overflow: hidden;">
                      <div id="reader" style="width: 100%;"></div>
                  </div>

                  <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
                  <div v-if="scannedUser" class="mt-4 animate__animated animate__zoomIn">
                    <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
                      <div class="card-header bg-success text-white py-2 px-3 d-flex justify-content-between align-items-center">
                        <span class="small fw-bold"><i class="fa-solid fa-user-check me-2"></i>‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</span>
                        <button class="btn-close btn-close-white" @click="scannedUser = null" style="font-size: 0.7rem;"></button>
                      </div>
                      <div class="card-body p-3 text-start">
                        <div class="d-flex flex-column flex-sm-row align-items-center align-items-sm-start gap-3">
                          <div class="flex-shrink-0">
                            <img v-if="scannedUser[COL.IMAGE] && scannedUser[COL.IMAGE] !== '-'" 
                                :src="scannedUser[COL.IMAGE]" 
                                class="rounded-circle border border-2 border-success shadow-sm" 
                                style="width: 80px; height: 80px; object-fit: cover; aspect-ratio: 1 / 1;">
                            <div v-else class="rounded-circle bg-light d-flex align-items-center justify-content-center border" style="width: 80px; height: 80px;">
                              <i class="fa-solid fa-user text-muted fa-2x"></i>
                            </div>
                          </div>
                          <div class="text-center text-sm-start w-100">
                            <h6 class="fw-bold mb-1 text-dark">{{ scannedUser[COL.TITLE] }}{{ scannedUser[COL.FNAME] }} {{ scannedUser[COL.LNAME] }}</h6>
                            <div class="badge bg-primary-subtle text-primary rounded-pill mb-2">ID: {{ scannedUser[COL.ID] }}</div>
                            <div class="text-muted small lh-sm">
                              <span v-if="scannedUser[COL.REG_TYPE] === REG_STATUS.INTERNAL">
                                <i class="fa-solid fa-hospital me-1"></i>{{ scannedUser[COL.DEPARTMENT] }} ({{ scannedUser[COL.WORK_GROUP] }})
                              </span>
                              <span v-else>
                                <i class="fa-solid fa-building me-1"></i> {{ scannedUser[COL.WORKPLACE] }}
                              </span>
                            </div>
                          </div>
                        </div>
                        <div class="mt-3 p-3 bg-light rounded-4 border-start border-4 border-success shadow-sm">
                          <div class="row g-3">
                            <div class="col-12 border-bottom pb-2">
                              <div class="d-flex justify-content-between align-items-center">
                                <div><span class="tiny-label d-block">‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</span><span class="fw-bold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà {{ scanDay }}</span></div>
                                <div class="text-end"><span class="tiny-label d-block">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span><span class="fw-bold text-success">{{ formatThaiDate(scanDay == 1 ? scannedUser[COL.ATTEND_1_TIME] : scannedUser[COL.ATTEND_2_TIME], true) }}</span></div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

          </div>

          <!-- Footer -->
          <footer class="text-center text-muted small pb-5">
            <p>¬© 2026 ‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå ‡∏™‡∏†‡∏≤‡∏Å‡∏≤‡∏ä‡∏≤‡∏î‡πÑ‡∏ó‡∏¢<br>Developed by ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏≠‡∏á</p>
          </footer>

          <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Admin) -->
          <div class="modal fade" id="adminEditModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
            <div class="modal-dialog modal-dialog-centered" style="max-width: 90%;">
              <div class="modal-content border-0 shadow-lg rounded-4 overflow-hidden">

                <!-- Header: ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡πÅ‡∏•‡∏∞‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ä‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô -->
                <div class="modal-header bg-primary text-white border-0 py-3">
                  <h5 class="modal-title fw-bold">
                    <i class="fa-solid fa-user-pen me-2"></i>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà {{editForm?.rowNumber || '-'}})
                  </h5>
                  <div class="ms-auto me-3">
                    <span class="badge rounded-pill bg-white text-primary px-3 shadow-sm">
                      ID: {{ editForm.id || '-' }}
                    </span>
                  </div>
                  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body p-0">
                  <div class="row g-0">
                    
                    <!-- ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢: ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Sidebar) -->
                    <div class="col-lg-4 bg-light border-end p-4">
                      <div class="text-center">
                        <div class="position-relative mb-3">
                          <img v-if="editForm.profileImageUrl && editForm.profileImageUrl !== '-'"
                              :src="editForm.profileImageUrl"
                              class="rounded-circle border border-4 border-white shadow"
                              style="width: 180px; height: 180px; object-fit: cover; cursor: pointer;"
                              @click="openSpeakerModal({ img: editForm.profileImageUrl, name: editForm.title_Name + editForm.firstName + ' ' + editForm.lastName, dept: editForm.status_Register }, '‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå')">
                          
                          <div v-else class="rounded-circle bg-white border border-4 border-white shadow d-flex align-items-center justify-content-center mx-auto"
                              style="width: 180px; height: 180px;">
                            <i class="fa-solid fa-user-nurse fa-4x text-muted opacity-25"></i>
                          </div>
                        </div>

                        <span class="badge bg-primary px-3 py-2 mb-3 shadow-sm">{{ editForm.status_Register }}</span>
                        
                        <div class="p-3 bg-white rounded-4 shadow-sm text-start mb-3">
                          <label class="small fw-bold text-primary mb-1 d-block"><i class="fa-solid fa-clock me-1"></i> ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</label>
                          <div class="small text-dark fw-bold">{{ formatThaiDate(editForm.timestamp, true) }}</div>
                        </div>

                        <div class="p-3 bg-white rounded-4 shadow-sm text-start">
                          <label class="small fw-bold text-primary mb-2 d-block"><i class="fa-solid fa-utensils me-1"></i> ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
                          <select v-model="editForm.foodType" class="form-select border-2 border-primary-subtle fw-bold">
                            <option value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
                            <option value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏¥‡∏™‡∏•‡∏≤‡∏°">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏¥‡∏™‡∏•‡∏≤‡∏°</option>
                          </select>
                        </div>
                      </div>
                    </div>

                    <!-- ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤: ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (Main Form) -->
                    <div class="col-lg-8 p-4 bg-white">
                      <form @submit.prevent="submitAdminEdit">
                        <div class="row g-3">
                          
                          <!-- Section: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
                          <div class="col-12">
                            <h6 class="fw-bold text-primary border-bottom border-2 pb-2 mb-3">
                              <i class="fa-solid fa-circle-info me-2"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
                            </h6>
                          </div>

                          <div class="col-md-3">
                            <label class="form-label small fw-bold text-muted">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
                            <select v-model="editForm.title_Name" class="form-select border-2 shadow-sm">
                              <option v-for="opt in prefixOptions" :value="opt">{{opt}}</option>
                            </select>
                          </div>

                          <div class="col-md-4">
                            <label class="form-label small fw-bold text-muted">‡∏ä‡∏∑‡πà‡∏≠</label>
                            <input type="text" v-model="editForm.firstName" @input="formatName('firstName', true)" class="form-control border-2 shadow-sm" required>
                          </div>

                          <div class="col-md-5">
                            <label class="form-label small fw-bold text-muted">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                            <input type="text" v-model="editForm.lastName" @input="formatName('lastName', true)" class="form-control border-2 shadow-sm" required>
                          </div>

                          <!-- Contact Info -->
                          <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                            <div class="input-group">
                              <span class="input-group-text bg-white border-2 text-primary"><i class="fa-solid fa-envelope"></i></span>
                              <input type="email" v-model="editForm.email" class="form-control border-2 shadow-sm" @input="formatEmail(true)">
                            </div>
                          </div>

                          <div class="col-md-3">
                            <label class="form-label small fw-bold text-muted">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ø</label>
                            <input type="text" v-model="editForm.proLicense" class="form-control border-2 shadow-sm" maxlength="10" @input="formatLicense">
                          </div>

                          <div class="col-md-3">
                            <label class="form-label small fw-bold text-muted">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                            <input type="text" v-model="editForm.phoneNumber" class="form-control border-2 shadow-sm" maxlength="12" @input="formatPhone">
                          </div>

                          <!-- Section: ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î/‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà -->
                          <div class="col-12 mt-4">
                            <h6 class="fw-bold text-primary border-bottom border-2 pb-2 mb-3">
                              <i class="fa-solid fa-hospital me-2"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà
                            </h6>
                          </div>

                          <!-- ‡∏Å‡∏£‡∏ì‡∏µ‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô -->
                          <template v-if="editForm.status_Register === REG_STATUS.INTERNAL">
                            <div class="col-md-4">
                              <label class="form-label small fw-bold text-muted">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                              <select v-model="editForm.internalPosition" class="form-select border-2 shadow-sm">
                                <option v-for="opt in professionOptions" :value="opt">{{opt}}</option>
                              </select>
                            </div>
                            <div class="col-md-4">
                              <label class="form-label small fw-bold text-muted">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô</label>
                              <select v-model="editForm.workGroup" class="form-select border-2 shadow-sm">
                                <option v-for="(depts, group) in workGroupData" :value="group">{{group}}</option>
                              </select>
                            </div>
                            <div class="col-md-4">
                              <label class="form-label small fw-bold text-muted">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
                              <select v-model="editForm.department" class="form-select border-2 shadow-sm">
                                <option v-for="opt in workGroupData[editForm.workGroup]" :value="opt">{{opt}}</option>
                              </select>
                            </div>
                          </template>

                          <!-- ‡∏Å‡∏£‡∏ì‡∏µ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å (Address Parsing) -->
                          <template v-else>
                            <div class="col-12">
                              <div class="p-3 bg-light rounded-4 border-2 border-dashed">
                                <div class="row g-3">
                                  <div class="col-12">
                                    <label class="form-label small fw-bold text-primary">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏Å (‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà / ‡∏ã‡∏≠‡∏¢ / ‡∏ñ‡∏ô‡∏ô)</label>
                                    <input type="text" v-model="editForm.address_main" class="form-control border-2 shadow-sm bg-white" @blur="cleanAdminAddress">
                                  </div>
                                  <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">‡∏ï‡∏≥‡∏ö‡∏• / ‡πÅ‡∏Ç‡∏ß‡∏á</label>
                                    <input type="text" id="admin_subdistrict" v-model="editForm.address_subdistrict" class="form-control border-2 shadow-sm bg-white">
                                  </div>
                                  <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ / ‡πÄ‡∏Ç‡∏ï</label>
                                    <input type="text" id="admin_district" v-model="editForm.address_district" class="form-control border-2 shadow-sm bg-white">
                                  </div>
                                  <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
                                    <input type="text" id="admin_province" v-model="editForm.address_province" class="form-control border-2 shadow-sm bg-white">
                                  </div>
                                  <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</label>
                                    <input type="text" id="admin_postcode" v-model="editForm.address_postcode" class="form-control border-2 shadow-sm bg-white">
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="col-md-12 mt-2">
                              <label class="form-label small fw-bold text-muted">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</label>
                              <input type="text" v-model="editForm.taxpayer_ID" class="form-control border-2 shadow-sm" @input="formatTaxID">
                            </div>
                          </template>

                          <!-- Buttons -->
                          <div class="col-12 text-end mt-4 pt-3 border-top">
                            <button type="button" class="btn btn-outline-secondary rounded-pill px-4 me-2" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            <button type="submit" class="btn btn-primary rounded-pill px-5 shadow" :disabled="loading || isFormUnchanged">
                              <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span>
                              <i v-else class="fa-solid fa-floppy-disk me-2"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </button>
                          </div>

                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏≠‡∏ö‡∏£‡∏π‡∏õ -->
    <div class="modal fade" id="cropModal" tabindex="-1" data-bs-backdrop="static">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg rounded-4">
          <div class="modal-header bg-primary text-white">
            <h5 class="modal-title"><i class="fa-solid fa-crop me-2"></i>‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á/‡∏Ñ‡∏£‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</h5>
          </div>
          <div class="modal-body p-0" style="background: #eee;">
            <div style="max-height: 400px; overflow: hidden;">
              <img id="imageToCrop" style="max-width: 100%; display: block;">
            </div>
          </div>
          <div class="modal-footer justify-content-center border-0 p-3">
            <button type="button" class="btn btn-outline-secondary rounded-pill px-4" @click="cancelCrop">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button type="button" class="btn btn-success rounded-pill px-4" @click="applyCrop">
              <i class="fa-solid fa-check-circle me-1"></i> ‡∏ï‡∏Å‡∏•‡∏á‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏ô‡∏µ‡πâ
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Scroll Buttons -->
    <div class="scroll-buttons-container">
      <button @click="scrollToTop" class="btn-scroll shadow" title="‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î">
        <i class="fa-solid fa-chevron-up"></i>
      </button>
      <button @click="scrollToBottom" class="btn-scroll shadow" title="‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î">
        <i class="fa-solid fa-chevron-down"></i>
      </button>
    </div>

  </div> <!-- End App -->

  <script>
    // üõë 1. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô URL ‡∏Ç‡∏≠‡∏á Web App ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì Deploy ‡∏à‡∏≤‡∏Å Google Apps Script (‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢‡∏î‡πâ‡∏ß‡∏¢ /exec)
    const GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzfOu3S0v5_u0XJi-IdwTIx6HecySKswYFt05wjfCBbu5pyEYy2LPsFSUkL7d4dmdVK/exec"; 

    const { createApp, ref, onMounted, computed, watch, nextTick } = Vue;

    createApp({
      setup() {
        // --- üü¢ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Refs) ---
        const isReady = ref(false);
        const loading = ref(false);
        const loadingScanner = ref(false);
        const loadingUpload = ref(false);
        const loadingEval = ref(false);
        const loadingSchedule = ref(false);
        const currentView = ref('form');
        const step = ref(1);
        const isEditMode = ref(false);
        const isAdminLoggedIn = ref(false);
        const userRole = ref('');
        const showPassword = ref(false);
        
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Sheet
        const COL = ref({});
        const REG_STATUS = ref({});
        const adminData = ref([]);
        const originalAdminData = ref([]);
        const workGroupData = ref({});
        const currentDepts = ref([]);
        const prefixOptions = ref([]);
        const affiliationOptions = ref([]);
        const professionOptions = ref([]);
        
        // ‡∏ü‡∏≠‡∏£‡πå‡∏°
        const login = ref({ user: '', pass: '' });
        const searchQuery = ref('');
        const searchResult = ref(null);
        const adminSearch = ref('');
        const searchAdminQuery = ref('');
        const filterRegType = ref('');
        const currentPage = ref(1);
        const itemsPerPage = 15;
        const savingRows = ref({});

        const form = ref({
          rowNumber: null, timestamp: '', email: '', title_Name: '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß',
          firstName: '', lastName: '', phoneNumber: '', proLicense: '',
          foodType: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ', status_Register: '', internalPosition: '‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',
          workGroup: '', department: '', affiliation: '', workPlace: '',
          name_Receipt: '', taxpayer_ID: '', address: '',
          address_subdistrict: '', address_district: '', address_province: '', address_postcode: ''
        });

        const editForm = ref({});
        const originalForm = ref(null);

        // ‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç
        const deadlineTimestamp = ref(null);
        const externalDeadline = ref(null);
        const assessmentTimer = ref(null);
        const certDeadline = ref(null);
        const isTimerLoaded = ref(false);
        const isAssessmentTimerLoaded = ref(false);

        // ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
        const evalDay = ref(1);
        const evalForm = ref({ origin: '', gift: '', overallRating: '', nextTopic: '', feedback: '' });
        const day1Questions = ref([]);
        const day2Questions = ref([]);
        const subItems = [
          { id: 1, text: '‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à' },
          { id: 2, text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤' },
          { id: 3, text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå' },
          { id: 4, text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Ç‡∏≠‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢' },
          { id: 5, text: '‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°' }
        ];

        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏™‡πÅ‡∏Å‡∏ô
        const scheduleData = ref({ day1: [], day2: [] });
        const downloadCount = ref(0);
        const scanDay = ref('1');
        const isScanning = ref(false);
        const scannedUser = ref(null);
        let html5QrCode = null;

        // ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
        const isCameraActive = ref(false);
        const profilePreview = ref(null);
        const cameraZoom = ref(1.0);
        let webcam = null;
        let cropper = null;
        const cropModal = ref(null);

        // --- üü¢ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ API ---
        const api = async (action, data = {}) => {
            try {
                const response = await fetch(GAS_WEB_APP_URL, {
                    method: 'POST',
                    body: JSON.stringify({ action, data }),
                    headers: { 'Content-Type': 'text/plain;charset=utf-8' }
                });
                return await response.json();
            } catch (error) {
                console.error("API Error:", error);
                return { success: false, message: "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ" };
            }
        };

        // --- üü¢ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: Logic ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---

        onMounted(async () => {
            loading.value = true;
            const res = await api('loadInitialData');
            if (res) {
                COL.value = res.COL;
                REG_STATUS.value = res.REG_STATUS;
                workGroupData.value = res.workGroups;
                prefixOptions.value = res.prefixes;
                affiliationOptions.value = res.affiliations;
                professionOptions.value = res.professions;
                deadlineTimestamp.value = res.deadlines.reg;
                externalDeadline.value = res.deadlines.external;
                assessmentTimer.value = res.deadlines.assessment;
                certDeadline.value = res.deadlines.cert;
                isTimerLoaded.value = true;
                isAssessmentTimerLoaded.value = true;
                isReady.value = true;
            }
            const modalEl = document.getElementById('cropModal');
            if (modalEl) cropModal.value = new bootstrap.Modal(modalEl);
            initThailandJS();
            checkLocalSession();
            loading.value = false;
        });

        const checkLocalSession = () => {
          const s = localStorage.getItem('nursing_admin_session');
          if (s) {
            const d = JSON.parse(s);
            isAdminLoggedIn.value = true;
            login.value.user = d.user;
            userRole.value = d.role;
          }
        };

        const handleSearch = async () => {
            if (!searchQuery.value) return;
            loading.value = true;
            const res = await api('searchUser', { query: searchQuery.value });
            loading.value = false;
            if (res.success) {
                searchResult.value = res.data;
                setTimeout(() => document.getElementById('search-result-section')?.scrollIntoView({ behavior: 'smooth' }), 100);
            } else Swal.fire("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•", res.message, "info");
        };

        const submitForm = async () => {
            loading.value = true;
            Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...', allowOutsideClick: false, didOpen: () => Swal.showLoading() });
            const action = isEditMode.value ? 'updateForm' : 'processForm';
            const res = await api(action, { ...form.value, profilePreview: profilePreview.value });
            if (res.success) {
                Swal.fire("‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", res.message, "success").then(() => { resetForm(); currentView.value = 'form'; });
            } else Swal.fire("‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß", res.message, "error");
            loading.value = false;
        };

        const handleAdminLogin = async () => {
            if (!login.value.pass) return;
            loading.value = true;
            const res = await api('checkAdminLogin', { password: login.value.pass });
            loading.value = false;
            if (res.success) {
                isAdminLoggedIn.value = true;
                login.value.user = res.username;
                userRole.value = res.role;
                localStorage.setItem('nursing_admin_session', JSON.stringify({ user: res.username, role: res.role }));
                loadAdminTable();
            } else Swal.fire("‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", "‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á", "error");
        };

        const loadAdminTable = async () => {
            loading.value = true;
            const res = await api('getAdminAllData');
            adminData.value = res;
            originalAdminData.value = JSON.parse(JSON.stringify(res));
            loading.value = false;
        };

        const saveAdminUpdate = async (item) => {
            savingRows.value[item.rowNumber] = true;
            const res = await api('updateAdminStatus', { rowNumber: item.rowNumber, item: item });
            if (res.success) {
              Swal.fire({ icon: 'success', title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', timer: 800, showConfirmButton: false });
              loadAdminTable();
            }
            savingRows.value[item.rowNumber] = false;
        };

        const confirmDelete = (rowNum) => {
          Swal.fire({ title: '‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•?', text: "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ", icon: 'warning', showCancelButton: true }).then(async (r) => {
            if (r.isConfirmed) {
              const res = await api('deleteRegistration', { rowNumber: rowNum });
              if (res.success) loadAdminTable();
            }
          });
        };

        // --- ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô ---
        const fetchAssessmentConfig = async () => {
          loadingEval.value = true;
          const res = await api('getAssessmentConfig');
          if (res.success) { day1Questions.value = res.day1; day2Questions.value = res.day2; }
          loadingEval.value = false;
        };

        const submitEvaluation = async (e) => {
          e.preventDefault();
          loading.value = true;
          const res = await api('saveAssessment', { ...evalForm.value, evalDay: evalDay.value });
          if (res.success) {
            Swal.fire("‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", "‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô", "success");
            currentView.value = 'form';
          }
          loading.value = false;
        };

        // --- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£ ---
        const navToSchedule = async () => {
          currentView.value = 'schedule';
          loadingSchedule.value = true;
          const res = await api('getSchedule');
          if (res.success) scheduleData.value = res.data;
          loadingSchedule.value = false;
        };

        // --- ‡∏™‡πÅ‡∏Å‡∏ô QR ---
        const startScanner = () => {
          isScanning.value = true;
          setTimeout(() => {
            html5QrCode = new Html5Qrcode("reader");
            html5QrCode.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, 
            (txt) => { processAttendance(txt); stopScanner(); });
          }, 500);
        };

        const stopScanner = () => { if (html5QrCode) { html5QrCode.stop(); html5QrCode = null; } isScanning.value = false; };

        const processAttendance = async (txt) => {
          loadingScanner.value = true;
          const res = await api('recordAttendance', { text: txt, day: scanDay.value });
          if (res.success) {
            Swal.fire("‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", res.message, "success");
            loadAdminTable();
          } else Swal.fire("‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß", res.message, "error");
          loadingScanner.value = false;
        };

        // --- ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡πâ‡∏≠‡∏á ---
        const startWebcam = async () => {
          isCameraActive.value = true;
          await nextTick();
          webcam = new Webcam(document.getElementById('webcam'), 'user', document.getElementById('canvas'));
          await webcam.start();
        };

        const capturePhoto = () => {
          const canvas = document.getElementById('canvas');
          const video = document.getElementById('webcam');
          canvas.width = video.videoWidth; canvas.height = video.videoHeight;
          canvas.getContext('2d').drawImage(video, 0, 0);
          openCropModal(canvas.toDataURL('image/jpeg'));
          stopWebcam();
        };

        const openCropModal = (src) => {
          document.getElementById('imageToCrop').src = src;
          cropModal.value.show();
          setTimeout(() => {
            cropper = new Cropper(document.getElementById('imageToCrop'), { aspectRatio: 1, viewMode: 1 });
          }, 300);
        };

        const applyCrop = () => {
          profilePreview.value = cropper.getCroppedCanvas({ width: 400, height: 400 }).toDataURL('image/jpeg');
          cropModal.value.hide();
        };

        const stopWebcam = () => { if(webcam) webcam.stop(); isCameraActive.value = false; };

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏∑‡πà‡∏ô‡πÜ ---
        const selectMenu = (v) => { 
          currentView.value = v; 
          if(v === 'AssessmentForm') fetchAssessmentConfig();
        };
        const resetForm = () => { 
          isEditMode.value = false; step.value = 1; profilePreview.value = null;
          form.value = { title_Name: '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß', foodType: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ', internalPosition: '‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•' };
        };
        const formatThaiDate = (v, thai) => { if(!v) return '-'; const d = new Date(v); return d.toLocaleDateString('th-TH', { day:'numeric', month:'short', year: thai ? 'numeric' : '2-digit' }); };

        // Computed
        const filteredAdminData = computed(() => {
          return adminData.value.filter(i => {
            const mType = !filterRegType.value || i[COL.value.REG_TYPE] === filterRegType.value;
            const mQuery = !searchAdminQuery.value || JSON.stringify(i).toLowerCase().includes(searchAdminQuery.value.toLowerCase());
            return mType && mQuery;
          });
        });
        const paginatedAdminData = computed(() => filteredAdminData.value.slice((currentPage.value-1)*itemsPerPage, currentPage.value*itemsPerPage));
        const totalPages = computed(() => Math.ceil(filteredAdminData.value.length / itemsPerPage));
        const canUserEdit = computed(() => isAdminLoggedIn.value || (deadlineTimestamp.value && Date.now() < deadlineTimestamp.value));
        const isExternalClosed = computed(() => externalDeadline.value && Date.now() > externalDeadline.value);
        const isCertTimeOpen = computed(() => isAdminLoggedIn.value || (certDeadline.value && Date.now() >= certDeadline.value));
        const canDownload = (i) => i[COL.value.CERT_URL] && i[COL.value.CERT_URL] !== '-';
        const isRowChanged = (i) => JSON.stringify(i) !== JSON.stringify(originalAdminData.value.find(o => o.rowNumber === i.rowNumber));

        return {
          isReady, loading, currentView, step, isEditMode, form, editForm, isAdminLoggedIn, userRole, login,
          COL, REG_STATUS, prefixOptions, workGroupData, currentDepts, affiliationOptions, professionOptions,
          searchQuery, searchResult, adminSearch, searchAdminQuery, filterRegType, paginatedAdminData, currentPage, totalPages,
          day1Questions, day2Questions, evalDay, evalForm, subItems, loadingEval,
          scheduleData, loadingSchedule, downloadCount, isScanning, scanDay, scannedUser,
          isCameraActive, profilePreview, cameraZoom, deadlineTimestamp, externalDeadline, assessmentTimer, certDeadline,
          api, handleSearch, submitForm, handleAdminLogin, logoutAdmin, selectMenu, resetForm,
          onWorkGroupChange: () => currentDepts.value = workGroupData.value[form.value.workGroup] || [],
          prepareEdit: (i) => { isEditMode.value = true; form.value = {...i}; profilePreview.value = i[COL.value.IMAGE]; step.value = 1; },
          formatThaiDate, canUserEdit, isExternalClosed, isCertTimeOpen, canDownload, isRowChanged,
          saveAdminUpdate, confirmDelete, openAdminEditModal: (i) => { editForm.value = {...i}; new bootstrap.Modal('#adminEditModal').show(); },
          submitAdminEdit: async () => { const res = await api('updateForm', editForm.value); if(res.success) loadAdminTable(); },
          changePage: (p) => currentPage.value = p,
          startWebcam, stopWebcam, capturePhoto, applyCrop, retakePhoto: () => { profilePreview.value = null; startWebcam(); },
          handleFileUpload: (e) => { const reader = new FileReader(); reader.onload = (ev) => openCropModal(ev.target.result); reader.readAsDataURL(e.target.files[0]); },
          handleSlipUpload: (e) => { const reader = new FileReader(); reader.onload = (ev) => form.value.slipImage = ev.target.result; reader.readAsDataURL(e.target.files[0]); },
          startScanner, stopScanner, changeDay: (d) => evalDay.value = d, submitEvaluation,
          navToSchedule, handleDownload: () => window.open('https://drive.google.com/file/d/your_id/view'),
          openSpeakerModal: (s) => { document.getElementById('modalImageExpanded').src = s.img; document.getElementById('speakerDetailModal').style.display='flex'; },
          closeSpeakerModal: () => document.getElementById('speakerDetailModal').style.display='none',
          formatPhone: (e) => { let v = e.target.value.replace(/\D/g,''); form.value.phoneNumber = v.length > 6 ? v.slice(0,3)+'-'+v.slice(3,6)+'-'+v.slice(6) : v; },
          scrollToTop: () => window.scrollTo({top:0, behavior:'smooth'}),
          scrollToBottom: () => window.scrollTo({top: document.body.scrollHeight, behavior:'smooth'}),
          hasImage: (img) => img && img !== '-',
          OPTIONAL_POSITIONS
        }
      }
    }).mount('#app');

    function initThailandJS() {
        if (typeof $.Thailand !== 'undefined') {
            $.Thailand({
                $district: $("#sub_district"), $amphoe: $("#district"), $province: $("#province"), $zipcode: $("#postcode"),
                onDataFill: (data) => {
                    const app = document.getElementById('app').__vue_app__._instance.proxy;
                    app.form.address_subdistrict = data.district;
                    app.form.address_district = data.amphoe;
                    app.form.address_province = data.province;
                    app.form.address_postcode = data.zipcode;
                }
            });
        }
    }
  </script>

</body>

</html>
