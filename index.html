<!DOCTYPE html>
<html lang="th">

<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• 2569</title>

  <!-- CSS Libs -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.11.0/dist/sweetalert2.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;800&display=swap">
  
  <!-- ThailandJS CSS -->
  <link rel="stylesheet" href="https://earthchie.github.io/jquery.Thailand.js/jquery.Thailand.js/dist/jquery.Thailand.min.css">

  <style>
    :root {
      --primary-color: #004085;
      --secondary-color: #6610f2;
      --bg-gradient: linear-gradient(135deg, #e0e7ff 0%, #f8f9fa 100%);
    }

    body {
      font-family: 'Sarabun', sans-serif;
      background: var(--bg-gradient);
      background-attachment: fixed;
      min-height: 100vh;
      padding-top: 70px; /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Navbar */
    }

    /* Navbar Styling */
    .navbar {
      background: rgba(255, 255, 255, 0.9) !important;
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .navbar-brand { font-weight: 800; color: var(--primary-color) !important; }

    /* +++ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà: ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡πÄ‡∏°‡∏ô‡∏π Navbar +++ */
    .navbar-nav .nav-link {
      font-weight: 600;
      color: #495057 !important;
      padding: 0.5rem 1.2rem !important; /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏° */
      border-radius: 50px; /* ‡∏ó‡∏≥‡∏Ç‡∏≠‡∏ö‡πÇ‡∏Ñ‡πâ‡∏á‡∏°‡∏ô */
      transition: all 0.3s ease;
      margin: 0 0.15rem;
    }

    .navbar-nav .nav-link:hover {
      color: var(--primary-color) !important;
      background-color: rgba(0, 64, 133, 0.05); /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ï‡∏≠‡∏ô‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ä‡∏µ‡πâ */
    }

    /* üü¢ ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Active ‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πà‡∏ô‡∏ä‡∏±‡∏î */
    .navbar-nav .nav-link.active {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%) !important;
      color: #ffffff !important;
      box-shadow: 0 4px 10px rgba(102, 16, 242, 0.25);
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    @media (max-width: 991px) {
      .navbar-nav .nav-link {
        border-radius: 10px;
        margin: 0.2rem 0;
      }
    }

    /* Card Styling */
    .main-card {
      border: none;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      overflow: hidden;
      background: #fff;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á Header ‡πÉ‡∏´‡∏°‡πà */
    .form-header-banner {
        background: linear-gradient(135deg, #001a4d 0%, #4b0082 50%, #6610f2 100%);
        padding: 3rem 1rem;
        color: white;
        text-align: center;        /* ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
    }


    /* ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏¢‡∏ï‡∏±‡∏ß */
    .header-logo-container .logo-wrapper {
        background: none !important;
        box-shadow: none !important;
        display: flex;
        align-items: center;
        justify-content: center;
        height: 120px; /* ‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÉ‡∏ô‡∏à‡∏≠‡∏Ñ‡∏≠‡∏° */
        width: auto;
    }

    .header-logo-container .header-logo {
        max-height: 100%;
        max-width: 100%;
        object-fit: contain;
        /* ‡πÉ‡∏ä‡πâ drop-shadow ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏î‡∏π‡∏°‡∏µ‡∏°‡∏¥‡∏ï‡∏¥‡∏ö‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏° */
        filter: drop-shadow(0 4px 10px rgba(0,0,0,0.3)); 
    }

    /* ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° */
    .conference-main-title {
        font-size: 2rem;
        margin-bottom: 0.5rem;
        text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }

    .conference-sub-title {
        font-size: 1.4rem;
        opacity: 0.95;
        margin-bottom: 1.5rem;
    }

    /* ‡πÅ‡∏ñ‡∏ö Theme */
    .header-theme-box .theme-badge-pill {
        display: inline-block;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.4);
        padding: 10px 30px;
        border-radius: 50px;
        font-weight: 600;
        font-size: 1.1rem;
        letter-spacing: 0.5px;
    }

    /* ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà */
    .header-info-details {
        font-size: 1rem;
        font-weight: 400;
        opacity: 0.9;
    }

    /* Responsive ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    @media (max-width: 768px) {
        .header-logo-container .logo-wrapper {
            height: 85px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏•‡∏á‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏•‡∏≠‡∏¢‡∏≠‡∏¢‡∏π‡πà */
            width: auto;
            background: none !important;
            box-shadow: none !important;
            padding: 0;
        }
        .conference-main-title { font-size: 1.5rem; }
        .conference-sub-title { font-size: 1.1rem; }
        .theme-badge-pill { font-size: 0.8rem; padding: 8px 15px; }
        .header-info-details { font-size: 0.85rem; flex-direction: column; gap: 10px; }
    }

    .section-title {
      display: flex;
      align-items: center;
      background: rgba(0, 64, 133, 0.04); /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≤‡∏á‡πÜ */
      padding: 15px 20px;
      border-radius: 15px;
      border-left: 8px solid var(--primary-color) !important; /* ‡∏Ç‡∏≠‡∏ö‡∏´‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô */
      color: var(--primary-color);
      font-weight: 800;
      font-size: 1.25rem;
      margin: 3rem 0 1.5rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.03); /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏≤‡∏à‡∏≤‡∏á‡πÜ */
    }

    /* ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á Icon ‡πÉ‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å */
    .section-title i {
      background: var(--primary-color) !important; /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡∏ó‡∏∂‡∏ö */
      color: #ffffff !important; /* ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
      width: 45px;
      height: 45px;
      line-height: 45px;
      text-align: center;
      border-radius: 12px;
      margin-right: 15px;
      font-size: 1.4rem;
      box-shadow: 0 4px 8px rgba(0, 64, 133, 0.2); /* ‡πÄ‡∏á‡∏≤‡πÉ‡∏ï‡πâ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô */
    }

    .form-label { font-weight: 600; color: #495057; }
    .required::after { content: " *"; color: red; }

    .form-control, .form-select {
      border-radius: 10px;
      padding: 0.6rem 1rem;
      border: 1px solid #dee2e6;
    }

    .form-control:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 0.25rem rgba(102, 16, 242, 0.1);
    }

    /* Stepper Header (Optional) */
    .summary-item {
      display: flex;
      padding: 10px 0;
      border-bottom: 1px solid #eee;
    }
    .summary-label { width: 40%; font-weight: bold; color: #666; }
    .summary-value { width: 60%; color: var(--primary-color); }

    /* ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå */
    .status-section {
      margin: 1.5rem 0; /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏ä‡∏ô‡∏Ç‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏ô‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
      padding: 1.5rem;
      border-top: 2px solid #eee;
      border-bottom: 2px solid #eee;
      background-color: #fcfcfc;
      overflow-x: hidden; 
    }

    /* ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡∏ã‡πâ‡∏≠‡∏ô */
    .status-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 1.5rem;
    }

    .status-header i {
      font-size: 1.8rem;
    }

    .status-header h5 {
      margin: 0;
      font-weight: 700;
    }

    /* ‡∏™‡∏µ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ (‡πÉ‡∏ä‡πâ‡πÅ‡∏Ñ‡πà‡∏™‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°/‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô) */
    .text-internal { color: #004085; }
    .text-quota { color: #6610f2; }
    .text-external { color: #0d6efd; }

    .deadline-info {
      font-size: 0.85rem;
      background: #fff3cd;
      color: #856404;
      padding: 5px 12px;
      border-radius: 6px;
      display: inline-block;
      margin-top: 5px;
      border: 1px solid #ffeeba;
    }
    .deadline-info i {
      font-size: 1rem;
    }
    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ç‡∏ô‡∏≤‡∏î‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    @media (max-width: 576px) {
      .status-section {
        margin: 1.5rem -1rem; /* ‡∏•‡∏î margin ‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏¥‡∏°‡∏Ç‡∏≠‡∏ö */
        padding: 1rem;
        border-radius: 0;
      }
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°‡∏Ç‡∏≠‡∏á Input Group Icon */
    .input-icon-wrapper {
      position: relative;
    }
    .input-icon-wrapper i {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: #adb5bd;
    }
    .input-icon-wrapper .form-control, 
    .input-icon-wrapper .form-select {
      padding-left: 45px;
    }

    /* Container ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ */
    .registration-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      margin-bottom: 2rem;
    }

    /* ‡∏ã‡πà‡∏≠‡∏ô Radio ‡∏î‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏¥‡∏° */
    .reg-input {
      display: none;
    }

    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô */
    .reg-card {
      cursor: pointer;
      border: 2px solid #e9ecef;
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      background: white;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .reg-card:hover {
      border-color: var(--secondary-color);
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }

    .reg-card i {
      font-size: 2.5rem;
      margin-bottom: 15px;
      color: #adb5bd;
      transition: all 0.3s;
    }

    .reg-card span {
      font-weight: 600;
      color: #495057;
      display: block;
      line-height: 1.4;
    }

    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (Checked) */
    .reg-input:checked + .reg-card {
      border-color: var(--secondary-color);
      background-color: rgba(102, 16, 242, 0.03);
      box-shadow: 0 5px 15px rgba(102, 16, 242, 0.15);
    }

    .reg-input:checked + .reg-card i {
      color: var(--secondary-color);
      transform: scale(1.1);
    }

    .reg-input:checked + .reg-card span {
      color: var(--secondary-color);
    }

    /* ‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏π‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å */
    .reg-input:checked + .reg-card::after {
      content: "\f058"; /* FontAwesome check-circle */
      font-family: "Font Awesome 6 Free";
      font-weight: 900;
      position: absolute;
      top: 10px;
      right: 10px;
      color: var(--secondary-color);
      font-size: 1.2rem;
    }

    /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å Disable */
    .reg-input:disabled + .reg-card {
      cursor: not-allowed;
      filter: grayscale(0.8); /* ‡∏ó‡∏≥‡∏™‡∏µ‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å‡πÄ‡∏ó‡∏≤‡πÜ */
      background-color: #f8f9fa;
      border-style: dashed;
    }

    .reg-input:disabled + .reg-card:hover {
      transform: none; /* ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏•‡∏≠‡∏¢‡∏ï‡∏±‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ß‡∏≤‡∏á */
      box-shadow: none;
    }

    /* ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î grid ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô 2 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå (‡πÄ‡∏ä‡πà‡∏ô ‡∏≠‡∏≤‡∏´‡∏≤‡∏£) ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏ö‡∏ô‡∏à‡∏≠‡∏Ñ‡∏≠‡∏° */
    @media (min-width: 768px) {
      .food-selection-grid {
        grid-template-columns: repeat(2, 1fr);
        max-width: 500px; /* ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏£‡∏ß‡∏° */
      }
    }

    .search-integrated-container {
      background-color: #f8faff;
      border: 2px dashed #d1d9e6;
      transition: all 0.3s ease;
    }

    .search-integrated-container:focus-within {
      border-color: var(--secondary-color);
      background-color: #ffffff;
    }

    .border-dashed {
      border-style: dashed !important;
    }

    .animate__fadeIn {
      animation: fadeIn 0.5s;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Custom Styles for Result Card */
    .result-card {
      transition: transform 0.3s ease;
    }
    .bg-internal { background-color: #004085; }
    .bg-quota { background-color: #6610f2; }
    .bg-external { background-color: #0d6efd; }

    .category-strip {
      height: 6px;
      width: 100%;
    }

    .avatar-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .bg-soft-primary { background-color: rgba(0, 64, 133, 0.1); }
    .bg-soft-warning { background-color: rgba(255, 193, 7, 0.1); }

    .badge-custom {
      padding: 6px 12px;
      font-weight: 500;
      border-radius: 8px;
    }

    .info-item label {
      display: block;
      font-size: 0.75rem;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 2px;
    }

    .info-item p {
      font-weight: 600;
      color: #333;
      margin-bottom: 0;
      font-size: 0.95rem;
    }

    .bg-light-status {
      background-color: #fcfdfe;
    }

    .tiny-label {
      font-size: 0.65rem;
      color: #999;
      text-transform: uppercase;
    }

    .btn-hover-grow {
      transition: all 0.2s ease;
    }
    .btn-hover-grow:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    @media (min-width: 992px) {
      .border-start {
        border-left: 1px solid #edf2f7 !important;
      }
    }

    @media (max-width: 991px) {
      .bg-light-status {
        border-top: 1px solid #edf2f7;
      }
    }

    /* --- ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à --- */
    .lecturer-title {
      font-size: 1.2rem; 
      font-weight: 800;
      color: #004085;
      display: block;
      margin-bottom: 5px;
    }
    .lecturer-desc {
      font-size: 1rem;
      color: #555;
      border-left: 5px solid #6610f2;
      padding-left: 15px;
      margin-bottom: 10px;
    }
    .sub-text-large {
      font-size: 1.15rem !important;
      color: #333;
      font-weight: 600;
    }
    .sub-number {
      font-size: 1.25rem;
      font-weight: 800;
      color: #6610f2;
      margin-right: 8px;
    }

    /* --- CSS ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î ‡∏°‡∏≤‡∏Å ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‡∏ô‡πâ‡∏≠‡∏¢ --- */
    .rating-container {
      display: flex;
      gap: 12px;
      width: 100%;
      margin-top: 8px;
    }
    .rating-item { flex: 1; }
    .rating-input { display: none; }
    .rating-label {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 14px 5px;
      background-color: #ffffff;
      border: 2.5px solid #cbd5e1; /* ‡∏Ç‡∏≠‡∏ö‡∏´‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô */
      border-radius: 15px; /* ‡πÇ‡∏Ñ‡πâ‡∏á‡∏°‡∏ô‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° */
      cursor: pointer;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      font-weight: 800; /* ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏´‡∏ô‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏© */
      color: #475569;
      width: 100%;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (Checked) - ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏≤‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î */
    .rating-input:checked + .rating-label.rating-‡∏°‡∏≤‡∏Å {
      background-color: #157347 !important; /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡πÄ‡∏Ç‡πâ‡∏° */
      border-color: #157347 !important;
      color: #ffffff !important;
      box-shadow: 0 8px 20px rgba(21, 115, 71, 0.35) !important;
      transform: translateY(-4px) scale(1.03); /* ‡πÄ‡∏î‡πâ‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢ */
    }
    .rating-input:checked + .rating-label.rating-‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á {
      background-color: #ffc107 !important; /* ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á‡∏ó‡∏≠‡∏á */
      border-color: #ffc107 !important;
      color: #000000 !important;
      box-shadow: 0 8px 20px rgba(255, 193, 7, 0.35) !important;
      transform: translateY(-4px) scale(1.03);
    }
    .rating-input:checked + .rating-label.rating-‡∏ô‡πâ‡∏≠‡∏¢ {
      background-color: #bb2d3b !important; /* ‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏° */
      border-color: #bb2d3b !important;
      color: #ffffff !important;
      box-shadow: 0 8px 20px rgba(187, 45, 59, 0.35) !important;
      transform: translateY(-4px) scale(1.03);
    }

    @media (max-width: 768px) {
      .questions-table tr { display: block; border-bottom: 2px solid #eee !important; padding: 15px 0; }
      .questions-table td { display: block; width: 100% !important; border: none !important; padding: 5px 0 !important; }
      .rating-container { max-width: 100%; }
    }

    /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£ */
    .speaker-modal-overlay {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.8);
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .speaker-modal-content {
        background: white;
        border-radius: 20px;
        max-width: 500px;
        width: 90%;
        position: relative;
        overflow: hidden;
    }
    #modalImageExpanded {
        width: 100%;
        max-height: 500px;
        object-fit: cover;
        object-position: top center;
    }
    .speaker-modal-close-button {
        position: absolute;
        top: 15px; right: 20px;
        font-size: 35px;
        color: white;
        cursor: pointer;
        text-shadow: 0 2px 5px rgba(0,0,0,0.5);
        z-index: 10;
    }

    .schedule-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
        gap: 2rem;
        align-items: start;
      }

      .day-column {
        background: rgba(255, 255, 255, 0.5);
        border-radius: 24px;
        padding: 1.5rem;
        border: 1px solid rgba(0,0,0,0.05);
      }

      .modern-day-header {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        color: white;
        padding: 1.5rem;
        border-radius: 20px;
        margin-bottom: 2rem;
        box-shadow: 0 10px 20px rgba(0, 64, 133, 0.15);
        text-align: center;
      }

      .modern-session-card {
        background: white;
        border-radius: 20px;
        padding: 1.5rem;
        margin-bottom: 1.25rem;
        border: 1px solid #f0f0f0;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .modern-session-card:hover {
        transform: translateY(-5px) scale(1.01);
        box-shadow: 0 15px 30px rgba(0,0,0,0.08);
        border-color: var(--secondary-color);
      }

      /* ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡πÉ‡∏´‡∏°‡πà */
      .time-badge {
        background: rgba(102, 16, 242, 0.1);
        color: var(--secondary-color);
        padding: 4px 12px;
        border-radius: 50px;
        font-weight: 800;
        font-size: 0.85rem;
        display: inline-block;
        width: fit-content;
      }

      .session-content h5 {
        font-weight: 800;
        color: #1a202c;
        line-height: 1.4;
        margin-bottom: 0.5rem;
      }

      /* ‡∏£‡∏π‡∏õ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£‡πÅ‡∏ö‡∏ö‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå */
      .speaker-pill {
        display: flex;
        align-items: center;
        gap: 12px;
        background: #f8fafc;
        padding: 10px;
        border-radius: 15px;
        cursor: pointer;
        transition: background 0.2s;
      }

      .speaker-pill:hover {
        background: #f1f5f9;
      }

      /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ç‡∏ô‡∏≤‡∏î Container ‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£ */
      .img-wrapper {
        position: relative;
        width: 85px;  /* üü¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏≤‡∏Å 55px ‡πÄ‡∏õ‡πá‡∏ô 85px */
        height: 85px; /* üü¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏≤‡∏Å 55px ‡πÄ‡∏õ‡πá‡∏ô 85px */
        flex-shrink: 0; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏£‡∏π‡∏õ‡∏ñ‡∏π‡∏Å‡∏ö‡∏µ‡∏ö */
      }

      .speaker-img-mini {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        object-fit: cover;
        /* üü¢ ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏±‡∏ß‡∏Ç‡∏≤‡∏î: ‡πÉ‡∏´‡πâ‡∏¢‡∏∂‡∏î‡∏Ç‡∏≠‡∏ö‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å */
        object-position: top center; 
        border: 3px solid white;
        box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        cursor: pointer;
        transition: transform 0.3s ease;
      }

      /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ */
      .speaker-img-mini:hover {
        transform: scale(1.05);
      }

      /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ Speaker Pill ‡∏î‡∏π‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏Å‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô */
      .speaker-pill {
        display: flex;
        align-items: center;
        gap: 18px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠ */
        background: #f8fafc;
        padding: 12px 15px;
        border-radius: 20px;
        cursor: pointer;
        transition: all 0.2s;
        border: 1px solid transparent;
      }

      .speaker-pill:hover {
        background: #ffffff;
        border-color: var(--secondary-color);
      }

      /* ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÅ‡∏ß‡πà‡∏ô‡∏Ç‡∏¢‡∏≤‡∏¢ */
      .zoom-icon {
        position: absolute;
        bottom: 5px;
        right: 5px;
        background: var(--secondary-color);
        color: white;
        width: 22px;
        height: 22px;
        border-radius: 50%;
        font-size: 11px;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid white;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      }

      /* ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏ß‡∏á‡∏û‡∏±‡∏Å */
      .break-card {
        background: #fdfdfd;
        border-left: 5px solid #cbd5e1;
        opacity: 0.8;
      }

      @media (max-width: 991px) {
        .schedule-grid { grid-template-columns: 1fr; }
        .container-full { max-width: 100% !important; }
      }
      /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á Grid ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤ Schedule ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠ */
      @media (min-width: 1200px) {
        .schedule-grid {
          display: grid;
          grid-template-columns: 1fr 1fr; /* ‡πÅ‡∏ö‡πà‡∏á 2 ‡∏ù‡∏±‡πà‡∏á‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô */
          gap: 40px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ß‡∏±‡∏ô 1 ‡πÅ‡∏•‡∏∞ ‡∏ß‡∏±‡∏ô 2 */
          padding: 10px;
        }
      }

    /* --- Admin Responsive Cards --- */
    .admin-mobile-card {
        display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ô‡∏à‡∏≠‡∏Ñ‡∏≠‡∏° */
    }

    @media (max-width: 991.98px) {
        /* ‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏î‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏¥‡∏° */
        .admin-desktop-table {
            display: none;
        }

        /* ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Card */
        .admin-mobile-card {
            display: block;
        }

        .data-card {
            background: white;
            border-radius: 15px;
            padding: 1.25rem;
            margin-bottom: 1rem;
            border: 1px solid #edf2f7;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }

        .card-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            color: #718096;
            font-weight: 700;
            margin-bottom: 2px;
        }

        .card-data {
            font-size: 0.95rem;
            color: #2d3748;
            margin-bottom: 12px;
        }

        .status-group {
            background: #f8fafc;
            border-radius: 12px;
            padding: 10px;
            margin-bottom: 10px;
        }
    }

    /* ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡∏ì‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å */
    .btn:disabled {
        cursor: not-allowed;
        opacity: 0.7;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á Spinner ‡πÉ‡∏ô‡∏õ‡∏∏‡πà‡∏° */
    .spinner-border-sm {
        width: 1rem;
        height: 1rem;
        border-width: 0.15em;
    }

    /* ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£ */
    /* ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å - ‡πÉ‡∏ä‡πâ Grid ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏°‡πÅ‡∏ñ‡∏ß‡∏•‡∏∞ 2 ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ PC */
    /* --- 1. ‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡∏ß‡∏á‡∏Å‡∏•‡∏° + ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏î‡πà‡∏ô‡∏ä‡∏±‡∏î) --- */
    .speaker-avatar-circle {
        /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏Ñ‡∏≠‡∏° PC */
        width: 85px !important;
        height: 85px !important;
        flex: 0 0 85px !important;    /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏£‡∏π‡∏õ‡∏ñ‡∏π‡∏Å‡∏ö‡∏µ‡∏ö‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ß */
        flex-shrink: 0 !important;
        aspect-ratio: 1 / 1 !important;
        
        background: transparent !important;
        border: none !important;
        display: inline-block !important; 
        margin: 8px !important;
        overflow: visible !important; /* ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏ö‡πÄ‡∏á‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏≠‡∏¢‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ */
        border-radius: 50% !important; 
    }

    .img-speaker-fluid {
        width: 100% !important;
        height: 100% !important;
        border-radius: 50% !important; 
        object-fit: cover !important;  
        object-position: top center !important; 
        
        /* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö 2 ‡∏ä‡∏±‡πâ‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πà‡∏ô‡∏ä‡∏±‡∏î */
        border: 3px solid white !important; /* ‡∏Ç‡∏≠‡∏ö‡πÉ‡∏ô‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
        box-shadow: 0 0 0 2px var(--secondary-color), 0 4px 10px rgba(0,0,0,0.2) !important; /* ‡∏Ç‡∏≠‡∏ö‡∏ô‡∏≠‡∏Å‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á + ‡πÄ‡∏á‡∏≤ */
        
        display: block !important;
        transition: transform 0.2s ease;
    }

    /* --- 2. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô) --- */
    @media (max-width: 768px) {
        /* ‡∏õ‡∏£‡∏±‡∏ö container ‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô */
        .questions-table td .d-flex {
            flex-direction: row !important;  /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
            flex-wrap: wrap !important;      /* ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏£‡∏π‡∏õ‡πÄ‡∏¢‡∏≠‡∏∞‡πÉ‡∏´‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ */
            justify-content: center !important; /* ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á */
            align-items: center !important;
        }

        .speaker-avatar-circle {
            width: 65px !important;          /* ‡∏¢‡πà‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏•‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
            height: 65px !important;
            flex: 0 0 65px !important;
            margin: 4px !important;          /* ‡∏•‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏π‡∏õ */
        }

        /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô "‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£" ‡∏•‡∏á‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Å‡∏±‡∏ô */
        .questions-table td .flex-grow-1 {
            width: 100% !important;          /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á 100% ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏´‡∏•‡πà‡∏ô‡∏•‡∏á‡∏°‡∏≤ */
            flex: 0 0 100% !important;
            margin-top: 10px;
            text-align: center !important;
        }
    }

    /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡πÄ‡∏ö‡∏≤‡πÜ ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ß‡∏≤‡∏á */
    .speaker-avatar-circle:hover .img-speaker-fluid {
        transform: scale(1.05);
        box-shadow: 0 0 0 3px var(--primary-color), 0 6px 15px rgba(0,0,0,0.3) !important;
    }

    /* 2. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    @media (max-width: 768px) {
        .speaker-avatar-circle {
            width: 75px !important; 
            height: 75px !important;
            flex: 0 0 75px !important;
            margin: 5px !important;
        }
    }

    /* Scroll Buttons Styling */
    .scroll-buttons-container {
      position: fixed;
      bottom: 30px;
      right: 30px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 1050; /* ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠ Navbar ‡πÅ‡∏•‡∏∞‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ */
    }

    .btn-scroll {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background-color: var(--primary-color);
      color: white;
      border: 2px solid white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      opacity: 0.8;
    }

    .btn-scroll:hover {
      opacity: 1;
      transform: scale(1.1);
      background-color: var(--secondary-color);
      box-shadow: 0 6px 15px rgba(0,0,0,0.2) !important;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    @media (max-width: 576px) {
      .scroll-buttons-container {
        bottom: 20px;
        right: 20px;
        gap: 10px;
      }
      .btn-scroll {
        width: 45px;
        height: 45px;
      }
    }

    /* --- ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ (Camera Styles) --- */
    /* 1. ‡∏ï‡∏±‡∏ß Card ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á */
    .camera-card {
        background: #ffffff !important;
        border: 1px solid #e0e6ed !important;
        transition: all 0.3s ease;
    }

    /* 2. ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏û‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏Å‡∏•‡πâ‡∏≠‡∏á */
    .camera-circle-wrapper {
        /* ‡πÉ‡∏ä‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ */
        width: 220px;
        height: 220px;
        
        /* ‡πÅ‡∏Å‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏•‡∏∏‡∏î‡∏Ç‡∏≠‡∏ö: ‡πÉ‡∏´‡πâ‡∏¢‡πà‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡∏•‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ñ‡πâ‡∏≤‡∏à‡∏≠‡πÅ‡∏Ñ‡∏ö‡∏Å‡∏ß‡πà‡∏≤ 220px */
        max-width: calc(100% - 10px); 
        height: auto;
        aspect-ratio: 1 / 1; /* ‡∏Ñ‡∏∏‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏°‡πÄ‡∏™‡∏°‡∏≠ */

        /* ‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á */
        margin: 15px auto;
        position: relative;
        border-radius: 50%;
        overflow: hidden;

        /* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö 2 ‡∏ä‡∏±‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏≤ (‡∏Ñ‡∏á‡∏ò‡∏µ‡∏°‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£) */
        border: 4px solid white;
        box-shadow: 0 0 0 2px var(--secondary-color), 0 8px 20px rgba(0, 0, 0, 0.15);
        
        /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô */
        z-index: 1;
    }

    #webcam {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
        transition: transform 0.1s ease-out;
        /* ‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏£‡∏∞‡∏à‡∏Å (Mirror Effect) */
        transform: scaleX(-1); 
    }

    /* ‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ã‡∏π‡∏° ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏á‡∏Å‡∏≤‡∏£ Mirror ‡πÑ‡∏ß‡πâ‡∏î‡πâ‡∏ß‡∏¢ */
    /* ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á Vue :style ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á ScaleX ‡πÅ‡∏•‡∏∞ Scale‡∏ã‡∏π‡∏° */

    .photo-preview-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        position: absolute;
        top: 0;
        left: 0;
        z-index: 10;
        /* ‡∏ñ‡πâ‡∏≤‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏ñ‡πà‡∏≤‡∏¢‡∏°‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Mirror ‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏≤ scaleX(-1) ‡∏≠‡∏≠‡∏Å */
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á Placeholder (‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ï‡∏≠‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á) */
    .camera-placeholder {
        background-color: rgba(102, 16, 242, 0.05) !important; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏°‡πà‡∏ß‡∏á‡∏≠‡πà‡∏≠‡∏ô‡πÜ */
        color: var(--secondary-color) !important;
    }

    /* 5. ‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á‡πÅ‡∏ñ‡∏ö‡∏õ‡∏£‡∏±‡∏ö‡∏ã‡∏π‡∏° (Zoom Slider) */
    .zoom-control-wrapper {
        max-width: 250px;
        margin: 0 auto 20px auto;
        padding: 10px 15px;
        background: rgba(102, 16, 242, 0.05);
        border-radius: 12px;
    }

    .zoom-label {
        font-size: 0.8rem;
        font-weight: 600;
        color: var(--secondary-color);
        margin-bottom: 8px;
        display: flex;
        justify-content: space-between;
    }

    /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß Slider (Range Input) */
    .form-range {
        height: 6px;
        padding: 0;
        background: #dee2e6;
        border-radius: 5px;
    }

    .form-range::-webkit-slider-thumb {
        width: 18px;
        height: 18px;
        background: var(--secondary-color);
        border: 3px solid #fff;
        border-radius: 50%;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        cursor: pointer;
        transition: all 0.2s;
    }

    .form-range::-webkit-slider-thumb:hover {
        transform: scale(1.2);
        background: var(--primary-color);
    }

    /* 6. ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î‡πÉ‡∏ô Card ‡∏Å‡∏•‡πâ‡∏≠‡∏á */
    .camera-btn-group {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 10px;
    }

    /* ‡∏à‡∏±‡∏î‡∏™‡πÑ‡∏ï‡∏•‡πå Placeholder ‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î */
    .camera-placeholder {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #fff;
        color: #dee2e6;
    }

    /* Responsive ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    @media (max-width: 768px) {
        .camera-circle-wrapper {
            width: 180px;
            height: 180px;
        }
        
        .camera-card {
            min-height: auto !important;
            padding: 1.5rem !important;
        }
    }

    /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏Å‡∏•‡∏° */
    .cropper-view-box,
    .cropper-face {
      border-radius: 50%;
    }

    /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏Ñ‡∏£‡∏≠‡∏ö‡∏™‡πà‡∏ß‡∏ô */
    .cropper-view-box {
      outline: 0;
      border: 2px solid #fff;
    }

    /* ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏î‡∏≥‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏™‡∏á‡∏£‡∏±‡πà‡∏ß‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÇ‡∏´‡∏•‡∏î */
    .scanner-container {
        position: relative !important; 
        width: 100%;
        border-radius: 15px;
        overflow: hidden;
        min-height: 450px;
        background: #000; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏î‡∏≥ */
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠: ‡∏´‡πâ‡∏≤‡∏°‡∏¢‡∏∑‡∏î ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ß */
    #reader video {
        object-fit: cover !important;
        width: 100% !important;
        height: 100% !important;
        min-height: 450px;
    }

    /* ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏£‡∏≠‡∏ö Overlay ‡∏™‡∏µ‡∏Ç‡∏≤‡∏ß */
    #reader__scan_region {
        width: 100% !important;
        height: 100% !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
    }

    /* ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà Library ‡∏°‡∏±‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡πÑ‡∏ß‡πâ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á (‡∏ï‡∏±‡∏ß‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≠‡∏ö‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ß) */
    #reader {
        background: transparent !important;
        border: none !important;
        width: 100% !important;
        padding: 0 !important;
        margin: 0 !important;
    }

    /* ‡∏ã‡πà‡∏≠‡∏ô UI ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î */
    #reader__dashboard, 
    #reader__dashboard_section_swaplink,
    #reader__status_span {
        display: none !important;
    }

    /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏Å‡∏£‡∏≤‡∏ü */
    #typeChart, #statusChart {
      max-height: 300px !important; /* ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏≤‡∏ü‡πÇ‡∏¢‡πà‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ */
      width: 100% !important;
    }
    /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà Scan Qr Code */
    .transition-all {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .btn-group .btn {
      border: none !important; /* ‡∏•‡∏ö‡πÄ‡∏™‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö‡∏õ‡∏∏‡πà‡∏° */
      font-size: 0.9rem;
    }

    /* --- Modern Status Select --- */
    .status-badge-select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      padding: 0.4rem 1.5rem 0.4rem 1rem;
      font-size: 0.8rem;
      font-weight: 700;
      border-radius: 50rem; /* ‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏£‡∏á‡πÅ‡∏Ñ‡∏õ‡∏ã‡∏π‡∏• */
      border: 1px solid transparent;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      width: 100%;
      /* ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏π‡∏Å‡∏®‡∏£ Dropdown ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏°‡∏¥‡∏ô‡∏¥‡∏°‡∏≠‡∏• */
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.6rem center;
      background-size: 10px 10px;
    }

    .status-badge-select:focus {
      outline: none;
      box-shadow: 0 0 0 0.25rem rgba(102, 16, 242, 0.25);
    }

    .status-badge-select:disabled {
      cursor: not-allowed;
      opacity: 0.6;
      background-image: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡∏•‡∏π‡∏Å‡∏®‡∏£‡∏ñ‡πâ‡∏≤‡∏Å‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ */
    }

    /* ‡∏™‡∏µ‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡πà‡∏≤‡∏á‡πÜ */
    .status-empty { background-color: #f1f3f5; color: #6c757d; border-color: #dee2e6; }
    .status-pending { background-color: #fff3cd; color: #856404; border-color: #ffeeba; }
    .status-success { background-color: #d1e7dd; color: #0f5132; border-color: #badbcc; }
    .status-danger { background-color: #f8d7da; color: #842029; border-color: #f5c2c7; }

    [v-cloak] { display: none; }
  </style>

</head>

<body>

  <div id="app" v-cloak>
    
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg fixed-top">
      <div class="container">
        <a class="navbar-brand" href="#" @click.prevent="selectMenu('form'); resetForm()">
          <i class="fa-solid fa-user-nurse me-2"></i>‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£ 2569
        </a>
        
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto align-items-center">
            
            <li class="nav-item" v-if="isAdminLoggedIn">
              <a class="nav-link" 
                :class="{ active: currentView === 'scanner' }" 
                @click.prevent="selectMenu('scanner')" 
                style="cursor: pointer;">
                <i class="fa-solid fa-qrcode me-1"></i> ‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
              </a>
            </li>

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" 
                 href="#" 
                 role="button" 
                 data-bs-toggle="dropdown" 
                 data-bs-auto-close="outside"
                 :class="{ active: ['form', 'schedule', 'AssessmentForm', 'contact'].includes(currentView) }">
                <i class="fa-solid fa-bars-staggered me-1"></i> ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å
              </a>

              <ul class="dropdown-menu shadow border-0 rounded-4 mt-2" style="min-width: 220px; padding: 0.5rem;">
                <li>
                  <a class="dropdown-item" 
                     :class="{ active: currentView === 'form' }" 
                     href="#" 
                     @click.prevent="selectMenu('form'); resetForm()">
                    <i class="fa-solid fa-address-card me-2"></i> ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                  </a>
                </li>
                <li>
                  <a class="dropdown-item" 
                     :class="{ active: currentView === 'schedule' }" 
                     href="#" 
                     @click.prevent="selectMenu('schedule'); navToSchedule()">
                    <i class="fa-solid fa-calendar-check me-2"></i> ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£
                  </a>
                </li>
                <li>
                  <a class="dropdown-item" 
                     :class="{ active: currentView === 'AssessmentForm' }" 
                     href="#" 
                     @click.prevent="selectMenu('AssessmentForm')">
                    <i class="fa-solid fa-circle-check me-2"></i> ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•
                  </a>
                </li>
                <li><hr class="dropdown-divider my-2"></li>
                <li>
                  <a class="dropdown-item" 
                     :class="{ active: currentView === 'contact' }" 
                     href="#" 
                     @click.prevent="selectMenu('contact')">
                    <i class="fa-solid fa-headset me-2"></i> ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤
                  </a>
                </li>
              </ul>
            </li>

            <li class="nav-item dropdown" v-if="isAdminLoggedIn">
              <a class="nav-link dropdown-toggle" 
                href="#" 
                role="button" 
                data-bs-toggle="dropdown" 
                data-bs-auto-close="outside"
                :class="{ active: ['dashboard', 'summary'].includes(currentView) }">
                <i class="fa-solid fa-toolbox me-1"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏ö
              </a>
              <ul class="dropdown-menu shadow border-0 rounded-4 mt-2" style="min-width: 200px; padding: 0.5rem;">
                <li>
                  <a class="dropdown-item" 
                    :class="{ active: currentView === 'dashboard' }" 
                    href="#" 
                    @click.prevent="selectMenu('dashboard')">
                    <i class="fa-solid fa-gauge me-2"></i> Dashboard
                  </a>
                </li>
                <li><hr class="dropdown-divider my-2"></li>
                <li>
                  <a class="dropdown-item" 
                    :class="{ active: currentView === 'summary' }" 
                    href="#" 
                    @click.prevent="selectMenu('summary'); navToSummary()">
                    <i class="fa-solid fa-chart-pie me-2"></i> ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à
                  </a>
                </li>
              </ul>
            </li>

            <li class="nav-item ms-lg-3 mt-2 mt-lg-0">
              
              <a class="btn btn-outline-primary btn-sm rounded-pill px-3 w-100 w-lg-auto" 
                v-if="!isAdminLoggedIn"
                href="#" @click.prevent="selectMenu('dashboard'); navToAdmin()">
                <i class="fa-solid fa-lock-open me-1"></i> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
              </a>

              <div v-else class="dropdown">
                <button class="btn btn-primary btn-sm rounded-pill px-3 dropdown-toggle d-flex align-items-center w-100 w-lg-auto justify-content-center" 
                        type="button" 
                        data-bs-toggle="dropdown">
                  <i class="fa-solid fa-user-shield me-2"></i> 
                  <span class="fw-bold">{{login.user}}</span>
                  <span class="badge bg-light text-primary ms-2 rounded-pill" style="font-size: 0.7rem; text-transform: uppercase;">
                    {{ userRole }}
                  </span>
                </button>
                
                <ul class="dropdown-menu dropdown-menu-end shadow border-0 rounded-3 mt-2">
                  <li class="px-3 py-2 text-muted small border-bottom bg-light rounded-top-3">
                    <div class="fw-bold text-dark">{{ login.user }}</div>
                    <div style="font-size: 0.75rem;">Role: <span class="text-primary fw-bold text-uppercase">{{ userRole }}</span></div>
                  </li>
                  <li>
                    <a class="dropdown-item text-danger mt-1 fw-bold" href="#" @click.prevent="selectMenu('form'); logoutAdmin()">
                      <i class="fa-solid fa-right-from-bracket me-2"></i> ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                    </a>
                  </li>
                </ul>
              </div>

            </li>
            
          </ul>
        </div>
      </div>
    </nav>


    <div :class="currentView === 'dashboard' ? 'container-fluid px-md-5 py-4' : 'container py-4'">
      <div class="row justify-content-center">

        <div class="container-fluid">

          <div class="main-card mb-4" >

            <!-- Header Section -->
            <div class="form-header-banner" v-if="currentView === 'form'">
              <div class="container text-center">
                <!-- Logo Container -->
                <div class="header-logo-container d-flex justify-content-center align-items-center gap-3 gap-md-4 mb-2">
                  <!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ 1 -->
                  <div class="logo-wrapper">
                    <img src="https://lh5.googleusercontent.com/d/1WNPE166t9BOZzIgrCfHTZUITcLSoLMvh" class="header-logo" alt="Logo 1">
                  </div>
                  <!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ 2 -->
                  <div class="logo-wrapper">
                    <img src="https://lh5.googleusercontent.com/d/1ZJlIKLuMhMnM1gi8qL7YOOmlxl86oYeg" class="header-logo" alt="Logo 2">
                  </div>
                </div>

                <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° -->
                <div class="header-content-text px-2">
                  <h1 class="conference-main-title fw-800">‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ 2569</h1>
                  <h2 class="conference-sub-title fw-400">‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå ‡∏™‡∏†‡∏≤‡∏Å‡∏≤‡∏ä‡∏≤‡∏î‡πÑ‡∏ó‡∏¢</h2>
                  
                  <div class="header-theme-box my-4">
                    <span class="theme-badge-pill">
                      Integrating Humanity, Spirituality and Smart Nurse
                    </span>
                  </div>

                  <div class="header-info-details d-flex flex-wrap justify-content-center gap-3 gap-md-4 mt-3">
                    <div class="info-item-top">
                      <i class="fa-solid fa-calendar-days me-2"></i> ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25-26 ‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏° 2569
                    </div>
                    <div class="info-item-top">
                      <i class="fa-solid fa-location-dot me-2"></i> ‡∏ì ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° 1210 ‡∏ä‡∏±‡πâ‡∏ô 12 ‡πÇ‡∏ã‡∏ô B ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏¥‡∏£‡∏¥‡∏°‡∏±‡∏á‡∏Ñ‡∏•‡∏≤‡∏ô‡∏∏‡∏™‡∏£‡∏ì‡πå
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- üü¢ 1. ‡∏´‡∏ô‡πâ‡∏≤ Login (‡πÉ‡∏™‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô) -->
            <div v-if="currentView === 'dashboard' && !isAdminLoggedIn" class="container py-5">
              <div class="row justify-content-center">
                <div class="col-md-4">
                  <div class="card shadow-lg border-0 rounded-4 overflow-hidden">
                    <div class="bg-primary p-4 text-center text-white">
                      <i class="fa-solid fa-lock fa-3x mb-2"></i>
                      <h4 class="fw-bold mb-0">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h4>
                    </div>

                    <div class="card-body p-4">
                      <div class="mb-3">
                        <label class="form-label small fw-bold">‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</label>
                        <div class="input-group shadow-sm">
                          <input 
                            :type="showPassword ? 'text' : 'password'" 
                            v-model="login.pass" 
                            class="form-control form-control-lg bg-light border-0" 
                            placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" 
                            @keyup.enter="handleAdminLogin"
                            @input="formatPassword" 
                          >
                          <button 
                            class="btn btn-light border-0" 
                            type="button" 
                            @click="showPassword = !showPassword"
                          >
                            <i :class="showPassword ? 'fa-solid fa-eye-slash' : 'fa-solid fa-eye'"></i>
                          </button>
                        </div>
                      </div>

                      <button class="btn btn-primary w-100 py-2 rounded-pill shadow" @click="handleAdminLogin" :disabled="loading">
                        <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span> 
                        {{ loading ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...' : '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö' }}
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- üü¢ ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü -->
            <div v-if="currentView === 'dashboard' && isAdminLoggedIn" class="container-fluid py-2">
              <div class="row g-3 mb-4" v-if="!loading">
                <div class="col-md-4">
                  <div class="card border-0 shadow-sm rounded-4 p-3 h-100">
                    <h6 class="fw-bold text-muted mb-3"><i class="fa-solid fa-chart-pie me-2"></i>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h6>
                    <canvas id="typeChart"></canvas>
                  </div>
                </div>
                <div class="col-md-8">
                  <div class="card border-0 shadow-sm rounded-4 p-3 h-100">
                    <h6 class="fw-bold text-muted mb-3"><i class="fa-solid fa-chart-column me-2"></i>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h6>
                    <canvas id="statusChart"></canvas>
                  </div>
                </div>
              </div>
            </div>

            <!-- ‚úÖ ‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£ (Batch) -->
            <div v-if="currentView === 'dashboard' && isAdminLoggedIn && userRole === 'admin'" class="container-fluid px-md-5 mb-3">
              <div class="alert alert-primary d-flex flex-column flex-md-row justify-content-between align-items-center rounded-4 shadow-sm p-4 border-0" style="background: linear-gradient(135deg, #e0e7ff 0%, #f1f5f9 100%);">
                <div class="mb-3 mb-md-0 text-center text-md-start">
                  <h5 class="fw-bold text-primary mb-1">
                    <i class="fa-solid fa-file-pdf me-2"></i>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£
                  </h5>
                  <p class="text-muted mb-0 small">
                    ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 2 ‡∏ß‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£ PDF ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
                  </p>
                </div>
                <button @click="runBatchCert" :disabled="loading" class="btn btn-primary btn-lg rounded-pill px-5 shadow-sm">
                  <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span>
                  <i v-else class="fa-solid fa-magic me-2"></i> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• PDF ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
              </div>
            </div>

            <!-- üü¢ 2. ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
            <div v-if="currentView === 'dashboard' && isAdminLoggedIn" class="container-fluid py-2">
              <div class="card border-0 shadow-sm rounded-4">

                <div v-if="loading" class="text-center py-5">
                  <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;"></div>
                  <p class="mt-3 text-muted fw-bold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>

                <div v-else>

                  <div class="card-header bg-white p-4 border-0">
                    <div class="row align-items-center g-3">
                      
                      <div class="col-xl-3 col-lg-12">
                        <h4 class="fw-800 text-primary mb-0 d-flex align-items-center">
                          <i class="fa-solid fa-gauge-high me-2"></i>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </h4>
                        <small class="text-muted">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</small>
                      </div>

                      <div class="col-xl-9 col-lg-12">
                        <div class="row g-2 justify-content-xl-end align-items-center">
                          
                          <div class="col-md-4 col-lg-3">
                            <div class="input-group input-group-sm shadow-sm">
                              <span class="input-group-text bg-light border-0">
                                <i class="fa-solid fa-filter text-muted"></i>
                              </span>
                              <select v-model="filterRegType" class="form-select border-0 bg-light fw-600">
                                <option value="">--‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó--</option>
                                <option :value="REG_STATUS.INTERNAL">‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡∏à‡∏∏‡∏¨‡∏≤‡∏Ø</option>
                                <option :value="REG_STATUS.QUOTA">‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤</option>
                                <option :value="REG_STATUS.EXTERNAL">‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å</option>
                              </select>
                            </div>
                          </div>

                          <div class="col-md-5 col-lg-5">
                            <div class="input-group input-group-sm shadow-sm">
                              <span class="input-group-text bg-white border-end-0">
                                <i class="fa-solid fa-magnifying-glass text-primary"></i>
                              </span>
                              <input type="text" 
                                    v-model="searchAdminQuery" 
                                    class="form-control border-start-0 ps-0" 
                                    placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ID, ‡∏ä‡∏∑‡πà‡∏≠, ‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ø, ‡∏≠‡∏µ‡πÄ‡∏°‡∏• ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô...">
                              <button v-if="searchAdminQuery" 
                                      class="btn btn-white border-start-0 text-danger" 
                                      @click="searchAdminQuery = ''">
                                <i class="fa-solid fa-circle-xmark"></i>
                              </button>
                            </div>
                          </div>

                          <div class="col-md-3 col-lg-auto">
                            <button class="btn btn-primary btn-sm rounded-pill px-4 shadow-sm w-100 d-flex align-items-center justify-content-center" 
                                    @click="loadAdminTable" :disabled="loading" style="min-height: 31px;">
                              <i :class="['fa-solid fa-sync-alt me-2', { 'fa-spin': loading }]"></i>
                              <span class="fw-600">{{ loading ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...' : '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó' }}</span>
                            </button>
                          </div>

                        </div>
                      </div>

                    </div>
                  </div>

                  <div v-if="filterRegType || searchAdminQuery" class="px-4 pb-2">
                    <span class="badge bg-primary-subtle text-primary rounded-pill fw-normal">
                      ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç {{ filteredAdminData.length }} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                    </span>
                    <button class="btn btn-link btn-sm text-decoration-none" @click="filterRegType = ''; searchAdminQuery = ''">‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏á</button>
                  </div>

                  <div class="table-responsive admin-desktop-table">
                    <table class="table table-hover align-middle mb-0" style="font-size: 0.8rem;">
                      <thead class="table-light text-nowrap">
                        <tr>
                          <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                          <th>ID</th>                          
                          <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                          <th class="text-center">‡∏™‡∏•‡∏¥‡∏õ</th>
                          <th width="200">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Pay-in</th>
                          <th width="200">‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</th>
                          <th width="150">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25</th>
                          <th width="150">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 26</th>
                          <th class="text-center" width="180">‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£</th>
                          <th v-if="userRole !== 'viewer'" class="text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr v-for="(item, index) in paginatedAdminData" :key="item.rowNumber"
                          :style="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL ? 'background-color: #f0f7ff;' : ''">

                          <td class="text-center fw-bold text-muted">
                            {{ ((currentPage - 1) * itemsPerPage) + index + 1 }}
                          </td>                       
                          <td><span class="badge bg-secondary">{{ item[COL.ID] }}</span></td>

                          <td>
                            <div class="fw-bold">{{item[COL.TITLE]}}{{item[COL.FNAME]}} {{item[COL.LNAME]}}</div>
                            
                            <div class="text-muted small">
                              <span v-if="item[COL.LICENSE] && item[COL.LICENSE] !== '-'">
                                <i class="fa-solid fa-id-card me-1"></i> {{ item[COL.LICENSE] }}
                              </span>
                              
                              <span v-else-if="item[COL.EMAIL] && item[COL.EMAIL] !== '-'">
                                <i class="fa-solid fa-envelope me-1"></i> {{ item[COL.EMAIL] }}
                              </span>
                              
                              <span v-else class="opacity-50">- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ -</span>
                            </div>
                          </td>
                          
                          <!-- üîµ 3. ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏•‡∏¥‡∏Å‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ -->
                          <td class="text-center">
                            <button v-if="item[COL.SLIP] && item[COL.SLIP] !== '-'" 
                                    type="button" 
                                    class="btn btn-sm btn-outline-info rounded-circle shadow-sm"
                                    style="width: 32px; height: 32px; padding: 0;"
                                    title="‡∏Ñ‡∏•‡∏¥‡∏Å‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô"
                                    @click="openSpeakerModal({ 
                                      img: item[COL.SLIP], 
                                      name: '‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô', 
                                      dept: item[COL.RECEIPT_NAME] || (item[COL.TITLE] + item[COL.FNAME] + ' ' + item[COL.LNAME]) 
                                    }, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ')">
                              <i class="fa-solid fa-receipt"></i>
                            </button>
                            <span v-else class="text-muted opacity-50 small">-</span>
                          </td>
                          
                          <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Pay-in -->
                          <td class="text-center">
                            <div v-if="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL">
                              <select v-model="item[COL.PAYIN_STATUS]" 
                                      class="status-badge-select shadow-sm"
                                      :class="{
                                        'status-empty': !item[COL.PAYIN_STATUS],
                                        'status-pending': item[COL.PAYIN_STATUS] === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                                        'status-success': item[COL.PAYIN_STATUS] === '‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß'
                                      }"
                                      :disabled="!['admin', 'finance'].includes(userRole)">
                                <option value="">- ‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß">‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß</option>
                              </select>
                            </div>
                            <div v-else><span class="text-muted small">-</span></div>
                          </td>

                          <!-- ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô -->
                          <td class="text-center">
                            <div v-if="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL">
                              <select v-model="item[COL.PAYMENT_STATUS]" 
                                      class="status-badge-select shadow-sm"
                                      :class="{
                                        'status-empty': !item[COL.PAYMENT_STATUS],
                                        'status-pending': item[COL.PAYMENT_STATUS] === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                                        'status-success': item[COL.PAYMENT_STATUS] === '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'
                                      }"
                                      :disabled="!['admin', 'finance'].includes(userRole)">
                                <option value="">- ‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö -</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</option>
                              </select>
                            </div>
                            <div v-else><span class="text-muted small">-</span></div>
                          </td>

                          <td class="text-center">
                            <select v-model="item[COL.ATTEND_1]" 
                                    class="status-badge-select shadow-sm"
                                    :class="{
                                      'status-empty': !item[COL.ATTEND_1],
                                      'status-success': item[COL.ATTEND_1] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°',
                                      'status-danger': item[COL.ATTEND_1] === '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°'
                                    }"
                                    :disabled="!['admin', 'editor'].includes(userRole)">
                              <option value="">- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -</option>
                              <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                              <option value="‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                            </select>
                          </td>

                          <td class="text-center">
                            <select v-model="item[COL.ATTEND_2]" 
                                    class="status-badge-select shadow-sm"
                                    :class="{
                                      'status-empty': !item[COL.ATTEND_2],
                                      'status-success': item[COL.ATTEND_2] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°',
                                      'status-danger': item[COL.ATTEND_2] === '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°'
                                    }"
                                    :disabled="!['admin', 'editor'].includes(userRole)">
                              <option value="">- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -</option>
                              <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                              <option value="‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                            </select>
                          </td>

                          <td class="text-center">
                            <div class="d-flex align-items-center justify-content-center">
                              <!-- <template v-if="item[COL.CERT_URL] && item[COL.CERT_URL] !== '-'"> -->
                              <template v-if="canDownload(item)">
                                <a :href="item[COL.CERT_URL]" 
                                  target="_blank" 
                                  class="btn btn-primary btn-sm rounded-pill px-3 shadow-sm d-flex align-items-center gap-2"
                                  style="font-size: 0.75rem;"
                                  @click="onDownloadClick(item.rowNumber)">
                                  <i class="fa-solid fa-file-arrow-down"></i> 
                                  <span>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î</span>
                                  <span class="badge bg-white text-primary rounded-pill" style="font-size: 0.7rem; min-width: 20px;">
                                    {{ item[COL.DOWNLOAD] || 0 }}
                                  </span>
                                </a>
                              </template>
                              
                              <template v-else>
                                <span class="text-muted small">
                                  <i class="fa-solid fa-hourglass-start me-1 opacity-50"></i> ‡∏£‡∏≠‡πÑ‡∏ü‡∏•‡πå...
                                </span>
                              </template>
                            </div>
                          </td>
                          
                          <td v-if="userRole !== 'viewer'" class="text-center">
                            <div class="btn-group shadow-sm rounded-pill overflow-hidden">

                              <button class="btn btn-success btn-sm" 
                                  @click="saveAdminUpdate(item)" 
                                  :disabled="savingRows[item.rowNumber] || !isRowChanged(item)" 
                                  :class="!isRowChanged(item) ? 'opacity-50' : ''"
                                  title="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞">
                                  
                                  <span v-if="savingRows[item.rowNumber]" class="spinner-border spinner-border-sm"></span>
                                  
                                  <i v-else :class="isRowChanged(item) ? 'fa-solid fa-save' : 'fa-solid fa-check'" class="animate__animated animate__fadeIn"></i>
                              </button>
                              
                              <button class="btn btn-info btn-sm text-white" 
                                  @click="openAdminEditModal(item)" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å">
                                  <i class="fa-solid fa-user-pen"></i>
                              </button>
                              <button v-if="['admin', 'editor'].includes(userRole)" class="btn btn-danger btn-sm" 
                                  @click="confirmDelete(item.rowNumber)" title="‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                                  <i class="fa-solid fa-trash"></i>
                              </button>
                            </div>
                          </td>
                        </tr>

                        <tr v-if="filteredAdminData.length === 0">
                          <td colspan="8" class="text-center py-5 text-muted">
                            <i class="fa-solid fa-magnifying-glass fa-2x mb-3 opacity-25"></i>
                            <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>

                  <!-- üü¢ ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (Pagination Controls) -->
                  <div v-if="totalPagesSummary > 1" class="d-flex flex-column flex-md-row justify-content-between align-items-center px-4 py-3 bg-light border-top gap-3">
                    <div class="small text-muted fw-bold">
                      ‡∏´‡∏ô‡πâ‡∏≤ {{ currentPageSummary }} / {{ totalPagesSummary }}
                    </div>
                    
                    <nav>
                      <ul class="pagination pagination-sm mb-0 shadow-sm">
                        <li class="page-item" :class="{ disabled: currentPageSummary === 1 }">
                          <a class="page-link px-3" href="#" @click.prevent="changePageSummary(currentPageSummary - 1)">
                            <i class="fa-solid fa-angle-left"></i>
                          </a>
                        </li>

                        <!-- ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤ (‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á) -->
                        <li v-for="p in totalPagesSummary" :key="p" 
                            v-show="p >= currentPageSummary - 2 && p <= currentPageSummary + 2"
                            class="page-item" :class="{ active: currentPageSummary === p }">
                          <a class="page-link px-3" href="#" @click.prevent="changePageSummary(p)">{{ p }}</a>
                        </li>

                        <li class="page-item" :class="{ disabled: currentPageSummary === totalPagesSummary }">
                          <a class="page-link px-3" href="#" @click.prevent="changePageSummary(currentPageSummary + 1)">
                            <i class="fa-solid fa-angle-right"></i>
                          </a>
                        </li>
                      </ul>
                    </nav>
                  </div>

                  <!-- Mobile View -->
                  <div class="admin-mobile-card p-2">
                    <div v-for="item in paginatedAdminData" :key="item.rowNumber" class="data-card animate__animated animate__fadeIn mb-3 shadow-sm border-0 rounded-4">
                      
                      <div class="d-flex justify-content-between align-items-center mb-3 p-3 bg-light rounded-top-4 border-bottom">
                        <div>
                          <span class="badge bg-primary px-3 rounded-pill">ID: {{item[COL.ID]}}</span>
                          <small class="text-muted ms-2">‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà: {{item.rowNumber}}</small>
                        </div>
                        <span class="badge bg-secondary-subtle text-secondary border rounded-pill">{{item[COL.REG_TYPE]}}</span>
                      </div>

                      <div class="px-3 pb-3">
                        <div class="mb-3">
                          <div class="card-label mb-1"><i class="fa-solid fa-user me-1"></i> ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</div>
                          <div class="fw-bold text-dark fs-5">{{item[COL.TITLE]}}{{item[COL.FNAME]}} {{item[COL.LNAME]}}</div>
                          <div class="text-muted small"><i class="fa-solid fa-envelope me-1"></i> {{item[COL.EMAIL]}}</div>
                        </div>

                        <div class="row g-3">
                          <template v-if="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL">
                            <div class="col-6">
                              <label class="card-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Pay-in</label>
                              <select v-model="item[COL.PAYIN_STATUS]" class="status-badge-select shadow-sm"
                                      :class="{'status-empty': !item[COL.PAYIN_STATUS], 'status-pending': item[COL.PAYIN_STATUS] === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', 'status-success': item[COL.PAYIN_STATUS] === '‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß'}"
                                      :disabled="!['admin', 'finance'].includes(userRole)">
                                <option value="">- ‡∏£‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß">‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß</option>
                              </select>
                            </div>
                            <div class="col-6">
                              <label class="card-label">‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</label>
                              <select v-model="item[COL.PAYMENT_STATUS]" class="status-badge-select shadow-sm"
                                      :class="{'status-empty': !item[COL.PAYMENT_STATUS], 'status-pending': item[COL.PAYMENT_STATUS] === '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£', 'status-success': item[COL.PAYMENT_STATUS] === '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢'}"
                                      :disabled="!['admin', 'finance'].includes(userRole)">
                                <option value="">- ‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö -</option>
                                <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                                <option value="‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</option>
                              </select>
                            </div>
                          </template>

                          <div :class="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL ? 'col-6' : 'col-12 col-sm-6'">
                            <label class="card-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25</label>
                            <select v-model="item[COL.ATTEND_1]" class="status-badge-select shadow-sm"
                                    :class="{'status-empty': !item[COL.ATTEND_1], 'status-success': item[COL.ATTEND_1] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°', 'status-danger': item[COL.ATTEND_1] === '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°'}"
                                    :disabled="!['admin', 'editor'].includes(userRole)">
                              <option value="">- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -</option>
                              <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                              <option value="‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                            </select>
                          </div>
                          <div :class="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL ? 'col-6' : 'col-12 col-sm-6'">
                            <label class="card-label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 26</label>
                            <select v-model="item[COL.ATTEND_2]" class="status-badge-select shadow-sm"
                                    :class="{'status-empty': !item[COL.ATTEND_2], 'status-success': item[COL.ATTEND_2] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°', 'status-danger': item[COL.ATTEND_2] === '‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°'}"
                                    :disabled="!['admin', 'editor'].includes(userRole)">
                              <option value="">- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -</option>
                              <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                              <option value="‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°">‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</option>
                            </select>
                          </div>
                        </div>

                        <div class="mb-3">
                          <div class="card-label mb-2">‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£</div>
                          <template v-if="canDownload(item)">
                            <a :href="item[COL.CERT_URL]" target="_blank" class="btn btn-outline-primary btn-sm w-100 rounded-pill py-2" 
                                @click="onDownloadClick(item.rowNumber)">
                                <i class="fa-solid fa-file-arrow-down me-2"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î ({{ item[COL.DOWNLOAD] || 0 }})
                            </a>
                          </template>
                          <div v-else class="alert alert-light py-2 mb-0 text-center border rounded-pill">
                            <small class="text-muted"><i class="fa-solid fa-hourglass-start me-1"></i> ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå/‡∏£‡∏≠‡πÑ‡∏ü‡∏•‡πå...</small>
                          </div>
                        </div>

                        <div v-if="userRole !== 'viewer'" class="row g-2 mt-2">
                          <div class="col-8">
                            <button 
                              class="btn btn-success w-100 rounded-pill py-2 shadow-sm" 
                              @click="saveAdminUpdate(item)" 
                              :disabled="savingRows[item.rowNumber] || !isRowChanged(item)">
                              <span v-if="savingRows[item.rowNumber]" class="spinner-border spinner-border-sm me-2"></span>
                              
                              <i v-else :class="isRowChanged(item) ? 'fa-solid fa-save' : 'fa-solid fa-check-circle'" class="me-2"></i>
                              {{ isRowChanged(item) ? '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç' : '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô' }}

                            </button>
                          </div>

                          <div class="col-2 text-center">
                            <button class="btn btn-info text-white rounded-circle py-2 shadow-sm  me-2" 
                              @click="openAdminEditModal(item)">
                              <i class="fa-solid fa-user-pen"></i>
                            </button>
                          </div>

                          <div class="col-2 text-center" v-if="['admin', 'editor'].includes(userRole)">
                            <button class="btn btn-danger rounded-circle py-2 shadow-sm" 
                              @click="confirmDelete(item.rowNumber)">
                              <i class="fa-solid fa-trash"></i>
                            </button>
                          </div>

                        </div>
                      </div>
                    </div>

                    <div v-if="filteredAdminData.length === 0" class="text-center py-5 text-muted">
                      <i class="fa-solid fa-magnifying-glass fa-2x mb-3 opacity-25"></i>
                      <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                    </div>
                  </div>

                  <div v-if="totalPages > 1" class="d-flex flex-column flex-md-row justify-content-between align-items-center px-4 py-3 bg-white border-top gap-3 rounded-bottom-4 shadow-sm">
                    <div class="small text-muted fw-bold">
                      ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ {{ currentPage }} / {{ totalPages }} (‡∏û‡∏ö {{ filteredAdminData.length }} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
                    </div>
                    
                    <nav>
                      <ul class="pagination pagination-sm mb-0 shadow-sm">
                        <li class="page-item" :class="{ disabled: currentPage === 1 }">
                          <a class="page-link px-3" href="#" @click.prevent="changePage(currentPage - 1)">
                            <i class="fa-solid fa-angle-left"></i>
                          </a>
                        </li>

                        <li v-for="p in totalPages" :key="p" 
                            v-show="p >= currentPage - 2 && p <= currentPage + 2"
                            class="page-item" :class="{ active: currentPage === p }">
                          <a class="page-link px-3" href="#" @click.prevent="changePage(p)">{{ p }}</a>
                        </li>

                        <li class="page-item" :class="{ disabled: currentPage === totalPages }">
                          <a class="page-link px-3" href="#" @click.prevent="changePage(currentPage + 1)">
                            <i class="fa-solid fa-angle-right"></i>
                          </a>
                        </li>
                      </ul>
                    </nav>
                  </div>

                </div>
              </div>
            </div>

            <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Step 1) -->
            <div v-show="currentView === 'form'">
              <div class="card-body p-4 p-md-5" v-if="step === 1">

                <!-- üü¢ ‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (View Search) -->
                <div class="search-integrated-container mb-5 p-4 rounded-4 shadow-sm border-dashed">
                  <div class="row align-items-center">
                    <div class="col-md-6">
                      <h5 class="fw-bold text-primary mb-1">
                        <i class="fa-solid fa-user-check me-2"></i>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                      </h5>
                      <p class="text-muted small mb-3 mb-md-0">‡∏´‡∏≤‡∏Å‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏¢‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                    </div>
                    <div class="col-md-6">
                      <div class="input-group shadow-sm">
                        <input type="text" v-model="searchQuery" class="form-control" placeholder="ID / ‡∏≠‡∏µ‡πÄ‡∏°‡∏• / ‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ø" @keyup.enter="handleSearch">
                        <button class="btn btn-primary px-4" @click="handleSearch" :disabled="loading">
                          <span v-if="loading" class="spinner-border spinner-border-sm me-1"></span> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- üîµ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤) -->
                  <div v-if="searchResult && searchResult.length > 0" id="search-result-section" class="mt-4 animate__animated animate__fadeIn">

                    <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center justify-content-md-between mb-3 px-2 gap-2">
                      <h5 class="fw-bold text-primary mb-0">
                        <i class="fa-solid fa-clipboard-list me-2"></i>‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô
                      </h5>
                      <span class="badge bg-primary rounded-pill py-2 px-3 shadow-sm">
                        ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î {{ searchResult.length }} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                      </span>
                    </div>

                    <div v-for="(item, index) in searchResult" :key="index" class="card mb-2 border-0 shadow-sm rounded-4 overflow-hidden result-card">
                      <!-- ‡πÅ‡∏ñ‡∏ö‡∏™‡∏µ‡∏ö‡πà‡∏á‡∏ö‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô -->
                      <div :class="['category-strip', 
                        item[COL.REG_TYPE] === REG_STATUS.INTERNAL ? 'bg-internal' : 
                        item[COL.REG_TYPE] === REG_STATUS.QUOTA ? 'bg-quota' : 'bg-external']">
                      </div>

                      <div class="card-body p-0">
                        <div class="row g-0">
                          
                          <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å (Main Info) -->
                          <div class="col-lg-7 p-4">
                            <div class="d-flex flex-column flex-sm-row align-items-center align-items-sm-start mb-3">

                              <div class="avatar-icon mb-2 mb-sm-0 me-sm-3 flex-shrink-0">
                                
                                <!-- üü¢ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û -->
                                <img v-if="item[COL.IMAGE] && item[COL.IMAGE] !== '-'" 
                                    :src="item[COL.IMAGE]" 
                                    class="rounded-circle border border-2 border-primary shadow-sm" 
                                    style="width: 80px; height: 80px; object-fit: cover;">

                                <i v-else class="fa-solid fa-circle-user fa-5x text-primary opacity-50"></i>
                                
                              </div>
                              
                              <div class="text-center text-sm-start w-100" style="min-width: 0;">
                                <h4 class="fw-bold mb-2 text-dark text-break">{{ item[COL.TITLE] }}{{item[COL.FNAME]}}  {{item[COL.LNAME]}}</h4>

                                <div class="d-flex flex-wrap justify-content-center justify-content-sm-start gap-2">
                                  <span class="badge badge-custom bg-dark text-white text-wrap shadow-sm">
                                    <i class="fa-solid fa-hashtag me-1"></i> ID: {{ item[COL.ID] }}
                                  </span>
                                  <span class="badge badge-custom bg-soft-primary text-primary text-wrap border border-primary border-opacity-10">
                                    <i class="fa-solid fa-id-card-clip me-1"></i> {{item[COL.REG_TYPE]}}
                                  </span>
                                  <span class="badge badge-custom bg-soft-warning text-dark text-wrap border border-warning border-opacity-10">
                                    <i class="fa-solid fa-user-tag me-1"></i> {{item[COL.POSITION]}}
                                  </span>
                                </div>
                              </div>
                            </div>

                            <div class="info-grid mt-4">
                              <div class="row g-3">
                                <!-- [1] ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô: ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå -->
                                <div class="col-sm-6">
                                  <div class="info-item">
                                    <label>‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û</label>
                                    <p>{{item[COL.LICENSE] || '-'}}</p>
                                  </div>
                                </div>
                                <div class="col-sm-6">
                                  <div class="info-item">
                                    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                                    <p>{{item[COL.PHONE] || '-'}}</p>
                                  </div>
                                </div>

                                <!-- [2] ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô / ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î: ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå -->
                                <div class="col-12">
                                  <div class="info-item">
                                    <label>
                                      {{ item[COL.REG_TYPE] === REG_STATUS.INTERNAL ? '‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô / ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô' : '‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î / ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô' }}
                                    </label>
                                    <p>
                                      <i class="fa-solid fa-hospital-alt me-1 text-muted"></i>
                                      <!-- ‡∏Å‡∏£‡∏ì‡∏µ: ‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô -->
                                      <span v-if="item[COL.REG_TYPE] === REG_STATUS.INTERNAL">
                                        {{ item[COL.DEPARTMENT] }} ({{ item[COL.WORK_GROUP] }})
                                      </span>
                                      <!-- ‡∏Å‡∏£‡∏ì‡∏µ: ‡∏ú‡∏π‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å -->
                                      <span v-else>
                                        {{ item[COL.WORKPLACE] }}
                                      </span>
                                    </p>
                                  </div>
                                </div>

                                <!-- [3] ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ "‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å" 
                                    (‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•) -->
                                <div class="col-12" v-if="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL">
                                  <div class="info-item">
                                    <label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</label>
                                    <p>
                                      <i class="fa-solid fa-map-location-dot me-1 text-muted"></i>
                                      {{ item[COL.ADDRESS] || '-' }}
                                    </p>
                                  </div>
                                  <!-- ‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ (‡πÅ‡∏™‡∏î‡∏á‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•) -->
                                  <div class="mt-2" v-if="item[COL.TAX_ID]">
                                    <label class="small text-muted text-uppercase" style="font-size: 0.65rem;">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</label>
                                    <p class="small fw-bold mb-0">{{ item[COL.TAX_ID] }}</p>
                                  </div>
                                </div>

                                <!-- [4] ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏™‡∏£‡∏¥‡∏°: ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå -->
                                <div class="col-sm-6">
                                  <div class="info-item">
                                    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
                                    <p><i class="fa-solid fa-utensils me-1 text-muted"></i> {{item[COL.FOOD]}}</p>
                                  </div>
                                </div>

                                <div class="col-sm-6">
                                  <div class="info-item">
                                    <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                                    <p><i class="fa-solid fa-envelope me-1 text-muted"></i>{{ item[COL.EMAIL] }}</p>
                                  </div>
                                </div>

                                <div class="col-sm-6">
                                  <div class="info-item">
                                    <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</label>
                                    <p><i class="fa-solid fa-calendar-check me-1 text-muted"></i> {{ formatThaiDate(item[COL.TIMESTAMP, true]) }}</p>
                                  </div>
                                </div>

                              </div>
                            </div>
                            
                          </div>

                          <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (Status & Actions) -->
                          <div class="col-lg-5 bg-light-status p-4 border-start">
                            <template v-if="canUserEdit">
                              <div class="qr-section text-center mb-4 p-3 bg-white rounded-4 shadow-sm border">
                                <small class="text-primary fw-bold d-block mb-2">
                                  <i class="fa-solid fa-qrcode me-1"></i> QR Code ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
                                </small>
                                
                                <div class="d-inline-block p-2 border rounded-3 bg-white" style="max-width: 100%; height: auto;">
                                  <img :src="'https://quickchart.io/qr?text=' + encodeURIComponent(item[COL.ID] + '|' + item[COL.FNAME] + '|' + item[COL.LNAME]) + '&size=300'"
                                      alt="QR Code" 
                                      class="img-fluid"
                                      style="width: 100%; max-width: 250px; height: auto; aspect-ratio: 1 / 1; display: block; margin: auto; image-rendering: pixelated;">
                                </div>
                                
                                <div class="mt-2">
                                  <div class="fw-bold small mb-1">{{ item[COL.TITLE] }}{{ item[COL.FNAME] }}  {{ item[COL.LNAME] }}</div>
                                  <span class="badge bg-dark rounded-pill px-3 mb-2">ID: {{ item[COL.ID] }}</span>
                                  
                                  <button @click="downloadQr(item[COL.ID], item[COL.FNAME], item[COL.LNAME])" class="btn btn-outline-primary btn-sm w-100 rounded-pill mt-2">
                                    <i class="fa-solid fa-download me-1"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î QR Code
                                  </button>
                                </div>

                                <p class="text-dark mt-2 mb-0" style="font-size: 0.8rem;">
                                  ‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏™‡∏î‡∏á QR Code ‡∏ô‡∏µ‡πâ‡∏ï‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà ‡∏ì ‡∏à‡∏∏‡∏î‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                                </p>
                              </div>
                            </template>

                            <!-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å) -->
                            <div v-if="item[COL.REG_TYPE] === REG_STATUS.EXTERNAL" class="status-box mb-2">
                              <h6 class="fw-bold text-muted mb-3"><i class="fa-solid fa-wallet me-2"></i>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h6>
                              <div class="row g-2">
                                <div class="col-6">
                                  <div class="status-card text-center p-2 rounded-3 border bg-white shadow-sm">
                                    <div class="tiny-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Pay-in</div>
                                    <div :class="['fw-bold small', item[COL.PAYIN_STATUS] === '‡∏™‡πà‡∏á‡πÉ‡∏ö Pay-in ‡πÅ‡∏•‡πâ‡∏ß' ? 'text-success' : 'text-secondary']">
                                      {{ item[COL.PAYIN_STATUS] || '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' }}
                                    </div>
                                  </div>
                                </div>
                                <div class="col-6">
                                  <div class="status-card text-center p-2 rounded-3 border bg-white shadow-sm">
                                    <div class="tiny-label">‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</div>
                                    <div :class="['fw-bold small', item[COL.PAYMENT_STATUS] === '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢' ? 'text-success' : 'text-secondary']">
                                      {{ item[COL.PAYMENT_STATUS] || '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' }}
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <!-- üîµ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ) -->
                              <div v-if="item[COL.SLIP] && item[COL.SLIP] !== '-'" class="mt-3">
                                <button type="button" 
                                        @click="openSpeakerModal({ 
                                          img: item[COL.SLIP], 
                                          name: '‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô', 
                                          dept: item[COL.RECEIPT_NAME] || (item[COL.TITLE] + item[COL.FNAME] + ' ' + item[COL.LNAME]) 
                                        }, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ')" 
                                        class="btn btn-outline-primary btn-sm w-100 rounded-pill shadow-sm">
                                  <i class="fa-solid fa-receipt me-2"></i>‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                                </button>
                              </div>

                            </div>

                            <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö Batch) -->
                            <div class="action-buttons d-grid gap-3">
                              
                              <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 2 ‡∏ß‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà -->
                              <div v-if="canDownload(item)">
                                  
                                  <div v-if="item[COL.CERT_URL] && item[COL.CERT_URL].startsWith('http')">
                                      
                                      <template v-if="isCertTimeOpen">
                                          <a :href="item[COL.CERT_URL]" target="_blank" @click="onDownloadClick(item.rowNumber)" 
                                            class="btn btn-success w-100 py-2 rounded-pill shadow btn-hover-grow d-flex align-items-center justify-content-center gap-2">
                                              <i class="fa-solid fa-certificate"></i>
                                              <span>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£</span>
                                              <span class="badge rounded-pill bg-white text-success small border" style="font-size: 0.7rem;">
                                                  {{ item[COL.DOWNLOAD] || 0 }} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                                              </span>
                                          </a>
                                          <p class="text-center text-success mt-2 mb-0" style="font-size: 0.75rem;">
                                              <i class="fa-solid fa-check-double"></i> ‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç
                                          </p>
                                      </template>

                                      <div v-else class="alert alert-warning border-0 mb-0 rounded-4 text-center shadow-sm">
                                          <i class="fa-solid fa-clock-rotate-left me-2"></i>
                                          <strong>‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</strong><br>
                                          <span class="small">{{ formatThaiDate(certDeadline, true) }}</span>
                                      </div>
                                  </div>

                                  <div v-else class="alert alert-info border-0 mb-0 rounded-4 shadow-sm text-center animate__animated animate__fadeIn">
                                      <div class="d-flex align-items-center justify-content-center gap-2 mb-1">
                                          <i class="fa-solid fa-hourglass-half fa-spin text-primary"></i>
                                          <strong class="text-primary">‡∏ó‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ø</strong>
                                      </div>
                                      <div class="small text-muted">‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÑ‡∏ü‡∏•‡πå PDF<br>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á</div>
                                  </div>
                                  
                              </div>
                              
                              <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏Å‡∏£‡∏ì‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö (‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö 2 ‡∏ß‡∏±‡∏ô) -->
                              <div v-else class="alert alert-warning border-0 small mb-0 rounded-4 shadow-sm text-center">
                                <i class="fa-solid fa-circle-info me-1"></i> 
                                ‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 2 ‡∏ß‡∏±‡∏ô
                                <div class="mt-1 opacity-75" style="font-size: 0.7rem;">
                                  (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25: {{item[COL.ATTEND_1] || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πÅ‡∏Å‡∏ô'}}, ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 26: {{item[COL.ATTEND_2] || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡πÅ‡∏Å‡∏ô'}})
                                </div>
                              </div>

                              <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏ï‡∏≤‡∏°‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤) -->
                              <div class="action-buttons d-grid gap-3">
                                <template v-if="canUserEdit">
                                  <button @click="prepareEdit(item)" class="btn btn-outline-warning w-100 py-2 rounded-pill btn-hover-grow fw-600">
                                    <i class="fa-solid fa-user-pen me-2"></i>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                                  </button>
                                </template>

                                <div v-else-if="isTimerLoaded" class="alert alert-light border-0 py-3 mb-0 rounded-4 text-center shadow-sm" 
                                      style="background-color: #f8f9fa;">
                                  <div class="text-danger mb-1 fw-bold">
                                    <i class="fa-solid fa-clock-rotate-left me-2"></i>‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß
                                  </div>
                                  <div class="small text-muted">
                                    ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 30 ‡∏°‡∏¥.‡∏¢. 69 (18:00 ‡∏ô.)
                                  </div>
                                  <hr class="my-2 opacity-10">
                                  <div class="small fw-600 text-primary">
                                    <i class="fa-solid fa-headset me-1"></i> ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
                                  </div>
                                </div>
                              </div>

                            </div>
                        
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <div class="text-center mt-4">
                      <button class="btn btn-link text-secondary text-decoration-none" 
                        @click="searchResult = null; searchQuery = ''">
                        <i class="fa-solid fa-xmark me-1"></i> ‡∏õ‡∏¥‡∏î‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                      </button>
                    </div>
                  </div>

                </div>
                <!-- =================================================================== -->

                <template v-if="canUserEdit">
                  <form @submit.prevent="goToSummary">
                    <!-- ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‡πÅ‡∏•‡∏∞ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
                    <h4 :class="['section-title d-flex align-items-center mb-2', { 'text-warning': isEditMode }]">
                      <i :class="['me-2', isEditMode ? 'fa-solid fa-user-pen text-warning' : 'fa-solid fa-user-plus']"></i>
                      {{ isEditMode ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô' : '‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô' }}
                    </h4>

                    <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ -->
                    <div v-if="isEditMode" class="mb-3 text-end">
                      <span class="badge bg-light text-dark border fw-normal">
                        <i class="fa-solid fa-clock-rotate-left me-1 text-primary"></i> 
                        ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠: {{ formatThaiDate(form.timestamp, true) }}
                      </span>
                    </div>

                    <div class="alert alert-info border-0 rounded-4 shadow-sm mb-4">
                      <i class="fa-solid fa-circle-info me-2"></i> 
                      ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏≠‡∏ö‡∏£‡∏° ‡∏Ñ‡πà‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô 2,000 ‡∏ö‡∏≤‡∏ó 
                      <br><small class="ms-4 text-danger font-weight-bold">*‡∏Ç‡∏≠‡∏™‡∏á‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏°‡πà‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏∏‡∏Å‡∏Å‡∏£‡∏ì‡∏µ*</small>
                    </div>

                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß + ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ (‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ñ‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô) -->
                    <div class="row g-4 mb-5">
                      
                      <!-- ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢: ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
                      <div class="col-lg-8 border-end-lg">
                        <h5 class="section-title d-flex align-items-center mb-4">
                          <i class="fa-solid fa-user-pen me-2"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
                        </h5>
                        
                        <div class="row g-3">
                          <div class="col-md-12">
                            <label class="form-label" :class="{'required': !OPTIONAL_POSITIONS.includes(form.internalPosition)}">
                              ‡∏≠‡∏µ‡πÄ‡∏°‡∏•
                            </label>
                            <div class="input-icon-wrapper">
                              <i class="fa-solid fa-envelope"></i>
                              <input type="email" v-model="form.email" class="form-control" placeholder="example@gmail.com" 
                                    @input="formatEmail(false)"
                                    :required="!OPTIONAL_POSITIONS.includes(form.internalPosition)">
                            </div>
                          </div>
                          
                          <div class="col-md-4">
                            <label class="form-label required">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
                            <div class="input-icon-wrapper">
                              <i class="fa-solid fa-user-tag"></i>
                              <select v-model="form.title_Name" class="form-select" required>
                                <option value="" disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
                                <option v-for="item in prefixOptions" :key="item" :value="item">{{ item }}</option>
                              </select>
                            </div>
                          </div>

                          <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏ä‡∏∑‡πà‡∏≠ -->
                          <div class="col-md-4">
                            <label class="form-label required">‡∏ä‡∏∑‡πà‡∏≠</label>
                            <input type="text" 
                                  v-model="form.firstName" 
                                  @input="formatName('firstName')" 
                                  class="form-control" 
                                  placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢" 
                                  required>
                          </div>

                          <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• -->
                          <div class="col-md-4">
                            <label class="form-label required">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                            <input type="text" 
                                  v-model="form.lastName" 
                                  @input="formatName('lastName')" 
                                  class="form-control" 
                                  placeholder="‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢" 
                                  required>
                          </div>

                          <div class="col-md-6">
                            <label class="form-label" :class="{'required': !OPTIONAL_POSITIONS.includes(form.internalPosition)}">
                              ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå
                            </label>
                            <div class="input-icon-wrapper">
                              <i class="fa-solid fa-phone"></i>
                              <input type="text" v-model="form.phoneNumber" @input="formatPhone" class="form-control" 
                                    placeholder="0xx-xxx-xxxx" maxlength="12" 
                                    :required="!OPTIONAL_POSITIONS.includes(form.internalPosition)">
                            </div>
                          </div>

                          <div class="col-md-6">
                            <label class="form-label" :class="{'required': !OPTIONAL_POSITIONS.includes(form.internalPosition)}">
                              ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û (10 ‡∏´‡∏•‡∏±‡∏Å)
                            </label>
                            <div class="input-icon-wrapper">
                              <i class="fa-solid fa-id-card-clip"></i>
                              <input type="text" v-model="form.proLicense" @input="formatLicense" class="form-control" 
                                    placeholder="‡πÄ‡∏•‡∏Ç 10 ‡∏´‡∏•‡∏±‡∏Å" maxlength="10" 
                                    :required="!OPTIONAL_POSITIONS.includes(form.internalPosition)">
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤: ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ -->
                      <div class="col-lg-4 ps-lg-4">
                        <h5 class="section-title d-flex align-items-center mb-4">
                          <i class="fa-solid fa-camera me-2"></i> ‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
                        </h5>
                        <div class="camera-card border rounded-4 p-4 shadow-sm text-center">
                            <!-- ‡∏ß‡∏á‡∏Å‡∏•‡∏°‡∏û‡∏£‡∏µ‡∏ß‡∏¥‡∏ß -->
                            <div class="camera-circle-wrapper mb-3">
                                <video v-if="isCameraActive" 
                                      id="webcam" 
                                      autoplay 
                                      playsinline 
                                      :style="{ transform: 'scaleX(-1) scale(' + cameraZoom + ')' }">
                                </video>
                                
                                <canvas id="canvas" class="d-none"></canvas>
                                
                                <!-- ‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏á‡∏ñ‡πà‡∏≤‡∏¢ -->
                                <img v-if="profilePreview" :src="profilePreview" class="photo-preview-img">
                                
                                <div v-if="!profilePreview && !isCameraActive" 
                                    class="camera-placeholder w-100 h-100 position-absolute top-0 start-0 d-flex align-items-center justify-content-center">
                                    <i class="fa-solid fa-user-nurse fa-4x opacity-25"></i>
                                </div>
                            </div>

                            <!-- ‡πÅ‡∏ñ‡∏ö‡∏ã‡∏π‡∏° -->
                            <div v-if="isCameraActive" class="zoom-control-wrapper animate__animated animate__fadeIn">
                                <div class="zoom-label">
                                    <span><i class="fa-solid fa-magnifying-glass-minus"></i></span>
                                    <span>‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢</span>
                                    <span><i class="fa-solid fa-magnifying-glass-plus"></i></span>
                                </div>
                                <input type="range" v-model="cameraZoom" class="form-range" min="1" max="3" step="0.1">
                            </div>

                            <div class="camera-btn-group">
                                
                                <button type="button" v-if="!isCameraActive && !profilePreview" 
                                    @click="startWebcam" 
                                    class="btn btn-outline-primary btn-sm rounded-pill px-4">
                                    <i class="fa-solid fa-video me-2"></i>‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
                                </button>

                                <button type="button" v-if="!isCameraActive && !profilePreview" 
                                    @click="$refs.fileInput.click()" 
                                    class="btn btn-outline-primary btn-sm rounded-pill px-3">
                                    <i class="fa-solid fa-image me-2"></i>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                                </button>
                                <input type="file" ref="fileInput" class="d-none" accept="image/*" @change="handleFileUpload">

                                <button type="button" v-if="isCameraActive" 
                                    @click="capturePhoto" class="btn btn-success btn-sm rounded-pill px-4">
                                    <i class="fa-solid fa-camera me-2"></i>‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ
                                </button>

                                <button type="button" v-if="isCameraActive" 
                                    @click="stopWebcam" class="btn btn-danger btn-sm rounded-pill px-4">
                                    <i class="fa-solid fa-video-slash me-2"></i>‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
                                </button>

                                <button type="button" v-if="profilePreview && !isCameraActive" 
                                    @click="retakePhoto" class="btn btn-outline-warning btn-sm rounded-pill px-4">
                                    <i class="fa-solid fa-rotate me-2"></i> {{ isEditMode ? '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ‡πÉ‡∏´‡∏°‡πà' : '‡∏ñ‡πà‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà' }}
                                </button>
                                
                            </div>
                        </div>
                      </div>

                    </div>

                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (‡∏¢‡πâ‡∏≤‡∏¢‡∏•‡∏á‡∏°‡∏≤‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≤‡∏á‡∏•‡πà‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô) -->
                      <h5 class="section-title d-flex align-items-center mb-4">
                        <i class="fa-solid fa-utensils"></i> ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£
                      </h5>    
                      <div class="registration-grid">
                        <label class="reg-item">
                          <input type="radio" class="reg-input" v-model="form.foodType" value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ" id="f1" required>
                          <div class="reg-card p-3">
                            <i class="fa-solid fa-plate-wheat"></i>
                            <span>‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</span>
                          </div>
                        </label>
                        <label class="reg-item">
                          <input type="radio" class="reg-input" v-model="form.foodType" value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏¥‡∏™‡∏•‡∏≤‡∏°" id="f2">
                          <div class="reg-card p-3">
                            <i class="fa-solid fa-mosque"></i>
                            <span>‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏¥‡∏™‡∏•‡∏≤‡∏°</span>
                          </div>
                        </label>
                      </div>

                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô -->
                    <h5 class="section-title d-flex align-items-center mt-4">
                      <i class="fa-solid fa-address-card"></i> ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
                    </h5>

                    <div class="row g-4">

                      <div class="col-lg-4">
                        <div class="registration-grid d-flex flex-column gap-3">

                        <label class="reg-item w-100" 
                              :class="{ 'opacity-50': isExternalClosed && !isAdminLoggedIn && !isEditMode }">                          
                          <input type="radio" class="reg-input" 
                                v-model="form.status_Register" 
                                :value="REG_STATUS.EXTERNAL"
                                :disabled="isExternalClosed && !isAdminLoggedIn && !isEditMode"> <div class="reg-card p-3 h-100 justify-content-center" 
                              :class="{ 'border-danger': isExternalClosed && !isAdminLoggedIn && !isEditMode }">
                            <i class="fa-solid fa-globe mb-2"></i>
                            <span>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô<br>‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å (‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ)</span>
                            
                            <small v-if="isExternalClosed && !isAdminLoggedIn && !isEditMode" class="text-danger fw-bold mt-1">
                              ( ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß )
                            </small>
                          </div>
                        </label>

                          <label class="reg-item w-100" 
                                :class="{ 'opacity-50': !isEditMode && !isAdminLoggedIn && form.status_Register !== REG_STATUS.INTERNAL }">
                            <input type="radio" class="reg-input" v-model="form.status_Register" 
                                  :value="REG_STATUS.INTERNAL"
                                  :disabled="!isEditMode && !isAdminLoggedIn"> <div class="reg-card p-3 h-100 justify-content-center">
                              <i class="fa-solid fa-hospital-user mb-2"></i>
                              <span>‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•<br>‡∏£‡∏û.‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå</span>
                              <small v-if="!isEditMode && !isAdminLoggedIn" class="text-danger fw-bold mt-1">( ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÉ‡∏´‡πâ )</small>
                              <small v-else-if="isAdminLoggedIn && !isEditMode" class="text-success fw-bold mt-1">( ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÉ‡∏´‡πâ )</small>
                            </div>
                          </label>

                          <label class="reg-item w-100" 
                                :class="{ 'opacity-50': !isEditMode && !isAdminLoggedIn && form.status_Register !== REG_STATUS.QUOTA }">
                            <input type="radio" class="reg-input" v-model="form.status_Register" 
                                  :value="REG_STATUS.QUOTA"
                                  :disabled="!isEditMode && !isAdminLoggedIn"> <div class="reg-card p-3 h-100 justify-content-center">
                              <i class="fa-solid fa-envelope-circle-check mb-2"></i>
                              <span>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤<br>‡∏ï‡∏≤‡∏°‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏ä‡∏¥‡∏ç</span>
                              <small v-if="!isEditMode && !isAdminLoggedIn" class="text-danger fw-bold mt-1">( ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÉ‡∏´‡πâ )</small>
                              <small v-else-if="isAdminLoggedIn && !isEditMode" class="text-success fw-bold mt-1">( ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÉ‡∏´‡πâ )</small>
                            </div>
                          </label>

                        </div>
                      </div>

                      <div class="col-lg-8">
                        
                        <div v-if="!form.status_Register" class="status-section text-center py-5 d-flex flex-column align-items-center justify-content-center bg-white shadow-sm border-dashed" style="margin:0; min-height: 350px;">
                          <i class="fa-solid fa-arrow-left fa-3x mb-3 text-muted opacity-25 d-none d-lg-block"></i>
                          <i class="fa-solid fa-arrow-up fa-3x mb-3 text-muted opacity-25 d-lg-none"></i>
                          <h5 class="text-muted">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢</h5>
                        </div>

                        <div v-if="form.status_Register === REG_STATUS.INTERNAL" class="status-section shadow-sm m-0 animate__animated animate__fadeIn">
                          <div class="status-header text-internal">
                            <i class="fa-solid fa-hospital-user"></i>
                            <div>
                              <h5>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÉ‡∏ô‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏£‡∏û.‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå</h5>
                              <div class="deadline-info">
                                <i class="fa-solid fa-calendar-day me-1"></i> ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏û.‡∏Ñ. - 30 ‡∏°‡∏¥.‡∏¢. 2569
                              </div>
                            </div>
                          </div>
                          <div class="row g-3">
                            <div class="col-md-12">
                              <label class="form-label required">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
                              <div class="input-icon-wrapper">
                                <i class="fa-solid fa-user-nurse"></i>
                                <select v-model="form.internalPosition" class="form-select" :class="{'is-invalid-field': errors.internalPosition}" required>
                                  <option value="" disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á --</option>
                                  <option v-for="item in professionOptions" :key="item" :value="item">{{ item }}</option>
                                  <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á)</option>
                                </select>
                              </div>
                              <div v-if="form.internalPosition === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'" class="mt-2">
                                <input type="text" v-model="form.internalPosition_OtherText" class="form-control" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" :required="form.internalPosition === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'">
                              </div>
                            </div>
                            <div class="col-md-12" v-if="!OPTIONAL_POSITIONS.includes(form.internalPosition)">
                              <label class="form-label required">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô</label>
                              <select v-model="form.workGroup" @change="onWorkGroupChange" class="form-select">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô --</option>
                                <option v-for="(depts, group) in workGroupData" :value="group">{{ group }}</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á)</option>
                              </select>
                            </div>
                            <div class="col-md-12" v-if="!OPTIONAL_POSITIONS.includes(form.internalPosition)">
                              <label class="form-label required">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
                              <select v-model="form.department" class="form-select" :disabled="!form.workGroup">
                                <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô --</option>
                                <option v-for="dept in currentDepts" :value="dept">{{ dept }}</option>
                                <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á)</option>
                              </select>
                            </div>
                          </div>
                        </div>

                        <div v-if="form.status_Register === REG_STATUS.QUOTA" class="status-section shadow-sm m-0 animate__animated animate__fadeIn">
                          <div class="status-header text-quota">
                            <i class="fa-solid fa-envelope-circle-check"></i>
                            <div>
                              <h5>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏ä‡∏¥‡∏ç‡∏ñ‡∏∂‡∏á‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</h5>
                              <div class="deadline-info">
                                <i class="fa-solid fa-calendar-day me-1"></i> ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏û.‡∏Ñ. - 30 ‡∏°‡∏¥.‡∏¢. 2569
                              </div>
                            </div>
                          </div>
                          <label class="form-label required">‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
                          <div class="input-icon-wrapper mb-3">
                            <i class="fa-solid fa-building-circle-check"></i>
                            <select v-model="form.affiliation" class="form-select" required>
                              <option value="" disabled>-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î --</option>
                              <option v-for="item in affiliationOptions" :key="item" :value="item">{{ item }}</option>
                              <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">-- ‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á) --</option>
                            </select>
                          </div>

                          <div v-if="['‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏≤‡∏Å 3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ', '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'].includes(form.affiliation)" 
                              class="animate__animated animate__fadeIn mt-2 p-3 bg-light rounded border-start border-4 border-warning shadow-sm">
                            
                            <label class="form-label required fw-bold text-primary">
                              <i class="fa-solid fa-pen-to-square me-1"></i> ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•
                            </label>
                            
                            <input type="text" 
                                  v-model="form.affiliation_otherText" 
                                  class="form-control" 
                                  :placeholder="form.affiliation === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà...' : '‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏û.‡∏¢‡∏∞‡∏•‡∏≤, ‡∏£‡∏û.‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ...'" 
                                  :required="['‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏≤‡∏Å 3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ', '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'].includes(form.affiliation)">
                            
                            <small class="text-danger fw-bold d-block mt-1" v-if="form.affiliation === '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏≤‡∏Å 3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ'">
                              * ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥: (3 ‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡πÉ‡∏ï‡πâ)
                            </small>
                            <small class="text-muted d-block mt-1" v-else>
                              * ‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô
                            </small>
                          </div>
                        </div>

                        <div v-if="form.status_Register === REG_STATUS.EXTERNAL" class="status-section shadow-sm m-0 animate__animated animate__fadeIn">
                          <div class="status-header text-external">
                            <div>
                              <h5><i class="fa-solid fa-earth-asia me-1"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å</h5>
                              <div class="deadline-info">
                                <i class="fa-solid fa-file-invoice me-1"></i> 
                                ‡∏´‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏ó‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á
                              </div>
                              <div v-if="externalDeadline" class="deadline-info" >
                                <i class="fa-solid fa-clock me-1"></i>
                                ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: {{ formatThaiDate(externalDeadline, true) }}
                              </div>
                            </div>
                          </div>

                          <div class="mb-3">
                            <label class="form-label required">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</label>
                            <textarea v-model="form.workPlace" class="form-control" rows="2" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•" required></textarea>
                          </div>

                          <div class="border-top pt-3">
                            <h6 class="fw-bold mb-3 text-primary">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</h6>
                            <div class="mb-3">
                              <label class="form-label required">‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</label>
                              <div class="input-group">
                                <input type="text" v-model="form.name_Receipt" class="form-control" required>
                                <button type="button" class="btn btn-primary" @click="copyName">‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏â‡∏±‡∏ô</button>
                              </div>
                            </div>
                            <div class="row g-2">
                              <div class="col-md-6"><input type="text" id="sub_district" v-model="form.address_subdistrict" class="form-control" placeholder="‡∏ï‡∏≥‡∏ö‡∏•"></div>
                              <div class="col-md-6"><input type="text" id="district" v-model="form.address_district" class="form-control" placeholder="‡∏≠‡∏≥‡πÄ‡∏†‡∏≠"></div>
                              <div class="col-md-6"><input type="text" id="province" v-model="form.address_province" class="form-control" placeholder="‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î"></div>
                              <div class="col-md-6"><input type="text" id="postcode" v-model="form.address_postcode" class="form-control" placeholder="‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå"></div>
                            </div>
                            <div class="mt-3">
                              <label class="form-label required">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</label>
                              <input type="text" v-model="form.taxpayer_ID" @input="formatTaxID" class="form-control" placeholder="x-xxxx-xxxxx-xx-x" required>
                            </div>

                            <div class="mt-4 pt-3 border-top text-center bg-light rounded-4 p-3 shadow-sm border border-primary border-opacity-10">
                              <label class="form-label fw-bold text-primary d-block mb-3">
                                <i class="fa-solid fa-receipt me-2"></i>‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
                              </label>
                              
                              <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
                              <div v-if="form.slipImage" class="mb-3 animate__animated animate__zoomIn">
                                <img :src="form.slipImage" 
                                    style="max-height: 250px; border-radius: 12px; cursor: pointer;" 
                                    class="shadow border border-white border-4"
                                    title="‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏Ç‡∏¢‡∏≤‡∏¢"
                                    @click="openSpeakerModal({ 
                                      img: form.slipImage, 
                                      name: '‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô', 
                                      dept: form.name_Receipt || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à' 
                                    }, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ')">
                                <div class="small text-muted mt-2">
                                  <i class="fa-solid fa-search-plus me-1"></i> ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏ï‡πá‡∏°
                                </div>
                              </div>

                              <div class="d-flex flex-column align-items-center gap-2">
                                <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ: ‡∏à‡∏∞‡∏Å‡∏î‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ isEditMode ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô -->
                                <button type="button" 
                                        class="btn btn-primary rounded-pill px-4 shadow-sm" 
                                        @click="$refs.slipInput.click()"
                                        :disabled="!isEditMode">
                                  <i class="fa-solid fa-cloud-arrow-up me-2"></i> 
                                  {{ form.slipImage ? '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ' : '‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ' }}
                                </button>

                                <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á: ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç) -->
                                <div v-if="!isEditMode && form.status_Register === REG_STATUS.EXTERNAL" class="mt-1">
                                  <span class="badge bg-warning-subtle text-danger fw-normal" style="font-size: 0.75rem; white-space: normal;">
                                    <i class="fa-solid fa-circle-info me-1"></i> 
                                    ‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÑ‡∏î‡πâ‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"
                                  </span>
                                </div>
                              </div>
                              
                              <input type="file" ref="slipInput" class="d-none" accept="image/*" @change="handleSlipUpload">
                              <small class="text-muted d-block mt-2">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏û .jpg, .png (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB)</small>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="text-center mt-5 d-flex flex-wrap justify-content-center gap-3">                      
                        <!-- ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (isEditMode === true) -->
                        <button v-if="isEditMode" type="button" class="btn btn-outline-danger btn-lg px-4 rounded-pill shadow-sm" 
                            @click="confirmCancelEdit">
                            <i class="fa-solid fa-rotate-left me-2"></i> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç / ‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°
                        </button>

                        <button type="submit" class="btn btn-primary btn-lg px-5 rounded-pill shadow">
                            ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ <i class="fa-solid fa-circle-arrow-right ms-2"></i>
                        </button>
                    </div>

                  </form>
                </template>

              </div>

              <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ (Step 2) -->
              <div class="card-body p-4 p-md-5" id="summary-content" v-if="step === 2">

                <!-- Header -->
                <div class="text-center mb-5">
                  <div class="display-5 text-success mb-3">
                    <i class="fa-solid fa-clipboard-check"></i>
                  </div>
                  <h3 class="fw-bold mb-2">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô</h3>
                  <p class="text-muted small mb-0">
                    ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                  </p>
                </div>

                <div class="row g-4">

                  <!-- LEFT COLUMN -->
                  <div class="col-lg-6">

                    <!-- PROFILE -->
                    <div class="d-flex flex-column align-items-center justify-content-center">                       
                      <div class="position-relative">
                        <img v-if="profilePreview"
                            :src="profilePreview"
                            class="rounded-circle border border-4 border-white shadow"
                            style="width: 200px; height: 200px; object-fit: cover; cursor: pointer;"
                            title="‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏£‡∏π‡∏õ"
                            @click="openSpeakerModal({ 
                              img: profilePreview, 
                              name: form.title_Name + form.firstName + ' ' + form.lastName, 
                              dept: '‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô' 
                            }, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢')">
                        
                        <div v-else
                            class="rounded-circle bg-white border border-4 border-white shadow d-flex align-items-center justify-content-center"
                            style="width: 200px; height: 200px;">
                          <i class="fa-solid fa-user-nurse fa-3x text-muted opacity-50"></i>
                        </div>
                      </div>
                      <span class="mt-3 small fw-bold text-secondary">
                        ‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
                      </span>
                    </div>

                    <!-- PERSONAL INFO -->
                    <div class="summary-card">
                      <h6 class="section-title">
                        <i class="fa-solid fa-user me-2"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
                      </h6>

                      <div class="summary-item">
                        <div class="summary-label">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</div>
                        <div class="summary-value">{{form.email}}</div>
                      </div>

                      <div class="summary-item">
                        <div class="summary-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</div>
                        <div class="summary-value">
                          {{form.title_Name}}{{form.firstName}} {{form.lastName}}
                        </div>
                      </div>

                      <div class="summary-item">
                        <div class="summary-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</div>
                        <div class="summary-value">{{form.phoneNumber}}</div>
                      </div>

                      <div class="summary-item">
                        <div class="summary-label">‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ø</div>
                        <div class="summary-value">{{form.proLicense}}</div>
                      </div>

                      <div class="summary-item">
                        <div class="summary-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£</div>
                        <div class="summary-value">{{form.foodType}}</div>
                      </div>

                      <div class="summary-item">
                        <div class="summary-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</div>
                        <div class="summary-value">
                          <span class="badge bg-primary">
                            {{form.status_Register}}
                          </span>
                        </div>
                      </div>
                    </div>

                  </div>

                  <!-- RIGHT COLUMN -->
                  <div class="col-lg-6">

                    <!-- INTERNAL -->
                    <template v-if="form.status_Register === REG_STATUS.INTERNAL">
                      <div class="summary-card mb-4">
                        <h6 class="section-title">
                          <i class="fa-solid fa-hospital-user me-2"></i>
                          ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î
                        </h6>

                        <div class="summary-item">
                          <div class="summary-label">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</div>
                          <div class="summary-value">{{form.internalPosition}}</div>
                        </div>

                        <div class="summary-item">
                          <div class="summary-label">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô</div>
                          <div class="summary-value">
                            {{ form.workGroup === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? form.workGroup_OtherText : form.workGroup }}
                          </div>
                        </div>

                        <div class="summary-item">
                          <div class="summary-label">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</div>
                          <div class="summary-value">
                            {{ form.department === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? form.department_OtherText : form.department }}
                          </div>
                        </div>
                      </div>
                    </template>

                    <!-- QUOTA -->
                    <template v-if="form.status_Register === REG_STATUS.QUOTA">
                      <div class="summary-card mb-4">
                        <h6 class="section-title">
                          <i class="fa-solid fa-building-circle-check me-2"></i>
                          ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î
                        </h6>

                        <div class="summary-item">
                          <div class="summary-label">‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</div>
                          <div class="summary-value">
                            {{ form.affiliation === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' ? form.affiliation_otherText : form.affiliation }}
                          </div>
                        </div>
                      </div>
                    </template>

                    <!-- EXTERNAL -->
                    <template v-if="form.status_Register === REG_STATUS.EXTERNAL">
                      <div class="summary-card mb-4">
                        <h6 class="section-title">
                          <i class="fa-solid fa-briefcase me-2"></i>
                          ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à
                        </h6>

                        <div class="summary-item">
                          <div class="summary-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</div>
                          <div class="summary-value">{{form.workPlace}}</div>
                        </div>

                        <div class="summary-item">
                          <div class="summary-label">‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</div>
                          <div class="summary-value fw-bold text-dark">
                            {{form.name_Receipt}}
                          </div>
                        </div>

                        <div class="summary-item">
                          <div class="summary-label">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</div>
                          <div class="summary-value small">
                            {{form.address}} ‡∏ï.{{form.address_subdistrict}}
                            ‡∏≠.{{form.address_district}}
                            ‡∏à.{{form.address_province}}
                            {{form.address_postcode}}
                          </div>
                        </div>

                        <div class="summary-item">
                          <div class="summary-label">‡πÄ‡∏•‡∏Ç‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</div>
                          <div class="summary-value">
                            {{form.taxpayer_ID || '-'}}
                          </div>
                        </div>
                      </div>

                      <!-- SLIP -->
                      <div class="summary-card text-center">
                        <h6 class="section-title justify-content-center">
                          <i class="fa-solid fa-receipt me-2"></i>
                          ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
                        </h6>

                        <div v-if="form.slipImage">
                          <img :src="form.slipImage"
                              class="img-fluid rounded-3 border shadow-sm"
                              style="max-height:300px; cursor:pointer;"
                              @click="openSpeakerModal({ img: form.slipImage, name: '‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô', dept: form.name_Receipt }, '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏•‡∏¥‡∏õ')">

                          <div class="small text-muted mt-2">
                            <i class="fa-solid fa-search-plus me-1"></i>
                            ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ç‡∏¢‡∏≤‡∏¢‡∏£‡∏π‡∏õ
                          </div>
                        </div>

                        <div v-else class="p-4 border rounded-3 bg-light border-dashed">
                          <i class="fa-solid fa-file-circle-xmark fa-3x text-danger opacity-25 mb-2"></i>
                          <p class="text-danger small fw-bold mb-0">
                            ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ
                          </p>
                        </div>
                      </div>
                    </template>

                  </div>
                </div>

                <!-- BUTTONS -->
                <div class="d-flex gap-3 justify-content-center mt-5">
                  <button class="btn btn-outline-secondary btn-lg px-4 rounded-pill"
                          @click="step = 1">
                    <i class="fa-solid fa-pen-to-square me-2"></i>
                    ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                  </button>

                  <button class="btn btn-success btn-lg px-5 rounded-pill shadow"
                          @click="submitForm"
                          :disabled="loading">
                    <span v-if="loading"
                          class="spinner-border spinner-border-sm me-2"></span>
                    <i v-else class="fa-solid fa-circle-check me-2"></i>
                    ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                  </button>
                </div>

              </div>

            </div>

            <!-- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡πÅ‡∏•‡∏∞ ‡∏£‡∏π‡∏õ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£ -->
            <div v-if="currentView === 'schedule'" class="animate__animated animate__fadeIn">
              
              <div class="main-card shadow-lg border-0 overflow-hidden mb-4">
                
                <div class="form-header-banner" style="padding: 2rem 1rem;">
                  <h2 class="fw-800"><i class="fa-solid fa-calendar-days me-2"></i>‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡πÅ‡∏•‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h2>
                  <p class="mb-0">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ö‡∏ö Real-time</p>
                </div>

                <div class="card-body p-4 p-md-5">
                  
                  <div class="d-flex flex-column flex-md-row justify-content-end align-items-center mb-4 gap-2">
                    <a v-if="['admin'].includes(userRole)" 
                      :href="adminSheetUrl" target="_blank" 
                      class="btn btn-sm btn-outline-success rounded-pill px-3 shadow-sm">
                      <i class="fa-solid fa-file-excel me-1"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô Sheet
                    </a>

                    <button @click="handleDownload" 
                      class="btn btn-primary rounded-pill px-4 shadow-sm d-inline-flex align-items-center"
                      style="height: 45px;">
                      
                      <i class="fas fa-cloud-download-alt me-2"></i>
                      <span class="fw-600">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° (PDF)</span>
                      
                      <span class="badge rounded-pill bg-danger text-white ms-2 px-2">
                        {{ downloadCount }}
                      </span>
                    </button>
                  </div>

                  <div v-if="loadingSchedule" class="text-center py-5">
                    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;"></div>
                    <h5 class="mt-3 text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î...</h5>
                  </div>

                  <div v-else class="schedule-grid">
                    <div v-for="dayNum in [1, 2]" :key="dayNum" class="day-column">
                      <div class="modern-day-header" :style="dayNum === 2 ? 'background:linear-gradient(135deg, #6610f2, #0d6efd)' : ''">
                        <h4 class="mb-1 fw-800">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà {{ dayNum }}</h4>
                        <span>{{ dayNum === 1 ? '25 ‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏° 2569' : '26 ‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏° 2569' }}</span>
                      </div>

                      <div v-for="(item, idx) in (dayNum === 1 ? scheduleData.day1 : scheduleData.day2)" 
                          :key="idx" class="modern-session-card shadow-sm" :class="{'break-card': item.isBreak}">
                        
                        <div class="time-badge">{{ item.time }}</div>
                        
                        <div class="session-content">
                          <h5 :class="{'mb-0': item.isBreak}">
                            <i v-if="item.isBreak" :class="['fa-solid', item.icon, 'me-2']"></i>
                            {{ item.title }}
                          </h5>
                          
                          <div v-if="!item.isBreak && item.speaker.name" class="speaker-pill" 
                              @click="openSpeakerModal(item.speaker, item.title)">
                            <div class="img-wrapper">
                              <img v-if="hasImage(item.speaker.img)" :src="item.speaker.img" class="speaker-img-mini">
                              <div v-else class="icon-speaker-placeholder"><i class="fa-regular fa-circle-user"></i></div>
                              <div class="zoom-icon"><i class="fa-solid fa-search-plus"></i></div>
                            </div>
                            <div>
                              <div class="fw-bold text-dark">{{ item.speaker.name }}</div>
                              <div class="small text-muted">{{ item.speaker.dept }}</div>
                            </div>
                          </div>

                          <div v-if="!item.isBreak && item.file.url" class="mt-3">
                            <div v-if="!item.file.isOpen" class="badge bg-light text-muted border py-2 px-3 rounded-pill w-100">
                              <i class="fa-solid fa-lock me-2"></i> ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î: {{ formatThaiDate(item.file.openDateStr, false) }}
                            </div>

                            <a v-else 
                              :href="item.file.url" 
                              target="_blank" 
                              @click="onScheduleDownload(item)"
                              class="btn btn-primary btn-sm rounded-pill px-4 shadow-sm w-100 w-md-auto d-flex align-items-center justify-content-center gap-2">
                              <i class="fa-solid fa-file-arrow-down"></i>
                              <span>‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢</span>
                              
                              <span class="badge rounded-pill bg-white text-primary border shadow-sm" style="font-size: 0.7rem;">
                                {{ item.file.count }}
                              </span>
                            </a>

                          </div>

                        </div>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤ (Contact Us) -->
            <div v-if="currentView === 'contact'" class="animate__animated animate__fadeIn">
              <div class="main-card shadow-lg border-0 overflow-hidden mb-4">
                <!-- Header ‡πÄ‡∏•‡πá‡∏Å‡πÜ ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ -->
                <div class="form-header-banner" style="padding: 2rem 1rem;">
                  <h2 class="fw-800"><i class="fa-solid fa-address-book me-2"></i>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</h2>
                  <p class="mb-0">‡∏´‡∏≤‡∏Å‡∏ó‡πà‡∏≤‡∏ô‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</p>
                </div>

                <div class="card-body p-4 p-md-5">
                  <div class="row g-4">
                    
                    <!-- ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠ -->
                    <div class="col-lg-5">
                      <h5 class="section-title mt-0"><i class="fa-solid fa-circle-info me-2"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h5>
                      
                      <div class="contact-info-list mt-4">
                        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 1: ‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• -->
                        <div class="d-flex align-items-start mb-4">
                          <div class="flex-shrink-0 bg-soft-primary p-3 rounded-circle me-3">
                            <i class="fa-solid fa-hospital text-primary fs-4"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå</h6>
                            <p class="text-muted small">‡∏™‡∏†‡∏≤‡∏Å‡∏≤‡∏ä‡∏≤‡∏î‡πÑ‡∏ó‡∏¢ ‡∏ñ‡∏ô‡∏ô‡∏û‡∏£‡∏∞‡∏£‡∏≤‡∏°‡∏ó‡∏µ‡πà 4 ‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø 10330</p>
                          </div>
                        </div>

                        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå -->
                        <div class="d-flex align-items-start mb-4">
                          <div class="flex-shrink-0 bg-soft-primary p-3 rounded-circle me-3">
                            <i class="fa-solid fa-phone-volume text-primary fs-4"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h6>
                            <p class="mb-0">02-256-xxxx ‡∏ï‡πà‡∏≠ xxxx</p>
                            <p class="text-muted small">(‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£ 08:00 - 16:00 ‡∏ô.)</p>
                            <a href="tel:022564000" class="btn btn-sm btn-outline-primary rounded-pill mt-2">
                              <i class="fa-solid fa-phone me-1"></i> ‡πÇ‡∏ó‡∏£‡∏≠‡∏≠‡∏Å
                            </a>
                          </div>
                        </div>

                        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà 3: ‡∏≠‡∏µ‡πÄ‡∏°‡∏• -->
                        <div class="d-flex align-items-start mb-4">
                          <div class="flex-shrink-0 bg-soft-primary p-3 rounded-circle me-3">
                            <i class="fa-solid fa-envelope-open-text text-primary fs-4"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏ó‡∏≤‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•</h6>
                            <p class="mb-0">nursing.chula@gmail.com</p>
                            <a href="mailto:nursing.chula@gmail.com" class="btn btn-sm btn-outline-primary rounded-pill mt-2">
                              <i class="fa-solid fa-paper-plane me-1"></i> ‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•
                            </a>
                          </div>
                        </div>
                      </div>

                      <div class="alert alert-secondary border-0 rounded-4 p-3 mt-4">
                        <small class="fw-bold text-dark d-block mb-1"><i class="fa-solid fa-clock me-1"></i> ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£:</small>
                        <small class="text-muted">‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå - ‡∏®‡∏∏‡∏Å‡∏£‡πå (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå)<br>‡πÄ‡∏ß‡∏•‡∏≤ 08.00 ‡∏ô. - 16.00 ‡∏ô.</small>
                      </div>
                    </div>

                    <!-- ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤: ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà Google Maps -->
                    <div class="col-lg-7">
                      <h5 class="section-title mt-0"><i class="fa-solid fa-map-location-dot me-2"></i>‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á</h5>
                      <div class="map-container mt-4 border rounded-4 shadow-sm overflow-hidden" style="height: 400px; border: 2px solid #fff !important;">
                        <!-- ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á -->
                        <iframe 
                          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3875.772583857503!2d100.53504867588147!3d13.73219468665796!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x30e29ed800000001%3A0x67396696b0c26806!2z4Lit4Liy4LiE4Liy4Lij4Lig4Li54Lih4Li04Liq4Li04Lij4Li04Lih4Lix4LiZ4LiE4Lil4Liy4LiZ4Li44Liq4Lij4LiN4LqU4Lih4Liy!5e0!3m2!1sth!2sth!4v1708150000000!5m2!1sth!2sth" 
                          width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                      </div>
                      <div class="d-flex justify-content-between align-items-center mt-3 px-2">
                        <span class="text-muted small">
                          <i class="fa-solid fa-location-arrow me-1"></i> ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏¥‡∏£‡∏¥‡∏°‡∏±‡∏á‡∏Ñ‡∏•‡∏≤‡∏ô‡∏∏‡∏™‡∏£‡∏ì‡πå
                        </span>
                        <a href="https://www.google.com/maps/search/?api=1&query=‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏†‡∏π‡∏°‡∏¥‡∏™‡∏¥‡∏£‡∏¥‡∏°‡∏±‡∏á‡∏Ñ‡∏•‡∏≤‡∏ô‡∏∏‡∏™‡∏£‡∏ì‡πå+‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå" 
                            target="_blank" 
                            class="btn btn-sm btn-success rounded-pill px-3 shadow-sm">
                            <i class="fa-solid fa-map me-1"></i> ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô Google Maps
                        </a>
                      </div>
                    </div>

                  </div>
                </div>
              </div>
            </div>


            <!-- Modal ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£ -->
            <div id="speakerDetailModal" class="speaker-modal-overlay" style="display:none;" @click.self="closeSpeakerModal">
                <div class="speaker-modal-content animate__animated animate__zoomIn">
                    <span class="speaker-modal-close-button" @click="closeSpeakerModal">&times;</span>
                    <img id="modalImageExpanded" src="" alt="Speaker Image">
                    <div class="p-4 text-center">
                        <h4 id="modalSpeakerNameExpanded" class="fw-bold text-primary mb-2"></h4>
                        <p id="modalSpeakerAffiliationExpanded" class="text-muted mb-0"></p>
                    </div>
                </div>
            </div>

            <!-- ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à -->
            <div v-if="currentView === 'AssessmentForm'" class="animate__animated animate__fadeIn">

              <template v-if="canAccessAssessment">
                <div class="main-card shadow-lg border-0 overflow-hidden mb-2">
                  <div class="form-header-banner">
                    <h2 class="fw-800">‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</h2>
                    <p class="mb-0">‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ 2569</p>
                  </div>

                  <!-- ‡πÅ‡∏™‡∏î‡∏á Spinner ‡∏Ç‡∏ì‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£‡∏à‡∏≤‡∏Å Sheet -->
                  <div v-if="loadingEval" class="text-center py-5 bg-white rounded-4 shadow-sm">
                    <div class="spinner-border text-primary" role="status"></div>
                    <p class="mt-2 text-muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô...</p>
                  </div>
                  
                  <div class="card-body p-4 p-md-5">
                    <div class="text-center py-2">
                      <div class="btn-group shadow-sm rounded-pill p-1 bg-light">
                        <button type="button" class="btn rounded-pill px-4 me-2" 
                          :disabled="!isDay1Active"
                          :class="evalDay === 1 ? 'btn-primary' : 'btn-light'" 
                          @click="changeDay(1)">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25 ‡∏™.‡∏Ñ.
                        </button>
                        <button type="button" class="btn rounded-pill px-4" 
                          :disabled="!isDay2Active"
                          :class="evalDay === 2 ? 'btn-primary' : 'btn-light'" 
                          @click="changeDay(2)">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 26 ‡∏™.‡∏Ñ.
                        </button>
                      </div>
                    </div>

                    <form @submit="submitEvaluation">
                      <h5 class="section-title"><i class="fa-solid fa-user-check me-2"></i>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</h5>
                      
                      <div class="row g-3 mb-2">

                        <!-- ‡∏Ç‡πâ‡∏≠ 1 -->
                        <div class="col-md-6">
                          <div class="card">
                            <div class="card-body">

                              <label class="form-label fw-bold mb-3">
                                1. ‡∏ó‡πà‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏à‡∏≤‡∏Å <span class="text-danger">*</span>
                              </label>

                              <div class="row g-3">
                                <div class="col-6">
                                  <label class="reg-item w-100 h-100">
                                    <input type="radio"
                                          class="reg-input"
                                          v-model="evalForm.origin"
                                          value="‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå"
                                          required>

                                    <div class="reg-card p-4 h-100 d-flex flex-column justify-content-center align-items-center text-center">
                                      <i class="fa-solid fa-hospital-user mb-2 fs-2"></i>
                                      <span>‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏£‡∏û.‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå</span>
                                    </div>
                                  </label>
                                </div>

                                <div class="col-6">
                                  <label class="reg-item w-100 h-100">
                                    <input type="radio"
                                          class="reg-input"
                                          v-model="evalForm.origin"
                                          value="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ"
                                          required>

                                    <div class="reg-card p-4 h-100 d-flex flex-column justify-content-center align-items-center text-center">
                                      <i class="fa-solid fa-building mb-2 fs-2"></i>
                                      <span>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô / ‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ</span>
                                    </div>
                                  </label>
                                </div>
                              </div>

                            </div>
                          </div>
                        </div>

                        <!-- ‡∏Ç‡πâ‡∏≠ 2 -->
                        <div class="col-md-6">
                          <div class="card">
                            <div class="card-body">

                              <label class="form-label fw-bold mb-3">
                                2. ‡∏ó‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? <span class="text-danger">*</span>
                              </label>

                              <div class="row g-3">
                                <div class="col-6">
                                  <label class="reg-item w-100 h-100">
                                    <input type="radio"
                                          class="reg-input"
                                          v-model="evalForm.gift"
                                          value="‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å"
                                          required>
                                    <div class="reg-card p-4 h-100 d-flex flex-column justify-content-center align-items-center text-center">
                                      <i class="fa-solid fa-gift mb-2 fs-2"></i>
                                      <span>‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å</span>
                                    </div>
                                  </label>
                                </div>
                                <div class="col-6">
                                  <label class="reg-item w-100 h-100">
                                    <input type="radio"
                                          class="reg-input"
                                          v-model="evalForm.gift"
                                          value="‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏£‡∏±‡∏ö"
                                          required>
                                    <div class="reg-card p-4 h-100 d-flex flex-column justify-content-center align-items-center text-center">
                                      <i class="fa-solid fa-hand-holding-heart mb-2 fs-2"></i>
                                      <span>‡πÑ‡∏°‡πà‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏£‡∏±‡∏ö</span>
                                    </div>
                                  </label>
                                </div>
                              </div>

                            </div>
                          </div>
                        </div>

                      </div>

                      <h5 class="section-title"><i class="fa-solid fa-list-check me-2"></i>‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2 ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÉ‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£</h5>
                      <span class="bg-warning-subtle py-2 px-2 rounded">
                        <i class="fa-solid fa-circle-info me-1"></i>
                        ‡∏Ñ‡∏≥‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á: ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡πà‡∏≤‡∏ô‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏≤‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÜ
                      </span>


                      <div class="table-responsive rounded-4 border-0 mt-3 shadow-sm">
                        <table class="table align-middle mb-0 questions-table">
                          <thead class="table-dark d-none d-md-table-header-group">
                            <tr>
                              <th class="text-start py-3">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</th>
                              <th width="350">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</th>
                            </tr>
                          </thead>
                          <tbody>

                            <template v-for="q in (evalDay === 1 ? day1Questions : day2Questions)" :key="q.id">
                              <tr>
                                <td colspan="2" class="p-3 p-md-4 border-0">
                                  <div class="d-flex flex-column flex-md-row align-items-center align-items-md-center gap-3">
                                    
                                    <div v-for="(speaker, index) in q.speakers" :key="index" 
                                        class="speaker-avatar-circle" 
                                        @click="openSpeakerModal(speaker, q.title)" style="cursor: pointer;">
                                      <img v-if="hasImage(speaker.img)" :src="speaker.img" class="img-speaker-fluid">
                                      <div v-else class="icon-speaker-placeholder">
                                        <i class="fa-regular fa-circle-user"></i>
                                      </div>
                                    </div>

                                    <div class="flex-grow-1 mt-2 mt-md-0 text-center text-md-start">
                                      <span class="lecturer-title d-block mb-1">{{ q.title }}</span>
                                      
                                      <div v-for="(speaker, sIdx) in q.speakers" :key="'info_'+sIdx" class="mb-2">
                                        <div class="small fw-bold text-dark">{{ speaker.name }}</div>
                                        <div class="small text-muted" style="line-height: 1.2;">{{ speaker.dept }}</div>
                                      </div>
                                    </div>
                                    
                                  </div>
                                </td>
                              </tr>

                              <tr v-for="sub in subItems" :key="q.id + '_' + sub.id">
                                <td class="ps-md-5 py-3 sub-text-large">
                                  <span class="sub-number">{{ q.id }}.{{ sub.id }}</span> {{ sub.text }}
                                </td>
                                <td>
                                  <div class="rating-container">
                                    <div v-for="val in ['‡∏°‡∏≤‡∏Å', '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á', '‡∏ô‡πâ‡∏≠‡∏¢']" :key="val" class="rating-item">
                                      <input type="radio" 
                                            :id="'q' + q.id + '_' + sub.id + '_' + val" 
                                            :name="'q' + q.id + '_' + sub.id" 
                                            :value="val" 
                                            v-model="evalForm['q' + q.id + '_' + sub.id]" 
                                            class="rating-input" 
                                            required>
                                      <label :for="'q' + q.id + '_' + sub.id + '_' + val" 
                                            class="rating-label" 
                                            :class="'rating-' + val">
                                        {{ val }}
                                      </label>
                                    </div>
                                  </div>
                                </td>
                              </tr>
                            </template>

                          </tbody>
                        </table>
                      </div>

                      <h5 class="section-title mt-5"><i class="fa-solid fa-comment-dots me-2"></i>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</h5>

                      <div class="p-4 bg-light rounded-4 border shadow-sm">
                        <div class="mb-2">
                          <label class="form-label fw-bold sub-text-large mb-3">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ï‡πà‡∏≠‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</label>
                          
                          <div class="rating-container">
                            <div v-for="val in ['‡∏°‡∏≤‡∏Å', '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á', '‡∏ô‡πâ‡∏≠‡∏¢']" :key="'overall_'+val" class="rating-item">
                              <input type="radio" 
                                    :id="'overall_' + val" 
                                    name="overallRating" 
                                    :value="val" 
                                    v-model="evalForm.overallRating" 
                                    class="rating-input" 
                                    required>
                              <label :for="'overall_' + val" class="rating-label" :class="'rating-' + val">
                                {{ val }}
                              </label>
                            </div>
                          </div>
                        </div>

                        <div class="mb-3">
                          <label class="form-label fw-bold small">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ</label>
                          <textarea class="form-control" v-model="evalForm.nextTopic" rows="2" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏ô‡πÉ‡∏à..."></textarea>
                        </div>
                        <div class="mb-0">
                          <label class="form-label fw-bold small">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</label>
                          <textarea class="form-control" v-model="evalForm.feedback" rows="2" placeholder="‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤..."></textarea>
                        </div>
                      </div>

                      <div class="text-center mt-5">
                        <button type="submit" class="btn btn-primary btn-lg rounded-pill px-5 shadow-lg" :disabled="loading">
                          <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span>
                          <i class="fa-solid fa-paper-plane me-2"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô
                        </button>
                      </div>
                    </form>
                  </div>
                </div>
              </template>

              <!-- ‡∏Å‡∏£‡∏ì‡∏µ‡∏£‡∏∞‡∏ö‡∏ö "‡∏õ‡∏¥‡∏î" -->
              <div v-else-if="isAssessmentTimerLoaded" class="container">
                <div class="card border-0 shadow-sm rounded-4 text-center p-5 mt-4">
                  <div class="mb-4">
                    <i class="fa-solid fa-clock-rotate-left fa-5x text-muted opacity-25"></i>
                  </div>
                  <h3 class="fw-bold text-primary">‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h3>
                  <p class="text-muted">‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£ ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ</p>
                  
                  <div class="row justify-content-center mt-4 g-3">
                    <div class="col-md-5">
                      <div class="p-3 bg-light rounded-4 border">
                        <h6 class="fw-bold mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 (25 ‡∏™.‡∏Ñ. 69)</h6>
                        <div class="small text-primary">‡πÄ‡∏õ‡∏¥‡∏î: {{ formatThaiDate(assessmentTimer?.day1Open, true) }}</div>
                        <div class="small text-danger">‡∏õ‡∏¥‡∏î: {{ formatThaiDate(assessmentTimer?.day1Close, true) }}</div>
                      </div>
                    </div>
                    <div class="col-md-5">
                      <div class="p-3 bg-light rounded-4 border">
                        <h6 class="fw-bold mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2 (26 ‡∏™.‡∏Ñ. 69)</h6>
                        <div class="small text-primary">‡πÄ‡∏õ‡∏¥‡∏î: {{ formatThaiDate(assessmentTimer?.day2Open, true) }}</div>
                        <div class="small text-danger">‡∏õ‡∏¥‡∏î: {{ formatThaiDate(assessmentTimer?.day2Close, true) }}</div>
                      </div>
                    </div>
                  </div>
                  <div class="mt-5">
                    <button class="btn btn-outline-primary rounded-pill px-4" @click="currentView = 'form'">
                      ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                    </button>
                  </div>
                </div>
              </div>

            </div>

            <!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à -->
            <div v-if="currentView === 'summary'" class="animate__animated animate__fadeIn">
              <div class="overflow-hidden">

                <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£) -->
                <div class="bg-primary text-white p-4 text-center">
                  <h3 class="fw-bold mb-3">‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏•</h3>
                  <div class="row g-2 justify-content-center">
                    <div class="col-md-4">
                      <select class="form-select border-0 shadow-sm" 
                            v-model="summaryFilter.date" 
                            @change="loadSummary">
                        <option value="">‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô</option>
                        <option value="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 (25 ‡∏™.‡∏Ñ.)</option>
                        <option value="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2 (26 ‡∏™.‡∏Ñ.)</option>
                      </select>
                    </div>
                    <div class="col-md-4">
                      <select class="form-select border-0 shadow-sm" 
                            v-model="summaryFilter.origin" 
                            @change="loadSummary">
                        <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î</option>
                        <option value="‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå">‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏à‡∏∏‡∏¨‡∏≤‡∏Ø</option>
                        <option value="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏™‡∏ñ‡∏≤‡∏ö‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å</option>
                      </select>
                    </div>

                    <div class="col-md-4 alert alert-light border text-center mb-3 rounded-pill">
                      ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <strong>{{ summaryData.totalResponses }}</strong> ‡∏ó‡πà‡∏≤‡∏ô
                    </div>
                  </div>
                </div>

                <div class="card-body p-4 p-md-5">
                  
                  <!-- 1. ‡πÅ‡∏™‡∏î‡∏á Spinner ‡∏Ç‡∏ì‡∏∞‡πÇ‡∏´‡∏•‡∏î -->
                  <div v-if="loading" class="text-center py-5">
                    <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;"></div>
                    <p class="mt-3 text-muted fw-bold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏£‡∏∏‡∏õ...</p>
                  </div>

                  <!-- 2. ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•-->
                  <div v-else-if="summaryData && summaryData.totalResponses > 0">                

                    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á Progress Bar -->
                    <div v-for="q in filteredQuestionsForSummary" :key="q.id" class="mb-4 border rounded-4 overflow-hidden shadow-sm">
                      <div class="bg-light p-3 border-bottom">
                        <div class="lecturer-title text-primary small fw-bold">{{ q.title }}</div>
                      </div>
                      <div class="p-3">
                        <div v-for="sub in subItems" :key="q.id + '_' + sub.id" class="mb-3">
                          <div class="fw-bold mb-2 small text-secondary">{{ q.id }}.{{ sub.id }} {{ sub.text }}</div>

                          <div class="progress" style="height: 30px; font-size: 0.85rem; border-radius: 10px; box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);">

                            <div class="progress-bar bg-success" :style="{ width: (summaryData.results['q'+q.id+'_'+sub.id]['‡∏°‡∏≤‡∏Å'] / summaryData.totalResponses * 100) + '%' }">
                              <span v-if="summaryData.results['q'+q.id+'_'+sub.id]['‡∏°‡∏≤‡∏Å'] > 0">
                                ‡∏°‡∏≤‡∏Å: {{ summaryData.results['q'+q.id+'_'+sub.id]['‡∏°‡∏≤‡∏Å'] }} 
                                ({{ getPercent(summaryData.results['q'+q.id+'_'+sub.id]['‡∏°‡∏≤‡∏Å'], summaryData.totalResponses) }}) </span>
                            </div>

                            <div class="progress-bar bg-warning text-dark" :style="{ width: (summaryData.results['q'+q.id+'_'+sub.id]['‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á'] / summaryData.totalResponses * 100) + '%' }">
                              <span v-if="summaryData.results['q'+q.id+'_'+sub.id]['‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á'] > 0">
                                ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á: {{ summaryData.results['q'+q.id+'_'+sub.id]['‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á'] }} 
                                ({{ getPercent(summaryData.results['q'+q.id+'_'+sub.id]['‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á'], summaryData.totalResponses) }}) </span>
                            </div>

                            <div class="progress-bar bg-danger" :style="{ width: (summaryData.results['q'+q.id+'_'+sub.id]['‡∏ô‡πâ‡∏≠‡∏¢'] / summaryData.totalResponses * 100) + '%' }">
                              <span v-if="summaryData.results['q'+q.id+'_'+sub.id]['‡∏ô‡πâ‡∏≠‡∏¢'] > 0">
                                ‡∏ô‡πâ‡∏≠‡∏¢: {{ summaryData.results['q'+q.id+'_'+sub.id]['‡∏ô‡πâ‡∏≠‡∏¢'] }} 
                                ({{ getPercent(summaryData.results['q'+q.id+'_'+sub.id]['‡∏ô‡πâ‡∏≠‡∏¢'], summaryData.totalResponses) }}) </span>
                            </div>

                          </div>

                        </div>
                      </div>
                    </div>

                    <hr class="my-4 border-primary border-2 opacity-50">

                    <div v-if="summaryData.comments && summaryData.comments.length > 0" class="animate__animated animate__fadeIn">
                      <div class="d-flex align-items-center mb-3">
                        <div class="flex-shrink-0 bg-primary text-white rounded-3 p-2 me-3">
                          <i class="fa-solid fa-comments fs-4"></i>
                        </div>
                        <h5 class="fw-bold text-primary mb-0">‡∏™‡∏£‡∏∏‡∏õ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏à‡∏±‡∏î‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ</h5>
                      </div>

                      <div class="card border-0 shadow-sm rounded-4 overflow-hidden mb-3">
                        <div class="table-responsive">
                          <table class="table table-hover mb-0">
                            <thead class="bg-primary text-white">
                              <tr>
                                <th class="py-3 ps-4 text-center" width="8%">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                                <th class="py-3" width="40%">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏à‡∏±‡∏î‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≠‡πÑ‡∏õ</th>
                                <th class="py-3" width="52%">‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</th>
                              </tr>
                            </thead>
                            <tbody>
                              <!-- ‡πÉ‡∏ä‡πâ paginatedComments ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ -->
                              <tr v-for="(item, idx) in paginatedComments" :key="'msg_'+idx">
                                <td class="text-center fw-bold text-muted">
                                  {{ ((currentPageSummary - 1) * itemsPerPageSummary) + idx + 1 }}
                                </td>
                                <td class="py-3">
                                  <div class="fw-600 text-dark"><i class="fa-solid fa-lightbulb text-warning me-2"></i> {{ item.topic }}</div>
                                </td>
                                <td class="py-3">
                                  <div class="text-muted italic" style="font-size: 0.9rem;"><i class="fa-solid fa-comment-dots me-2 opacity-50"></i> {{ item.feedback }}</div>
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>

                        <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (Pagination) -->
                        <div v-if="totalPagesSummary > 1" class="d-flex flex-column flex-md-row justify-content-between align-items-center px-4 py-3 bg-light border-top gap-3">
                          <div class="small text-muted fw-bold">‡∏´‡∏ô‡πâ‡∏≤ {{ currentPageSummary }} / {{ totalPagesSummary }}</div>
                          <nav>
                              <ul class="pagination pagination-sm mb-0">
                                <li class="page-item" :class="{ disabled: currentPageSummary === 1 }">
                                    <a class="page-link" href="#" @click.prevent="changePageSummary(currentPageSummary - 1)"><i class="fa-solid fa-angle-left"></i></a>
                                </li>
                                <li v-for="p in totalPagesSummary" :key="p" v-show="p >= currentPageSummary - 2 && p <= currentPageSummary + 2" class="page-item" :class="{ active: currentPageSummary === p }">
                                    <a class="page-link" href="#" @click.prevent="changePageSummary(p)">{{ p }}</a>
                                </li>
                                <li class="page-item" :class="{ disabled: currentPageSummary === totalPagesSummary }">
                                    <a class="page-link" href="#" @click.prevent="changePageSummary(currentPageSummary + 1)"><i class="fa-solid fa-angle-right"></i></a>
                                </li>
                              </ul>
                          </nav>
                        </div>
                      </div>
                    </div>

                    <!-- üü¢ ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡∏≠‡∏¢‡∏π‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ summaryData) -->
                    <div v-else class="alert alert-light border-0 text-center py-4 rounded-4 shadow-sm">
                      <i class="fa-solid fa-comment-slash fa-2x mb-2 opacity-25"></i>
                      <p class="mb-0 text-muted">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</p>
                    </div>

                  </div>

                  <!-- 3. ‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏•‡∏¢ (v-else) -->
                  <div v-else class="text-center py-5 text-muted">
                    <i class="fa-solid fa-folder-open fa-3x mb-3 opacity-25"></i>
                    <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</p>
                  </div>

                </div>
              </div>
            </div>

            <!--++++ SCAN QR Code +++++-->
            <div v-if="currentView === 'scanner'" class="container py-4">
              <div class="card shadow-sm mx-auto animate__animated animate__fadeIn" style="max-width: 600px; border-radius: 20px; overflow: hidden;">
                <div class="card-header bg-primary text-white text-center py-3">
                  <h5 class="mb-0 fw-bold">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡πÅ‡∏Å‡∏ô‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô</h5>
                </div>
                
                <div class="card-body text-center p-4">
                  <div class="mb-4">
                    <label class="form-label small fw-bold text-muted text-uppercase mb-2 d-block">
                      <i class="fa-solid fa-calendar-day me-1"></i> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    </label>
                    <div class="btn-group w-100 shadow-sm rounded-pill p-1 bg-light" role="group">
                      <button type="button" class="btn rounded-pill py-2 fw-bold transition-all me-3" 
                              :class="scanDay === '1' ? 'btn-success shadow' : 'btn-light text-muted'" @click="scanDay = '1'">
                        ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 (25 ‡∏™.‡∏Ñ.)
                      </button>
                      <button type="button" class="btn rounded-pill py-2 fw-bold transition-all" 
                              :class="scanDay === '2' ? 'btn-success shadow' : 'btn-light text-muted'" @click="scanDay = '2'">
                        ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2 (26 ‡∏™.‡∏Ñ.)
                      </button>
                    </div>
                  </div>

                  <div class="row g-2">
                    <div class="col-6">
                      <button v-if="!isScanning" class="btn btn-outline-success w-100 h-100 rounded-pill shadow-sm py-2" 
                              @click="startScanner" :disabled="loadingScanner || loadingUpload">
                        <div v-if="loadingScanner">
                          <span class="spinner-border spinner-border-sm d-block mx-auto mb-1"></span>
                          <span style="font-size: 0.85rem;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á...</span>
                        </div>
                        <div v-else>
                          <i class="fa-solid fa-camera d-block mb-1"></i>
                          <span style="font-size: 0.85rem;">‡∏™‡πÅ‡∏Å‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á</span>
                        </div>
                      </button>

                      <button v-else class="btn btn-danger w-100 h-100 rounded-pill shadow-sm py-2" :disabled="loadingScanner">
                        <div v-if="loadingScanner">
                          <span class="spinner-border spinner-border-sm d-block mx-auto mb-1"></span>
                          <span style="font-size: 0.85rem;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πÅ‡∏Å‡∏ô...</span>
                        </div>
                        <div v-else @click="stopScanner">
                          <i class="fa-solid fa-video-slash d-block mb-1"></i>
                          <span style="font-size: 0.85rem;">‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á</span>
                        </div>
                      </button>
                    </div>

                    <div class="col-6">
                      <button v-if="!isScanning" class="btn btn-outline-primary w-100 h-100 rounded-pill py-2" 
                              @click="$refs.qrFileInput.click()" :disabled="loadingUpload || loadingScanner">
                        <div v-if="loadingUpload">
                          <span class="spinner-border spinner-border-sm d-block mx-auto mb-1"></span>
                          <span style="font-size: 0.85rem;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå...</span>
                        </div>
                        <div v-else>
                          <i class="fa-solid fa-image d-block mb-1"></i>
                          <span style="font-size: 0.85rem;">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ QR</span>
                        </div>
                      </button>
                      <input type="file" ref="qrFileInput" class="d-none" accept="image/*" @change="handleQrUpload">
                    </div>
                  </div>
                  
                  <!-- ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡πÅ‡∏Å‡∏ô Qr code ‡πÅ‡∏•‡∏∞ ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î -->
                  <div v-show="isScanning  && !loadingScanner" class="scanner-container mt-3 shadow-inner" 
                      style="width: 100%; min-height: 450px; border-radius: 12px; overflow: hidden;">
                      <div id="reader" style="width: 100%;"></div>
                  </div>

                  <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
                  <div v-if="scannedUser" class="mt-4 animate__animated animate__zoomIn">
                    <div class="card border-0 shadow-lg rounded-4 overflow-hidden">
                      <div class="card-header bg-success text-white py-2 px-3 d-flex justify-content-between align-items-center">
                        <span class="small fw-bold"><i class="fa-solid fa-user-check me-2"></i>‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</span>
                        <button class="btn-close btn-close-white" @click="scannedUser = null" style="font-size: 0.7rem;"></button>
                      </div>
                      <div class="card-body p-3 text-start">
                        <div class="d-flex flex-column flex-sm-row align-items-center align-items-sm-start gap-3">
                          <div class="flex-shrink-0">
                            <img v-if="scannedUser[COL.IMAGE] && scannedUser[COL.IMAGE] !== '-'" 
                                :src="scannedUser[COL.IMAGE]" 
                                class="rounded-circle border border-2 border-success shadow-sm" 
                                style="width: 80px; height: 80px; object-fit: cover; aspect-ratio: 1 / 1;">
                            <div v-else class="rounded-circle bg-light d-flex align-items-center justify-content-center border" style="width: 80px; height: 80px;">
                              <i class="fa-solid fa-user text-muted fa-2x"></i>
                            </div>
                          </div>
                          <div class="text-center text-sm-start w-100">
                            <h6 class="fw-bold mb-1 text-dark">{{ scannedUser[COL.TITLE] }}{{ scannedUser[COL.FNAME] }} {{ scannedUser[COL.LNAME] }}</h6>
                            <div class="badge bg-primary-subtle text-primary rounded-pill mb-2">ID: {{ scannedUser[COL.ID] }}</div>
                            <div class="text-muted small lh-sm">
                              <span v-if="scannedUser[COL.REG_TYPE] === REG_STATUS.INTERNAL">
                                <i class="fa-solid fa-hospital me-1"></i>{{ scannedUser[COL.DEPARTMENT] }} ({{ scannedUser[COL.WORK_GROUP] }})
                              </span>
                              <span v-else>
                                <i class="fa-solid fa-building me-1"></i> {{ scannedUser[COL.WORKPLACE] }}
                              </span>
                            </div>
                          </div>
                        </div>
                        <div class="mt-3 p-3 bg-light rounded-4 border-start border-4 border-success shadow-sm">
                          <div class="row g-3">
                            <div class="col-12 border-bottom pb-2">
                              <div class="d-flex justify-content-between align-items-center">
                                <div><span class="tiny-label d-block">‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</span><span class="fw-bold">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà {{ scanDay }}</span></div>
                                <div class="text-end"><span class="tiny-label d-block">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span><span class="fw-bold text-success">{{ formatThaiDate(scanDay == 1 ? scannedUser[COL.ATTEND_1_TIME] : scannedUser[COL.ATTEND_2_TIME], true) }}</span></div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

          </div>

          <!-- Footer -->
          <footer class="text-center text-muted small pb-5">
            <p>¬© 2026 ‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå ‡∏™‡∏†‡∏≤‡∏Å‡∏≤‡∏ä‡∏≤‡∏î‡πÑ‡∏ó‡∏¢<br>Developed by ‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡∏ó‡∏≠‡∏á</p>
          </footer>

          <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Admin) -->
          <div class="modal fade" id="adminEditModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
            <div class="modal-dialog modal-dialog-centered" style="max-width: 90%;">
              <div class="modal-content border-0 shadow-lg rounded-4 overflow-hidden">

                <!-- Header: ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏°‡πÅ‡∏•‡∏∞‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ä‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô -->
                <div class="modal-header bg-primary text-white border-0 py-3">
                  <h5 class="modal-title fw-bold">
                    <i class="fa-solid fa-user-pen me-2"></i>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà {{editForm?.rowNumber || '-'}})
                  </h5>
                  <div class="ms-auto me-3">
                    <span class="badge rounded-pill bg-white text-primary px-3 shadow-sm">
                      ID: {{ editForm.id || '-' }}
                    </span>
                  </div>
                  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body p-0">
                  <div class="row g-0">
                    
                    <!-- ‡∏ù‡∏±‡πà‡∏á‡∏ã‡πâ‡∏≤‡∏¢: ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Sidebar) -->
                    <div class="col-lg-4 bg-light border-end p-4">
                      <div class="text-center">
                        <div class="position-relative mb-3">
                          <img v-if="editForm.profileImageUrl && editForm.profileImageUrl !== '-'"
                              :src="editForm.profileImageUrl"
                              class="rounded-circle border border-4 border-white shadow"
                              style="width: 180px; height: 180px; object-fit: cover; cursor: pointer;"
                              @click="openSpeakerModal({ img: editForm.profileImageUrl, name: editForm.title_Name + editForm.firstName + ' ' + editForm.lastName, dept: editForm.status_Register }, '‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå')">
                          
                          <div v-else class="rounded-circle bg-white border border-4 border-white shadow d-flex align-items-center justify-content-center mx-auto"
                              style="width: 180px; height: 180px;">
                            <i class="fa-solid fa-user-nurse fa-4x text-muted opacity-25"></i>
                          </div>
                        </div>

                        <span class="badge bg-primary px-3 py-2 mb-3 shadow-sm">{{ editForm.status_Register }}</span>
                        
                        <div class="p-3 bg-white rounded-4 shadow-sm text-start mb-3">
                          <label class="small fw-bold text-primary mb-1 d-block"><i class="fa-solid fa-clock me-1"></i> ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</label>
                          <div class="small text-dark fw-bold">{{ formatThaiDate(editForm.timestamp, true) }}</div>
                        </div>

                        <div class="p-3 bg-white rounded-4 shadow-sm text-start">
                          <label class="small fw-bold text-primary mb-2 d-block"><i class="fa-solid fa-utensils me-1"></i> ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏≠‡∏≤‡∏´‡∏≤‡∏£</label>
                          <select v-model="editForm.foodType" class="form-select border-2 border-primary-subtle fw-bold">
                            <option value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
                            <option value="‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏¥‡∏™‡∏•‡∏≤‡∏°">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏¥‡∏™‡∏•‡∏≤‡∏°</option>
                          </select>
                        </div>
                      </div>
                    </div>

                    <!-- ‡∏ù‡∏±‡πà‡∏á‡∏Ç‡∏ß‡∏≤: ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (Main Form) -->
                    <div class="col-lg-8 p-4 bg-white">
                      <form @submit.prevent="submitAdminEdit">
                        <div class="row g-3">
                          
                          <!-- Section: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
                          <div class="col-12">
                            <h6 class="fw-bold text-primary border-bottom border-2 pb-2 mb-3">
                              <i class="fa-solid fa-circle-info me-2"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
                            </h6>
                          </div>

                          <div class="col-md-3">
                            <label class="form-label small fw-bold text-muted">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
                            <select v-model="editForm.title_Name" class="form-select border-2 shadow-sm">
                              <option v-for="opt in prefixOptions" :value="opt">{{opt}}</option>
                            </select>
                          </div>

                          <div class="col-md-4">
                            <label class="form-label small fw-bold text-muted">‡∏ä‡∏∑‡πà‡∏≠</label>
                            <input type="text" v-model="editForm.firstName" @input="formatName('firstName', true)" class="form-control border-2 shadow-sm" required>
                          </div>

                          <div class="col-md-5">
                            <label class="form-label small fw-bold text-muted">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                            <input type="text" v-model="editForm.lastName" @input="formatName('lastName', true)" class="form-control border-2 shadow-sm" required>
                          </div>

                          <!-- Contact Info -->
                          <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                            <div class="input-group">
                              <span class="input-group-text bg-white border-2 text-primary"><i class="fa-solid fa-envelope"></i></span>
                              <input type="email" v-model="editForm.email" class="form-control border-2 shadow-sm" @input="formatEmail(true)">
                            </div>
                          </div>

                          <div class="col-md-3">
                            <label class="form-label small fw-bold text-muted">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ø</label>
                            <input type="text" v-model="editForm.proLicense" class="form-control border-2 shadow-sm" maxlength="10" @input="formatLicense">
                          </div>

                          <div class="col-md-3">
                            <label class="form-label small fw-bold text-muted">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                            <input type="text" v-model="editForm.phoneNumber" class="form-control border-2 shadow-sm" maxlength="12" @input="formatPhone">
                          </div>

                          <!-- Section: ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î/‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà -->
                          <div class="col-12 mt-4">
                            <h6 class="fw-bold text-primary border-bottom border-2 pb-2 mb-3">
                              <i class="fa-solid fa-hospital me-2"></i>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà
                            </h6>
                          </div>

                          <!-- ‡∏Å‡∏£‡∏ì‡∏µ‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô -->
                          <template v-if="editForm.status_Register === REG_STATUS.INTERNAL">
                            <div class="col-md-4">
                              <label class="form-label small fw-bold text-muted">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label>
                              <select v-model="editForm.internalPosition" class="form-select border-2 shadow-sm">
                                <option v-for="opt in professionOptions" :value="opt">{{opt}}</option>
                              </select>
                            </div>
                            <div class="col-md-4">
                              <label class="form-label small fw-bold text-muted">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô</label>
                              <select v-model="editForm.workGroup" class="form-select border-2 shadow-sm">
                                <option v-for="(depts, group) in workGroupData" :value="group">{{group}}</option>
                              </select>
                            </div>
                            <div class="col-md-4">
                              <label class="form-label small fw-bold text-muted">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
                              <select v-model="editForm.department" class="form-select border-2 shadow-sm">
                                <option v-for="opt in workGroupData[editForm.workGroup]" :value="opt">{{opt}}</option>
                              </select>
                            </div>
                          </template>

                          <!-- ‡∏Å‡∏£‡∏ì‡∏µ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å (Address Parsing) -->
                          <template v-else>
                            <div class="col-12">
                              <div class="p-3 bg-light rounded-4 border-2 border-dashed">
                                <div class="row g-3">
                                  <div class="col-12">
                                    <label class="form-label small fw-bold text-primary">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏Å (‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà / ‡∏ã‡∏≠‡∏¢ / ‡∏ñ‡∏ô‡∏ô)</label>
                                    <input type="text" v-model="editForm.address_main" class="form-control border-2 shadow-sm bg-white" @blur="cleanAdminAddress">
                                  </div>
                                  <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">‡∏ï‡∏≥‡∏ö‡∏• / ‡πÅ‡∏Ç‡∏ß‡∏á</label>
                                    <input type="text" id="admin_subdistrict" v-model="editForm.address_subdistrict" class="form-control border-2 shadow-sm bg-white">
                                  </div>
                                  <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ / ‡πÄ‡∏Ç‡∏ï</label>
                                    <input type="text" id="admin_district" v-model="editForm.address_district" class="form-control border-2 shadow-sm bg-white">
                                  </div>
                                  <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
                                    <input type="text" id="admin_province" v-model="editForm.address_province" class="form-control border-2 shadow-sm bg-white">
                                  </div>
                                  <div class="col-md-6">
                                    <label class="form-label small fw-bold text-muted">‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</label>
                                    <input type="text" id="admin_postcode" v-model="editForm.address_postcode" class="form-control border-2 shadow-sm bg-white">
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="col-md-12 mt-2">
                              <label class="form-label small fw-bold text-muted">‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏†‡∏≤‡∏©‡∏µ</label>
                              <input type="text" v-model="editForm.taxpayer_ID" class="form-control border-2 shadow-sm" @input="formatTaxID">
                            </div>
                          </template>

                          <!-- Buttons -->
                          <div class="col-12 text-end mt-4 pt-3 border-top">
                            <button type="button" class="btn btn-outline-secondary rounded-pill px-4 me-2" data-bs-dismiss="modal">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            <button type="submit" class="btn btn-primary rounded-pill px-5 shadow" :disabled="loading || isFormUnchanged">
                              <span v-if="loading" class="spinner-border spinner-border-sm me-2"></span>
                              <i v-else class="fa-solid fa-floppy-disk me-2"></i>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                            </button>
                          </div>

                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏≠‡∏ö‡∏£‡∏π‡∏õ -->
    <div class="modal fade" id="cropModal" tabindex="-1" data-bs-backdrop="static">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow-lg rounded-4">
          <div class="modal-header bg-primary text-white">
            <h5 class="modal-title"><i class="fa-solid fa-crop me-2"></i>‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á/‡∏Ñ‡∏£‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</h5>
          </div>
          <div class="modal-body p-0" style="background: #eee;">
            <div style="max-height: 400px; overflow: hidden;">
              <img id="imageToCrop" style="max-width: 100%; display: block;">
            </div>
          </div>
          <div class="modal-footer justify-content-center border-0 p-3">
            <button type="button" class="btn btn-outline-secondary rounded-pill px-4" @click="cancelCrop">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            <button type="button" class="btn btn-success rounded-pill px-4" @click="applyCrop">
              <i class="fa-solid fa-check-circle me-1"></i> ‡∏ï‡∏Å‡∏•‡∏á‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡∏ô‡∏µ‡πâ
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Scroll Buttons -->
    <div class="scroll-buttons-container">
      <button @click="scrollToTop" class="btn-scroll shadow" title="‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î">
        <i class="fa-solid fa-chevron-up"></i>
      </button>
      <button @click="scrollToBottom" class="btn-scroll shadow" title="‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏á‡∏•‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏î">
        <i class="fa-solid fa-chevron-down"></i>
      </button>
    </div>

  </div>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <script src="https://unpkg.com/webcam-easy/dist/webcam-easy.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.11.0/dist/sweetalert2.all.min.js"></script>
  
  <!-- Vue 3 -->
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>

  <!-- ThailandJS Libs -->
  <script src="https://earthchie.github.io/jquery.Thailand.js/jquery.Thailand.js/dependencies/JQL.min.js"></script>
  <script src="https://earthchie.github.io/jquery.Thailand.js/jquery.Thailand.js/dependencies/typeahead.bundle.js"></script>
  <script src="https://earthchie.github.io/jquery.Thailand.js/jquery.Thailand.js/dist/jquery.Thailand.min.js"></script>
  <!-- Charts JS -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>

  <script>
    const { createApp, ref, onMounted, computed, watch } = Vue;

    // üõë ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç URL ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Google Apps Script (Deploy > Web App)
    const GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzfOu3S0v5_u0XJi-IdwTIx6HecySKswYFt05wjfCBbu5pyEYy2LPsFSUkL7d4dmdVK/exec";

    /**
     * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ Backend (Google Apps Script) ‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å
     */
    async function callGAS(action, data = {}) {
        try {
        // ‡πÉ‡∏ä‡πâ fetch ‡∏™‡πà‡∏á POST request
        const response = await fetch(GAS_WEB_APP_URL, {
            method: "POST",
            body: JSON.stringify({ action, data }),
        });
        const result = await response.json();
        if (!result.success && result.message) {
            console.error("GAS Error:", result.message);
        }
        return result;
        } catch (error) {
        console.error("Fetch Error:", error);
        return { success: false, message: "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ: " + error.toString() };
        }
    }

    createApp({
      setup() {
        const OPTIONAL_POSITIONS = ['‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£', '‡∏Ñ‡∏ì‡∏∞‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏Ø', '‡∏û‡∏¥‡∏ò‡∏µ‡∏Å‡∏£', '‡∏≠‡∏∑‡πà‡∏ô‡πÜ']; // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á
        const step = ref(1);
        const loading = ref(false);
        const loadingScanner = ref(false);
        const loadingUpload = ref(false);
        const workGroupData = ref({});
        const currentDepts = ref([]);
        const prefixOptions = ref([]); // ‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤
        const affiliationOptions = ref([]); // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î
        const professionOptions = ref([]); // ‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
        const errors = ref({});
        const originalForm = ref(null); // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏π‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
        const showPassword = ref(false);

        const form = ref({
          rowNumber: null, // üü¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏•‡∏Ç‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
          timestamp: '',
          email: '',
          title_Name: '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß',
          firstName: '',
          lastName: '',
          phoneNumber: '',
          proLicense: '',
          foodType: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',
          status_Register: '',
          internalPosition: '‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',
          workGroup: '',
          workGroup_OtherText: '',
          department: '',
          department_OtherText: '',
          affiliation: '',
          affiliation_otherText: '',
          workPlace: '',
          externalPosition: '‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',
          externalPosition_OtherText: '',
          name_Receipt: '',
          address: '',
          address_subdistrict: '',
          address_district: '',
          address_province: '',
          address_postcode: '',
          taxpayer_ID: '',
          slipImage: null // ‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
        });

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Init ThailandJS ‡πÅ‡∏¢‡∏Å‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
        const initThailandJS = () => {
          setTimeout(() => {
            if (typeof $.Thailand !== 'undefined' && $("#sub_district").length) {
              $.Thailand({
                $district: $("#sub_district"),
                $amphoe: $("#district"),
                $province: $("#province"),
                $zipcode: $("#postcode"),
                onDataFill: (data) => {
                  form.value.address_subdistrict = data.district;
                  form.value.address_district = data.amphoe;
                  form.value.address_province = data.province;
                  form.value.address_postcode = data.zipcode;
                  
                  // Trigger input event ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Vue
                  ['sub_district', 'district', 'province', 'postcode'].forEach(id => {
                    document.getElementById(id).dispatchEvent(new Event('input', { bubbles: true }));
                  });
                }
              });
            }
          }, 100); // ‡∏£‡∏≠‡πÉ‡∏´‡πâ DOM ‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏™‡∏£‡πá‡∏à
        };

        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        const currentView = ref('form'); // 'form' ‡∏´‡∏£‡∏∑‡∏≠ 'search'
        const searchQuery = ref('');
        const searchResult = ref(null);
        const isEditMode = ref(false); // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏´‡∏°‡∏î‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
        const handleSearch = () => {
          if (!searchQuery.value) return Swal.fire("‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô", "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤", "warning");
          
          loading.value = true;
          searchResult.value = null; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏´‡∏°‡πà

          google.script.run
            .withSuccessHandler((res) => {
              loading.value = false;
              if (res && res.success) {
                searchResult.value = res.data;

                // üü¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏≠‡∏•‡∏á‡∏°‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                setTimeout(() => {
                  const element = document.getElementById('search-result-section');
                  if (element) {
                    // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏ö‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á‡∏à‡∏≠‡πÅ‡∏ö‡∏ö‡∏ô‡∏∏‡πà‡∏°‡∏ô‡∏ß‡∏•
                    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                  }
                }, 100); // ‡∏£‡∏≠‡πÉ‡∏´‡πâ Vue ‡∏ß‡∏≤‡∏î‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏•‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢

              } else {
                Swal.fire({
                  icon: 'info',
                  title: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                  text: res ? res.message : "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏",
                  confirmButtonColor: '#004085'
                });
              }
            })
            .withFailureHandler((err) => {
              loading.value = false;
              Swal.fire("‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏£‡∏∞‡∏ö‡∏ö", err.message, "error");
            })
            .searchUser(searchQuery.value);
        };

        // ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
        watch(() => form.value.status_Register, (newVal) => {
          if (newVal === REG_STATUS.EXTERNAL) {
            initThailandJS(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å"
          }
        });

        //==== Load Data on Start ========
        onMounted(() => {
          loadCertDeadline(); // ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£

          // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏¥‡∏î‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
          google.script.run
              .withSuccessHandler(time => { externalDeadline.value = time; })
              .getExternalDeadline();

          // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Browser LINE ---
          const ua = navigator.userAgent || navigator.vendor || window.opera;
          const isLine = (ua.indexOf("Line") > -1);

          if (isLine) {
            Swal.fire({
              title: '‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô',
              html: `‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô LINE ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ<b>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ</b>‡πÑ‡∏î‡πâ<br><br>
                    <b>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</b><br>
                    1. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô <i class="fa-solid fa-ellipsis"></i> ‡∏´‡∏£‡∏∑‡∏≠ <i class="fa-solid fa-compass"></i> ‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏à‡∏≠<br>
                    2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å <b>"‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏≠‡∏∑‡πà‡∏ô"</b> (Open in Browser)`,
              icon: 'warning',
              confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
              confirmButtonColor: '#004085'
            });
          }
          // --- ‡∏à‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö LINE ---

          // üü¢ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£ Login ‡∏à‡∏≤‡∏Å localStorage
          const savedSession = localStorage.getItem('nursing_admin_session');
          if (savedSession) {
            const sessionData = JSON.parse(savedSession);
            isAdminLoggedIn.value = true;
            login.value.user = sessionData.user;
            userRole.value = sessionData.role;
            currentView.value = 'dashboard'; // ‡πÉ‡∏´‡πâ‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ Admin ‡πÄ‡∏•‡∏¢
            loadAdminTable(); // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≠‡πÑ‡∏ß‡πâ‡πÄ‡∏•‡∏¢
          }

          // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô
          google.script.run.withSuccessHandler((data) => {
            workGroupData.value = data;
          }).getWorkGroupData();
          // --- ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î ---
          google.script.run.withSuccessHandler((data) => {
            affiliationOptions.value = data;
          }).getAffiliationData();
          // --- ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á ---
          google.script.run.withSuccessHandler((data) => {
            professionOptions.value = data;
          }).getProfessionData();
          // ‡∏á--- ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ ---
          google.script.run.withSuccessHandler((data) => {
            prefixOptions.value = data;
          }).getPrefixData();

          // ‡∏£‡∏≠‡πÉ‡∏´‡πâ Vue ‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå DOM ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏Å $.Thailand
          setTimeout(() => {
            if (typeof $.Thailand !== 'undefined') {
              $.Thailand({
                $district: $("#sub_district"),
                $amphoe: $("#district"),
                $province: $("#province"),
                $zipcode: $("#postcode"),
                onDataFill: (data) => {
                  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡πà‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ Vue ‡∏ï‡∏£‡∏á‡πÜ
                  form.value.address_subdistrict = data.district;
                  form.value.address_district = data.amphoe;
                  form.value.address_province = data.province;
                  form.value.address_postcode = data.zipcode;
                  
                  // 2. ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô Event ‡πÉ‡∏´‡πâ Vue ‡∏£‡∏π‡πâ‡∏ï‡∏±‡∏ß (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)
                  const fields = ['sub_district', 'district', 'province', 'postcode'];
                  fields.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) {
                      el.dispatchEvent(new Event('input', { bubbles: true }));
                    }
                  });
                }
              });
            }
          }, 500); // ‡∏£‡∏≠ 0.5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡πÅ‡∏•‡∏∞ DOM ‡∏û‡∏£‡πâ‡∏≠‡∏°

          const modalEl = document.getElementById('cropModal');
          if (modalEl) {
            cropModal.value = new bootstrap.Modal(modalEl);
          }

        });

        const onWorkGroupChange = () => {
          currentDepts.value = workGroupData.value[form.value.workGroup] || [];
          form.value.department = '';
        };

        const formatPhone = (e) => {
          // 1. ‡∏î‡∏∂‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
          let val = e.target.value.replace(/\D/g, "");
          
          // 2. ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10 ‡∏´‡∏•‡∏±‡∏Å
          if (val.length > 10) val = val.substring(0, 10);
          
          // 3. ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß
          let formatted = "";
          if (val.length <= 3) {
            formatted = val;
          } else if (val.length <= 6) {
            // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 000-000
            formatted = val.slice(0, 3) + "-" + val.slice(3);
          } else {
            // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 000-000-0000
            formatted = val.slice(0, 3) + "-" + val.slice(3, 6) + "-" + val.slice(6);
          }
          
          // üü¢ ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏ô Modal ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ admin‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢
          const isAdminEdit = document.getElementById('adminEditModal')?.classList.contains('show');
          if (isAdminEdit) {
            editForm.value.phoneNumber = formatted;
          } else {
            form.value.phoneNumber = formatted;
          }
        };

        const formatLicense = (e) => {
          form.value.proLicense = e.target.value.replace(/\D/g, "").slice(0, 10);

          // üü¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ admin‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢
          const isAdminEdit = document.getElementById('adminEditModal')?.classList.contains('show');
          if (isAdminEdit) {
            editForm.value.proLicense = val;
          } else {
            form.value.proLicense = val;
          }
        };

        const formatTaxID = (e) => {
          let val = e.target.value.replace(/\D/g, "");
          let formatted = "";
          if (val.length > 0) formatted += val[0];
          if (val.length > 1) formatted += "-" + val.slice(1, 5);
          if (val.length > 5) formatted += "-" + val.slice(5, 10);
          if (val.length > 10) formatted += "-" + val.slice(10, 12);
          if (val.length > 12) formatted += "-" + val[12];

          // üü¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ admin‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢
          const isAdminEdit = document.getElementById('adminEditModal')?.classList.contains('show');
          if (isAdminEdit) {
            editForm.value.taxpayer_ID = formatted;
          } else {
            form.value.taxpayer_ID = formatted;
          }
        };

        const copyName = () => {
          form.value.name_Receipt = `${form.value.title_Name}${form.value.firstName} ${form.value.lastName}`;
          Swal.fire({ icon: 'success', title: '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß', timer: 800, showConfirmButton: false });
        };

        const goToSummary = () => {
          const f = form.value;
          let errorMsg = "";
          
          // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤ Error ‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
          errors.value = {};
          const isOptional = OPTIONAL_POSITIONS.includes(f.internalPosition); // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
          if (!isOptional && !f.email) errorMsg = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•";
          else if (!f.firstName) errorMsg = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠";
          else if (!f.lastName) errorMsg = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•";
          else if (!isOptional && !f.phoneNumber) errorMsg = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå";
          else if (!f.status_Register) errorMsg = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô";

          // --- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ---
          
          // ‡∏Å‡∏£‡∏ì‡∏µ: ‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô
          if (f.status_Register === REG_STATUS.INTERNAL) {
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ (‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á) ‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            if (!OPTIONAL_POSITIONS.includes(f.internalPosition) && !f.internalPosition) {
              errorMsg = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô";
            }

            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
            // ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏´‡πâ‡∏Ñ‡∏á Code ‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏ß‡πâ‡∏Ñ‡∏£‡∏±‡∏ö:
            if (!OPTIONAL_POSITIONS.includes(f.internalPosition)) {
                if (!f.workGroup) errorMsg = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô";
                if (!f.department) errorMsg = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô";
            }
          }

          // ‡∏Å‡∏£‡∏ì‡∏µ: ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å
          if (f.status_Register === REG_STATUS.EXTERNAL) {
            if (!OPTIONAL_POSITIONS.includes(f.externalPosition) && !f.externalPosition) {
              errorMsg = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á";
            }
          }

          // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ñ‡πâ‡∏≤‡∏°‡∏µ Error
          if (errorMsg) {
            Swal.fire({
              icon: 'warning',
              title: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô',
              text: errorMsg,
              confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
              confirmButtonColor: '#004085'
            });
            return;
          }          
          step.value = 2;

          setTimeout(() => {
            const element = document.getElementById('summary-content');
            if (element) {
              // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡∏Ç‡∏≠‡∏ö‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏™‡∏£‡∏∏‡∏õ ‡∏°‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏ö‡∏ö‡∏ô‡∏Ç‡∏≠‡∏á‡∏à‡∏≠‡∏û‡∏≠‡∏î‡∏µ
              // ‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ inline: 'nearest' ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°
              element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
          }, 100); // ‡∏£‡∏≠ 0.1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÉ‡∏´‡πâ Vue ‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô
        };
        
        const resetForm = () => {
          // üü¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠ Reset ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
          if (webcam) webcam.stop();    // ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á
          isCameraActive.value = false; // ‡∏õ‡∏¥‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
          profilePreview.value = null;  // ‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ñ‡πà‡∏≤‡∏¢‡πÑ‡∏ß‡πâ
          cameraZoom.value = 1.0;       // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏¢‡∏∞‡∏ã‡∏π‡∏°

          // 1. ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å (Step 1)
          step.value = 1;
          isEditMode.value = false; 

          // 2. ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
          form.value = {
            id: null,
            rowNumber: null,
            email: '',
            title_Name: '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß',
            firstName: '',
            lastName: '',
            phoneNumber: '',
            proLicense: '',
            foodType: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ',
            status_Register: '',
            internalPosition: '‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',
            workGroup: '',
            department: '',
            affiliation: '',
            affiliation_otherText: '',
            workPlace: '',
            externalPosition: '‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',
            externalPosition_OtherText: '',
            name_Receipt: '',
            address: '',
            address_subdistrict: '',
            address_district: '',
            address_province: '',
            address_postcode: '',
            taxpayer_ID: ''
          };

          // 3. ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ‡∏ö‡∏ô‡∏™‡∏∏‡∏î
          // ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏û‡πâ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà SweetAlert2 ‡∏Å‡∏≥‡∏•‡∏±‡∏á Lock ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏Ç‡∏ì‡∏∞‡∏õ‡∏¥‡∏î Modal
          setTimeout(() => {
            window.scrollTo({ 
              top: 400, 
              behavior: 'smooth' 
            });
          }, 300); // ‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ 0.3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ñ‡∏£‡∏±‡∏ö
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (Mapping ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Sheet ‡∏•‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°)
        const prepareEdit = (item) => {
          if (!item) return;

          try {
            form.value.id = item[COL.ID];
            form.value.rowNumber = item.rowNumber;
            form.value.timestamp = item[COL.TIMESTAMP];

            // --- 1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô ---
            form.value.email = item[COL.EMAIL] || '';
            form.value.title_Name = item[COL.TITLE] || '‡∏û‡∏ß.';
            form.value.firstName = item[COL.FNAME] || '';
            form.value.lastName = item[COL.LNAME] || '';
            form.value.phoneNumber = item[COL.PHONE] || '';
            form.value.proLicense = item[COL.LICENSE] || '';
            form.value.status_Register = item[COL.REG_TYPE] || '';
            form.value.foodType = item[COL.FOOD] || '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ';

            // --- 2. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏¢‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà (Address Parsing) ‡πÅ‡∏ö‡∏ö‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ã‡πâ‡∏≥ ---
            const fullAddr = String(item[COL.ADDRESS] || '').trim();
            
            if (fullAddr.includes(' ‡∏ï.')) {
              // ‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ñ‡∏π‡∏Å‡∏£‡∏ß‡∏°‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÅ‡∏¢‡∏Å‡∏≠‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ã‡πâ‡∏≥
              const mainAddrPart = fullAddr.split(' ‡∏ï.')[0].trim();
              form.value.address = mainAddrPart; // ‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà/‡∏ñ‡∏ô‡∏ô

              const parts = fullAddr.split(' ');
              if (parts.length >= 4) {
                form.value.address_postcode = parts.pop();
                form.value.address_province = parts.pop().replace(/^‡∏à\./, "");
                form.value.address_district = parts.pop().replace(/^‡∏≠\./, "");
                form.value.address_subdistrict = parts.pop().replace(/^‡∏ï\./, "");
              }
            } else {
              // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô ‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡∏ä‡πà‡∏≠‡∏á address ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô
              form.value.address = fullAddr;
              form.value.address_subdistrict = '';
              form.value.address_district = '';
              form.value.address_province = '';
              form.value.address_postcode = '';
            }

            // --- 3. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î/‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ---
            const workplace = String(item[COL.WORKPLACE] || '').trim();

            if (form.value.status_Register === REG_STATUS.INTERNAL) {
              form.value.internalPosition = item[COL.POSITION] || '';
              form.value.workGroup = item[COL.WORK_GROUP] || '';              
              onWorkGroupChange(); 
              form.value.department = item[COL.DEPARTMENT] || ''; 
            } 
            else {
              let affBase = '';
              let affOther = '';

              if (workplace.includes('(3 ‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡πÉ‡∏ï‡πâ)')) {
                affBase = '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏≤‡∏Å 3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ';
                affOther = workplace.replace('(3 ‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡πÉ‡∏ï‡πâ)', '').trim();
              } 
              else if (affiliationOptions.value.includes(workplace)) {
                affBase = workplace;
                affOther = '';
              } 
              else {
                affBase = workplace ? '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' : '';
                affOther = workplace === '-' ? '' : workplace;
              }

              form.value.affiliation = affBase;
              form.value.affiliation_otherText = affOther;
              form.value.workPlace = workplace;
              
              if (form.value.status_Register === REG_STATUS.EXTERNAL) {
                form.value.externalPosition = item[COL.POSITION] || '';
                form.value.name_Receipt = item[COL.RECEIPT_NAME] || '';
                form.value.taxpayer_ID = item[COL.TAX_ID] || '';
              }
              form.value.slipImage = (item[COL.SLIP] && item[COL.SLIP] !== '-') ? item[COL.SLIP] : null;
            }

            // --- 4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ UI ---
            profilePreview.value = item[COL.IMAGE] !== '-' ? item[COL.IMAGE] : null;
            isEditMode.value = true;
            step.value = 1;
            searchResult.value = null;
            searchQuery.value = '';

            setTimeout(() => {
              window.scrollTo({ top: 400, behavior: 'smooth' });
            }, 100);

            Swal.fire({
              icon: 'success',
              title: '‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
              text: `‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß`,
              timer: 1500,
              showConfirmButton: false
            });

          } catch (error) {
            console.error("Mapping Error: ", error);
            Swal.fire("Error", "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÑ‡∏î‡πâ", "error");
          }
        };

        // ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó)
        const submitForm = () => {
          loading.value = true;

          // ‡∏™‡∏£‡πâ‡∏≤‡∏á Payload ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ (UI)
          const payload = JSON.parse(JSON.stringify(form.value));

          // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏µ‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Sheet ‡πÑ‡∏î‡πâ
          payload.profilePreview = profilePreview.value || "-"; 

          // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏•‡∏¥‡∏õ ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô "-"
          if (payload.status_Register === REG_STATUS.EXTERNAL && !payload.slipImage) {
            payload.slipImage = "-";
          }
          
          // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Å‡∏£‡∏≠‡∏Å (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏û‡∏¥‡πÄ‡∏®‡∏©)
          if (!payload.email || payload.email.trim() === "") {
            payload.email = "-";
          }

          // --- 1. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î (Affiliation / Workplace) ---
          // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Dropdown (affiliation) ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡∏ñ‡∏≠‡∏¢‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏° (workPlace)
          let affBase = payload.affiliation || payload.workPlace || "";
          let finalWorkplace = affBase;

          if (affBase === '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏≤‡∏Å 3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ') {
            // ‡∏£‡∏ß‡∏°‡∏£‡πà‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠ ‡∏£‡∏û. ‡∏Å‡∏±‡∏ö Tag ‡∏û‡∏¥‡πÄ‡∏®‡∏©
            finalWorkplace = `${payload.affiliation_otherText || ''} (3 ‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡πÉ‡∏ï‡πâ)`.trim();
          } else if (affBase === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
            // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á
            finalWorkplace = payload.affiliation_otherText || "-";
          }

          // ‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡πâ‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Sheet
          payload.workPlace = finalWorkplace;

          // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à (‡∏Å‡∏£‡∏ì‡∏µ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å)
          if (payload.status_Register === REG_STATUS.EXTERNAL) {
            let baseAddr = payload.address || "";
            let sub = payload.address_subdistrict || "";
            let dist = payload.address_district || "";
            let prov = payload.address_province || "";
            let post = payload.address_postcode || "";

            // üü¢ ‡∏•‡∏≠‡∏à‡∏¥‡∏Å‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î: ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ô baseAddr ‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö ‡∏ï‡∏≥‡∏ö‡∏•/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏î‡∏ó‡∏¥‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏´‡∏°‡∏î
            const cleanPattern = [sub, dist, prov, post, `‡∏ï.${sub}`, `‡∏≠.${dist}`, `‡∏à.${prov}`];
            cleanPattern.forEach(text => {
              if (text && text.length > 1) {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏ö‡∏ó‡∏¥‡πâ‡∏á
                let regex = new RegExp(text, "g");
                baseAddr = baseAddr.replace(regex, "");
              }
            });

            // ‡∏•‡πâ‡∏≤‡∏á‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏≠‡∏≠‡∏Å
            baseAddr = baseAddr.replace(/‡∏ï\.|‡∏≠\.|‡∏à\./g, "").trim();

            // ‡∏£‡∏ß‡∏°‡∏£‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏™‡∏∞‡∏≠‡∏≤‡∏î 100%
            const fullAddr = [
              baseAddr, 
              sub ? '‡∏ï.' + sub : '',
              dist ? '‡∏≠.' + dist : '',
              prov ? '‡∏à.' + prov : '',
              post
            ].filter(p => p && String(p).trim() !== "").join(' ');
            
            payload.address = fullAddr;
          }

          // --- 2. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ---
          if (payload.status_Register === REG_STATUS.INTERNAL) {
            if (!payload.internalPosition || OPTIONAL_POSITIONS.includes(payload.internalPosition)) {
              if (!payload.internalPosition) payload.internalPosition = "-";
            }
            if (payload.internalPosition === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
              payload.internalPosition = payload.internalPosition_OtherText || "-";
            }
          }

          // --- 3. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å ---
          if (payload.status_Register === REG_STATUS.EXTERNAL) {
            if (!payload.externalPosition) payload.externalPosition = "-";
            if (payload.externalPosition === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
              payload.externalPosition = payload.externalPosition_OtherText || "-";
            }
          }

          // --- 4. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô/‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô ---
          if (!payload.workGroup || payload.workGroup === "") payload.workGroup = "-";
          if (payload.workGroup === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') payload.workGroup = payload.workGroup_OtherText || "-";

          if (!payload.department || payload.department === "") payload.department = "-";
          if (payload.department === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') payload.department = payload.department_OtherText || "-";

          // --- ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ---
          Swal.fire({
            title: isEditMode.value ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...' : '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
            text: '‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà',
            allowOutsideClick: false,
            didOpen: () => { Swal.showLoading(); }
          });

          const serverFunction = isEditMode.value ? 'updateForm' : 'processForm';

          google.script.run
            .withSuccessHandler((res) => {
              loading.value = false;
              if (res.success) {
                Swal.fire({
                  icon: 'success',
                  title: isEditMode.value ? '‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!' : '‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                  html: res.message,
                  timer: 2000
                }).then(() => {
                  resetForm();
                  currentView.value = 'form';
                });
              } else {
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥
                const isDuplicate = res.message.includes("‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß") || res.message.includes("‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö");
                if (isDuplicate) {
                  Swal.fire({
                    icon: 'warning',
                    title: '‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö',
                    text: res.message,
                    showCancelButton: true,
                    confirmButtonColor: '#004085',
                    cancelButtonColor: '#6c757d',
                    confirmButtonText: '<i class="fa-solid fa-magnifying-glass me-1"></i> ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç',
                    cancelButtonText: '‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á'
                  }).then((result) => {
                    if (result.isConfirmed) {
                      searchQuery.value = form.value.proLicense || form.value.email;
                      currentView.value = 'form';
                      handleSearch();
                    }
                  });
                } else {
                  Swal.fire('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', res.message, 'error');
                }
              }
            })
            .withFailureHandler((err) => {
              loading.value = false;
              Swal.fire('Error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ: ' + err, 'error');
            })[serverFunction](payload);
        };

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
        const registrationOptions = [
          {
            id: 's1',
            value: '‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÉ‡∏ô‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏£‡∏û.‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå',
            label: '‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÉ‡∏ô‡∏ù‡πà‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• ‡∏£‡∏û.‡∏à‡∏∏‡∏¨‡∏≤‡∏•‡∏á‡∏Å‡∏£‡∏ì‡πå'
          },
          {
            id: 's2',
            value: '‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏ä‡∏¥‡∏ç',
            label: '‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏ä‡∏¥‡∏ç'
          },
          {
            id: 's3',
            value: '‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å',
            label: '‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å'
          }
        ];

        const onDownloadClick = (rowNum) => {
          // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ GAS ‡πÑ‡∏õ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå V (‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á)
          google.script.run.trackDownload(rowNum);

          // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
          if (searchResult.value) {
            const targetItem = searchResult.value.find(i => i.rowNumber === rowNum);
            if (targetItem) {
              targetItem[COL.DOWNLOAD] = (Number(targetItem[COL.DOWNLOAD]) || 0) + 1;
            }
          }
        };

        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
        const isAdminLoggedIn = ref(false);
        const userRole = ref('');
        const adminData = ref([]);
        const adminSearch = ref(''); // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        const login = ref({ user: '', pass: '' });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Login
        const handleAdminLogin = () => {
          if (!login.value.pass) return Swal.fire("‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô", "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô", "warning");
          
          loading.value = true;
          google.script.run
            .withSuccessHandler((res) => {
              loading.value = false;
              if (res.success) {
                isAdminLoggedIn.value = true;
                login.value.user = res.username; // üü¢ ‡∏ô‡∏≥‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå B ‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á
                userRole.value = res.role;

                // üü¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á localStorage
                const adminSession = {
                  user: res.username,
                  role: res.role,
                  isLoggedIn: true
                };
                localStorage.setItem('nursing_admin_session', JSON.stringify(adminSession));

                loadAdminTable();
                Swal.fire({
                  icon: 'success',
                  title: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                  text: `‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏∏‡∏ì ${res.username}`,
                  timer: 1500, showConfirmButton: false
                });
              } else {
                Swal.fire("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á", res.message, "error");
              }
            })
            .checkAdminLogin(login.value.pass); // üü¢ ‡∏™‡πà‡∏á‡πÅ‡∏Ñ‡πà password ‡πÑ‡∏õ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
        };

        const logoutAdmin = () => {
          // üü¢ ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å localStorage
          localStorage.removeItem('nursing_admin_session');

          isAdminLoggedIn.value = false;
          login.value = { user: '', pass: '' };
          userRole.value = '';
          currentView.value = 'form';
        };

        const originalAdminData = ref([]); // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏¥‡∏ö‡∏à‡∏≤‡∏Å Server

        const loadAdminTable = () => {
          loading.value = true;
          google.script.run
            .withSuccessHandler((data) => {
              adminData.value = data;
              // üü¢ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô "‡∏Ñ‡πà‡∏≤‡∏î‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏¥‡∏°" ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö
              originalAdminData.value = JSON.parse(JSON.stringify(data)); 
              loading.value = false;
            })
            .getAdminAllData();
        };

        // üü¢ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡∏à‡∏≤‡∏Å‡πÄ‡∏î‡∏¥‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        const isRowChanged = (item) => {
          const original = originalAdminData.value.find(o => o.rowNumber === item.rowNumber);
          if (!original) return false;
          
          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
          return item[COL.PAYIN_STATUS] !== original[COL.PAYIN_STATUS] ||
                item[COL.PAYMENT_STATUS] !== original[COL.PAYMENT_STATUS] ||
                item[COL.ATTEND_1] !== original[COL.ATTEND_1] ||
                item[COL.ATTEND_2] !== original[COL.ATTEND_2];
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
        const navToAdmin = () => {
          currentView.value = 'dashboard';
          
          // üü¢ ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
          if (isAdminLoggedIn.value) {
            loadAdminTable();
          } else {
            // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô ‡πÉ‡∏´‡πâ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏¥‡πâ‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
            login.value.pass = ''; 
          }
          
          window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        // 1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏¢‡∏Å‡∏£‡∏≤‡∏¢‡πÅ‡∏ñ‡∏ß
        const savingRows = ref({}); 

        // 2. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡πà‡∏á‡πÑ‡∏õ
        const saveAdminUpdate = (item) => {
          const rowNum = item.rowNumber;
          savingRows.value[rowNum] = true;

          // 1. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (Format: 12-02-2026 13:00:00)
          const now = new Date().toLocaleString('th-TH', { 
            day: '2-digit', month: '2-digit', year: 'numeric', 
            hour: '2-digit', minute: '2-digit', second: '2-digit' 
          }).replace(/\//g, '-');

          // 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤
          // ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ô UI ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°" ‡πÅ‡∏ï‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏¢‡∏±‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÑ‡∏õ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
          let time1 = item[COL.ATTEND_1_TIME] || '';
          if (item[COL.ATTEND_1] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°' && !time1) {
            time1 = now;
            item[COL.ATTEND_1_TIME] = now; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏î‡πâ‡∏ß‡∏¢
          }

          let time2 = item[COL.ATTEND_2_TIME] || '';
          if (item[COL.ATTEND_2] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°' && !time2) {
            time2 = now;
            item[COL.ATTEND_2_TIME] = now; // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏î‡πâ‡∏ß‡∏¢
          }

          // 3. ‡∏à‡∏±‡∏î‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà Server (‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏±‡πâ‡∏á 8 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå)
          const statusArray = [
            item[COL.PAYIN_STATUS] || '', 
            item[COL.PAYMENT_STATUS] || '', 
            item[COL.ATTEND_1] || '', 
            item[COL.ATTEND_2] || '', 
            time1, 
            time2, 
            item[COL.CERT_URL] || '-',
            item[COL.DOWNLOAD] || 0
          ];

          google.script.run
            .withSuccessHandler((res) => {
              savingRows.value[rowNum] = false;
              if (res.success) {
                Swal.fire({ icon: 'success', title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', timer: 800, showConfirmButton: false });
              }
            })
            .updateAdminStatus(rowNum, statusArray);
        };

        const confirmDelete = (rowNum) => {
          Swal.fire({
            title: '‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•?',
            text: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà " + rowNum + " ‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏ñ‡∏≤‡∏ß‡∏£",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonText: '‡∏•‡∏ö‡πÄ‡∏•‡∏¢'
          }).then((result) => {
            if (result.isConfirmed) {
              google.script.run.withSuccessHandler(() => {
                Swal.fire("‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß", "", "success");
                loadAdminTable();
              }).deleteRegistration(rowNum);
            }
          });
        };

        const editForm = ref({ rowNumber: null, tiemstarmp: '' }); // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô Modal

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î Modal ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin)
        const openAdminEditModal = (item) => {
          // 1. ‡πÅ‡∏¢‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà (Format: [‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏Å] ‡∏ï.[‡∏ï‡∏≥‡∏ö‡∏•] ‡∏≠.[‡∏≠‡∏≥‡πÄ‡∏†‡∏≠] ‡∏à.[‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î] [‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå])
          const fullAddr = String(item[COL.ADDRESS] || '').trim();
          let addrMain = '';
          let sub = '', dist = '', prov = '', post = '';

          // üü¢ ‡∏•‡∏≠‡∏à‡∏¥‡∏Å‡πÅ‡∏¢‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏´‡πâ‡∏™‡∏∞‡∏≠‡∏≤‡∏î (‡∏¢‡∏∂‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏£‡∏£‡∏Ñ‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á ‡∏ï.‡∏≠.‡∏à.)
          let parts = fullAddr.split(/\s+/); 
          if (parts.length >= 5) {
            post = parts.pop(); // ‡∏î‡∏∂‡∏á‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå
            prov = parts.pop().replace(/^‡∏à\./, ""); // ‡∏î‡∏∂‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
            dist = parts.pop().replace(/^‡∏≠\./, ""); // ‡∏î‡∏∂‡∏á‡∏≠‡∏≥‡πÄ‡∏†‡∏≠
            sub  = parts.pop().replace(/^‡∏ï\./, ""); // ‡∏î‡∏∂‡∏á‡∏ï‡∏≥‡∏ö‡∏•
            addrMain = parts.join(' '); // ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Ñ‡∏∑‡∏≠ ‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà/‡∏ñ‡∏ô‡∏ô
          } else {
            addrMain = fullAddr;
          }

          // üü¢ ‡∏•‡∏≠‡∏à‡∏¥‡∏Å‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤ 3 ‡∏à‡∏ß.‡πÉ‡∏ï‡πâ / ‡∏≠‡∏∑‡πà‡∏ô‡πÜ)
          const workplace = String(item[COL.WORKPLACE] || '').trim();
          let affBase = '';
          let affOther = '';

          if (workplace.includes('(3 ‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡πÉ‡∏ï‡πâ)')) {
            affBase = '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏≤‡∏Å 3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ';
            affOther = workplace.replace('(3 ‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡πÉ‡∏ï‡πâ)', '').trim();
          } 
          else if (affiliationOptions.value.includes(workplace)) {
            affBase = workplace;
            affOther = '';
          } 
          else {
            affBase = workplace ? '‡∏≠‡∏∑‡πà‡∏ô‡πÜ' : '';
            affOther = workplace === '-' ? '' : workplace;
          }

          editForm.value = JSON.parse(JSON.stringify({
            rowNumber: item.rowNumber,
            timestamp: item[COL.TIMESTAMP],
            id: item[COL.ID],
            email: item[COL.EMAIL],
            title_Name: item[COL.TITLE],
            firstName: item[COL.FNAME],
            lastName: item[COL.LNAME],
            phoneNumber: item[COL.PHONE],
            proLicense: item[COL.LICENSE],
            status_Register: item[COL.REG_TYPE],
            foodType: item[COL.FOOD],
            internalPosition: item[COL.POSITION], 
            workGroup: item[COL.WORK_GROUP],
            department: item[COL.DEPARTMENT],
            name_Receipt: item[COL.RECEIPT_NAME],
            taxpayer_ID: item[COL.TAX_ID],
            affiliation: affBase,           // ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô Dropdown
            affiliation_otherText: affOther, // ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á
            workPlace: workplace,           // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡∏±‡∏ô‡∏û‡∏•‡∏≤‡∏î
            address_main: addrMain,         // ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô/‡∏ñ‡∏ô‡∏ô
            address_subdistrict: sub,       // ‡∏ï‡∏≥‡∏ö‡∏•
            address_district: dist,         // ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠
            address_province: prov,         // ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
            address_postcode: post,         // ‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå
            profileImageUrl: item[COL.IMAGE]
          }));

          originalForm.value = JSON.parse(JSON.stringify(editForm.value));

          // ‡∏™‡∏±‡πà‡∏á‡πÄ‡∏õ‡∏¥‡∏î Modal
          const modalEl = document.getElementById('adminEditModal');
          const modal = bootstrap.Modal.getOrCreateInstance(modalEl);
          modal.show();
          
          setTimeout(() => {
            initThailandJSAdmin();
          }, 500);
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏≤‡∏Å Modal
        const submitAdminEdit = () => {
          const f = editForm.value;

          // üü¢ 1. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô
          if (f.status_Register === REG_STATUS.EXTERNAL) {
            let baseAddr = f.address_main || "";
            let sub = f.address_subdistrict || "";
            let dist = f.address_district || "";
            let prov = f.address_province || "";
            let post = f.address_postcode || "";

            // ‡∏•‡∏≠‡∏à‡∏¥‡∏Å‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î: ‡∏•‡∏ö‡∏ä‡∏∑‡πà‡∏≠ ‡∏ï‡∏≥‡∏ö‡∏•/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏´‡∏•‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏Å‡∏≠‡∏≠‡∏Å
            const cleanPattern = [sub, dist, prov, post, `‡∏ï.${sub}`, `‡∏≠.${dist}`, `‡∏à.${prov}`, "‡∏ï.", "‡∏≠.", "‡∏à."];
            cleanPattern.forEach(text => {
              if (text && text.length > 0) {
                let regex = new RegExp(text, "g");
                baseAddr = baseAddr.replace(regex, "");
              }
            });

            // ‡∏£‡∏ß‡∏°‡∏£‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô
            const fullAddr = [
              baseAddr.trim(), 
              sub ? '‡∏ï.' + sub : '',
              dist ? '‡∏≠.' + dist : '',
              prov ? '‡∏à.' + prov : '',
              post
            ].filter(p => p && String(p).trim() !== "").join(' ');
            
            f.address = fullAddr;
          }

          // üü¢ 2. ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤ "‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô/‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î" (3 ‡∏à‡∏ß.‡πÉ‡∏ï‡πâ / ‡∏≠‡∏∑‡πà‡∏ô‡πÜ)
          let finalWorkplace = f.affiliation || f.workPlace; 
          if (f.affiliation === '‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏à‡∏≤‡∏Å 3 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ') {
            finalWorkplace = `${f.affiliation_otherText || ''} (3 ‡∏ä‡∏≤‡∏¢‡πÅ‡∏î‡∏ô‡πÉ‡∏ï‡πâ)`.trim();
          } else if (f.affiliation === '‡∏≠‡∏∑‡πà‡∏ô‡πÜ') {
            finalWorkplace = f.affiliation_otherText || "-";
          }
          f.workPlace = finalWorkplace;

          loading.value = true;
          
          // üü¢ 3. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏ó‡∏µ‡πà Server
          google.script.run
            .withSuccessHandler((res) => {
              loading.value = false;
              if (res.success) {
                Swal.fire({ icon: 'success', title: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', text: res.message, timer: 1500 });
                const modalEl = document.getElementById('adminEditModal');
                const modal = bootstrap.Modal.getInstance(modalEl);
                modal.hide();
                loadAdminTable(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ Dashboard
              } else {
                Swal.fire("‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", res.message, "error");
              }
            })
            .withFailureHandler((err) => {
              loading.value = false;
              Swal.fire("Error", err.toString(), "error");
            })
            .updateForm(f);
        };

        // --- ‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° ---
        const confirmCancelEdit = () => {
          Swal.fire({
            title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å?',
            text: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡∏Å ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#6c757d',
            confirmButtonText: '‡πÉ‡∏ä‡πà, ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
            cancelButtonText: '‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡πà‡∏≠'
          }).then((result) => {
            if (result.isConfirmed) {

              resetForm(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ó‡∏≥‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡∏∞‡∏õ‡∏¥‡∏î isEditMode

              Swal.fire({
                icon: 'success',
                title: '‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                text: '‡∏ó‡πà‡∏≤‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÇ‡∏´‡∏°‡∏î‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
                timer: 1500,
                showConfirmButton: false
              });
            }
          });
        };

        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏• ---
        const evalDay = ref(1);
        const day1Questions = ref([]); // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Array ‡∏ï‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏õ‡πá‡∏ô ref ‡∏ß‡πà‡∏≤‡∏á
        const day2Questions = ref([]); // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Array ‡∏ï‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏õ‡πá‡∏ô ref ‡∏ß‡πà‡∏≤‡∏á
        const loadingEval = ref(false);

        const evalForm = ref({ origin: '', gift: '', firstName: '', lastName: '', affiliation: '', overallRating: '', nextTopic: '', feedback: '' });

        // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏Ñ‡∏á‡∏ó‡∏µ‡πà ‡∏à‡∏∂‡∏á‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ)
        const subItems = [
          { id: 1, text: '‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à' },
          { id: 2, text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤' },
          { id: 3, text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå' },
          { id: 4, text: '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Ç‡∏≠‡∏á‡∏™‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢' },
          { id: 5, text: '‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°' }
        ];

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Sheet
        const fetchAssessmentConfig = () => {
          loadingEval.value = true;
          google.script.run
            .withSuccessHandler((res) => {
              loadingEval.value = false;
              if (res.success) {
                day1Questions.value = res.day1;
                day2Questions.value = res.day2;
              }
            })
            .getAssessmentConfig();
        };

        // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•
        watch(currentView, (newView) => {
          if (newView === 'AssessmentForm' || newView === 'summary') {
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£
            if (day1Questions.value.length === 0) {
              fetchAssessmentConfig();
            }
          }
        });

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô ---
        const resetEvaluationForm = () => {
          evalForm.value = { 
            origin: '', 
            gift: '', 
            firstName: '', 
            lastName: '', 
            affiliation: '', 
            overallRating: '', 
            nextTopic: '', 
            feedback: '' 
            // ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡∏ö‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ Vue ‡∏à‡∏∞‡∏•‡πâ‡∏≤‡∏á Key ‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏ä‡πà‡∏ô q1_1, q1_2 ‡∏ó‡∏¥‡πâ‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
          };
        };

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏•‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î ---
        const changeDay = (day) => {
          if (evalDay.value === day) return; // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£
          
          // ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï (‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏ú‡∏•‡∏≠‡∏Å‡∏î‡∏™‡∏•‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏ì‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏Å)
          // ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏™‡∏±‡πà‡∏á‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏•‡∏¢‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö
          evalDay.value = day;
          resetEvaluationForm();
        };

        // ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Submit ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ resetEvaluationForm ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢
        const submitEvaluation = (event) => {
          if (event) event.preventDefault();
          loading.value = true;

          google.script.run
            .withSuccessHandler((res) => {
              loading.value = false;
              if (res.success) {
                
                // üü¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÄ‡∏•‡∏Ç‡∏à‡∏±‡∏ö‡∏â‡∏•‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏î‡πà‡∏ô‡πÜ)
                let successHtml = `
                  <div class="text-center py-3">
                    <div class="mb-3">
                      <div class="bg-success bg-opacity-10 text-success rounded-circle d-inline-flex align-items-center justify-content-center"
                          style="width:80px;height:80px;">
                        <i class="fa-solid fa-circle-check fa-2x"></i>
                      </div>
                    </div>

                    <h4 class="fw-bold text-success mb-2">
                      ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß
                    </h4>
                    <p class="text-muted mb-0">
                      ‡∏Ç‡∏≠‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏Ñ‡πà‡∏∞
                    </p>
                  </div>
                `;

                if (res.luckyNumber) {
                  successHtml += `
                    <div class="card border-0 shadow-sm mt-4 rounded-4 overflow-hidden">
                      
                      <!-- Header Highlight -->
                      <div class="bg-warning bg-opacity-10 text-warning fw-semibold text-center py-2">
                        üéÅ Lucky Draw
                      </div>

                      <div class="card-body text-center p-4">
                        <div class="text-muted small mb-2">
                          ‡∏£‡∏´‡∏±‡∏™‡∏•‡∏∏‡πâ‡∏ô‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏•‡∏∂‡∏Å‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏Ñ‡∏∑‡∏≠
                        </div>

                        <!-- ‡πÄ‡∏•‡∏Ç‡πÄ‡∏î‡πà‡∏ô -->
                        <div class="display-3 fw-bold text-primary my-2">
                          ${res.luckyNumber}
                        </div>

                        <div class="badge bg-danger bg-opacity-10 text-danger px-3 py-2 rounded-pill">
                          <i class="fa-solid fa-camera me-1"></i>
                          ‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏Ñ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô
                        </div>
                      </div>
                    </div>
                  `;
                }

                Swal.fire({
                  // icon: 'success',
                  // title: '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                  html: successHtml,
                  confirmButtonColor: '#004085',
                  confirmButtonText: '‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö',
                  allowOutsideClick: false
                }).then(() => {
                  resetEvaluationForm(); 
                  currentView.value = 'form';
                  window.scrollTo({ top: 0, behavior: 'smooth' });
                });
              } else {
                Swal.fire("‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", res.message, "error");
              }
            })
            .saveAssessment({ ...evalForm.value, evalDay: evalDay.value });
        };

        const cleanAdminAddress = () => {
          if (!editForm.value.address_main) return;

          let addr = editForm.value.address_main;
          const sub = editForm.value.address_subdistrict || "";
          const dist = editForm.value.address_district || "";
          const prov = editForm.value.address_province || "";
          const post = editForm.value.address_postcode || "";

          // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏î‡∏±‡∏Å‡∏•‡∏ö
          const targets = [
            sub, dist, prov, post,
            `‡∏ï.${sub}`, `‡∏≠.${dist}`, `‡∏à.${prov}`,
            `‡∏ï‡∏≥‡∏ö‡∏•${sub}`, `‡∏≠‡∏≥‡πÄ‡∏†‡∏≠${dist}`, `‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î${prov}`,
            "‡∏ï‡∏≥‡∏ö‡∏•", "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠", "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î", "‡∏ï.", "‡∏≠.", "‡∏à.", "‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå"
          ];

          targets.forEach(t => {
            if (t && t.toString().length > 1) { // ‡∏•‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß (‡∏Å‡∏±‡∏ô‡∏•‡∏ö‡∏™‡∏∏‡πà‡∏°‡∏™‡∏µ‡πà‡∏™‡∏∏‡∏°‡∏´‡πâ‡∏≤)
              const regex = new RegExp(t, "g");
              addr = addr.replace(regex, "");
            }
          });

          // ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏≠‡∏°‡∏°‡πà‡∏≤
          editForm.value.address_main = addr.trim().replace(/\s\s+/g, ' ');
        };

        const initThailandJSAdmin = () => {
          if (typeof $.Thailand !== 'undefined') {
            $.Thailand({
              $district: $("#admin_subdistrict"),
              $amphoe: $("#admin_district"),
              $province: $("#admin_province"),
              $zipcode: $("#admin_postcode"),
              onDataFill: (data) => {
                editForm.value.address_subdistrict = data.district;
                editForm.value.address_district = data.amphoe;
                editForm.value.address_province = data.province;
                editForm.value.address_postcode = data.zipcode;
                
                // üü¢ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ: ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏ï‡∏¥‡∏° ‡∏ï‡∏≥‡∏ö‡∏•/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠/‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡πÉ‡∏´‡πâ‡∏™‡∏±‡πà‡∏á‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                cleanAdminAddress();

                ['admin_subdistrict', 'admin_district', 'admin_province', 'admin_postcode'].forEach(id => {
                  document.getElementById(id).dispatchEvent(new Event('input', { bubbles: true }));
                });
              }
            });
          }
        };

        const isFormUnchanged = computed(() => {
          // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î Modal ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏¥‡∏î‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô
          if (!originalForm.value || !editForm.value) return true;
          
          // ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö String ‡∏ñ‡πâ‡∏≤‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πä‡∏∞‡∏à‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ true (‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏∞‡∏ñ‡∏π‡∏Å disabled)
          return JSON.stringify(editForm.value) === JSON.stringify(originalForm.value);
        });

        //===== ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡πÉ‡∏à ==============
        const summaryFilter = ref({ date: '', origin: '' });
        const summaryData = ref(null);

        const loadSummary = () => {
          loading.value = true;
          google.script.run
            .withSuccessHandler((res) => {
              loading.value = false;
              summaryData.value = res;
              loading.value = false;
            })
            .getAssessmentSummary(summaryFilter.value);
        };

        // --- ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå ---
        const getPercent = (count, total) => {
          if (!total || total === 0) return '0.0%';
          return ((count / total) * 100).toFixed(1) + '%';
        };

        // ‡∏Å‡∏£‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
        const filteredQuestionsForSummary = computed(() => {
          const selectedDate = summaryFilter.value.date; 

          if (selectedDate.includes("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1")) {
            // ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô .value ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô Array ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
            return day1Questions.value; 
          } else if (selectedDate.includes("‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2")) {
            // ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô .value
            return day2Questions.value; 
          }
          
          // ‚úÖ ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ .value ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏à‡∏∏‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Spread Operator (...) ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
          return [...day1Questions.value, ...day2Questions.value];
        });

        const navToSummary = () => {
          currentView.value = 'summary';
          
          // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤ Filter ‡πÄ‡∏Å‡πà‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏Å‡∏î‡πÄ‡∏°‡∏ô‡∏π)
          summaryFilter.value.date = '';
          summaryFilter.value.origin = '';
          
          // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Server
          loadSummary(); 
        };

        //=== ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• =====
        const filterRegType = ref('');
        const searchAdminQuery = ref('');

        const filteredAdminData = computed(() => {
          if (!adminData.value) return [];
          
          return adminData.value.filter(item => {
            // 1. ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°)
            const matchType = !filterRegType.value || item[COL.REG_TYPE] === filterRegType.value;
            
            // 2. ‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (‡πÄ‡∏û‡∏¥‡πà‡∏° ID ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà) üü¢
            const query = searchAdminQuery.value.toLowerCase().trim();
            const matchQuery = !query || (
              (item[COL.ID] && item[COL.ID].toLowerCase().includes(query)) || // üü¢ ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢ ID
              (item[COL.FNAME] && item[COL.FNAME].toLowerCase().includes(query)) || // ‡∏ä‡∏∑‡πà‡∏≠
              (item[COL.LNAME] && item[COL.LNAME].toLowerCase().includes(query)) || // ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•
              (item[COL.LICENSE] && item[COL.LICENSE].toLowerCase().includes(query)) || // ‡πÄ‡∏•‡∏Ç‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡∏Ø
              (item[COL.EMAIL] && item[COL.EMAIL].toLowerCase().includes(query)) // ‡∏≠‡∏µ‡πÄ‡∏°‡∏•
            );
            
            return matchType && matchQuery;
          });
        });
        //===== ‡∏à‡∏ö ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ====

        //===== ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏Å‡∏≤‡∏£ ====

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        const hasImage = (url) => {
          return (url && url !== '' && url !== '-');
        };

        // 1. ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞ file download
        const scheduleData = ref({ day1: [], day2: [] });
        const loadingSchedule = ref(false);
        const adminSheetUrl = ref('');

        const fetchSchedule = () => {
          loadingSchedule.value = true;
          google.script.run
            .withSuccessHandler((res) => {
              loadingSchedule.value = false;
              if (res.success) {
                scheduleData.value = res.data;
                adminSheetUrl.value = res.sheetUrl;
              }
            })
            .getScheduleFromSheet();
        };

        // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏°‡∏≤‡∏´‡∏ô‡πâ‡∏≤ Schedule (‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î)
        watch(currentView, (newView) => {
          if (newView === 'schedule') {
            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡πÉ‡∏ô scheduleData ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÅ‡∏ñ‡∏ß‡πÄ‡∏õ‡πá‡∏ô 0) ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
            if (scheduleData.value.day1.length === 0 && scheduleData.value.day2.length === 0) {
              fetchSchedule();
            }
          }
        });
        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£
        const onScheduleDownload = (item) => {
          // 1. ‡∏™‡∏±‡πà‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÑ‡∏õ‡∏ó‡∏µ‡πà Server (‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á)
          google.script.run.trackFileDownload(item.rowNumber);
          
          // 2. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á)
          item.file.count++;
          
          // 3. ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÉ‡∏´‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏Å‡∏ï‡∏¥ (‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ú‡πà‡∏≤‡∏ô <a> tag)
          return true; 
        };

        // ‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏° return onScheduleDownload ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
        // 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
        const downloadCount = ref(0);
        const navToSchedule = () => {
          currentView.value = 'schedule';
          // ‡∏ñ‡πâ‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏õ‡πá‡∏ô 0 (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÇ‡∏´‡∏•‡∏î) ‡∏Ñ‡πà‡∏≠‡∏¢‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Server
          if (downloadCount.value === 0) {
            loading.value = true;
            google.script.run.withSuccessHandler(c => { 
              downloadCount.value = c; 
              loading.value = false; 
            }).getCurrentDownloadCount('scheduleConference');
          }
        };

        // ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ PDF ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
        const handleDownload = () => {
          // 1. ‡∏™‡∏±‡πà‡∏á‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà Server
          google.script.run.withSuccessHandler(newCount => {
            downloadCount.value = newCount; // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏•‡∏Ç‡πÉ‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
          }).incrementDownloadCount('scheduleConference');

          // 2. ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå PDF
          window.open('https://drive.google.com/file/d/1I3d1gsZPbyteUlV0D_yPfWwUNyn6JJrU/view', '_blank');
        };

        // 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Modal ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
        const openSpeakerModal = (speaker, title) => {
          if (!speaker || !speaker.img) return;

          const modalImg = document.getElementById("modalImageExpanded");
          // ‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡∏ß‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏£‡∏π‡∏õ‡πÄ‡∏Å‡πà‡∏≤‡∏Ñ‡πâ‡∏≤‡∏á
          modalImg.src = ""; 
          modalImg.src = speaker.img;

          document.getElementById("modalSpeakerNameExpanded").textContent = title || "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î";
          
          const infoArea = document.getElementById("modalSpeakerAffiliationExpanded");
          infoArea.innerHTML = `
            <div style="font-weight: bold; font-size: 1.15rem; color: #212529; margin-bottom: 5px;">${speaker.name || ''}</div>
            <div style="font-size: 0.95rem; color: #6c757d; line-height: 1.4;">${speaker.dept || ''}</div>
          `;

          document.getElementById("speakerDetailModal").style.display = "flex";
          document.body.style.overflow = 'hidden';
        };

        const closeSpeakerModal = () => {
          document.getElementById("speakerDetailModal").style.display = "none";
          document.body.style.overflow = 'auto';
        };

        // üü¢ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£
        const loadSchedule = () => {
          loading.value = true;
          google.script.run
            .withSuccessHandler((count) => {
              downloadCount.value = count;
              loading.value = false;
            })
            .getCurrentDownloadCount('scheduleConference');
        };
        //===== ‡∏à‡∏ö ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏Å‡∏≤‡∏£ ====

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ ---
        const scrollToTop = () => {
          window.scrollTo({
            top: 0,
            behavior: 'smooth'
          });
        };

        const scrollToBottom = () => {
          window.scrollTo({
            top: document.documentElement.scrollHeight,
            behavior: 'smooth'
          });
        };

        // ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ Scan QR Code
        const scannedUser = ref(null); 
        const scanDay = ref('1');
        const isScanning = ref(false);
        let html5QrCode = null;

        // --- 1. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏¥‡∏î (‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏±‡∏î‡πÅ‡∏¢‡πâ‡∏á) ---
        const stopScanner = () => {
            if (html5QrCode) {
                // ‡πÉ‡∏ä‡πâ promise ‡∏Ç‡∏≠‡∏á stop ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏î‡∏±‡∏ö‡∏™‡∏ô‡∏¥‡∏ó‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏±‡πà‡∏á clear
                html5QrCode.stop().then(() => {
                    html5QrCode.clear(); // ‡∏•‡πâ‡∏≤‡∏á HTML ‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô <div id="reader">
                    html5QrCode = null;
                    isScanning.value = false;
                }).catch(err => {
                    // ‡∏Å‡∏£‡∏ì‡∏µ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ï‡πà‡∏™‡∏±‡πà‡∏á‡∏õ‡∏¥‡∏î ‡πÉ‡∏´‡πâ‡∏™‡∏±‡πà‡∏á‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÄ‡∏•‡∏¢
                    html5QrCode.clear();
                    html5QrCode = null;
                    isScanning.value = false;
                });
            } else {
                isScanning.value = false;
            }
        };

        // --- 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á ---
        const startScanner = () => {
            if (loadingScanner.value || loadingUpload.value) return;
            
            // ‡∏•‡πâ‡∏≤‡∏á Instance ‡πÄ‡∏Å‡πà‡∏≤
            if (html5QrCode) {
                html5QrCode.clear();
            }
            
            isScanning.value = true;
            scannedUser.value = null;
            loadingScanner.value = false; // ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏´‡∏°‡∏∏‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á

            setTimeout(() => {
                html5QrCode = new Html5Qrcode("reader");
                html5QrCode.start(
                    { facingMode: "environment" },
                    { 
                        fps: 20, 
                        qrbox: (viewfinderWidth, viewfinderHeight) => {
                            const width = Math.floor(viewfinderWidth * 0.85);
                            const height = Math.floor(viewfinderWidth * 0.85); 
                            return { width, height };
                        }
                    },
                    (decodedText) => {
                      if (html5QrCode) {
                          html5QrCode.stop().then(() => {
                              // ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏´‡∏¢‡∏∏‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏à‡∏≤‡∏Å‡∏à‡∏≠‡πÅ‡∏•‡πâ‡∏ß
                              loadingScanner.value = true; // ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏î‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏´‡∏°‡∏∏‡∏ô "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å..."
                              processAttendance(decodedText); // ‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡πà Server
                          }).catch(err => console.error("Error stopping scanner", err));
                      }
                      // ------------------
                    }
                ).catch(err => {
                    console.error(err);
                    loadingScanner.value = false;
                    isScanning.value = false;
                });
            }, 300);
        };

        // ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á Scan QR Code
        const processAttendance = (decodedText, passedStartTime) => {
            if (passedStartTime) {
                loadingUpload.value = true;
            } else {
                loadingScanner.value = true;
            }

            const startTime = passedStartTime || Date.now();
            const minDelay = 800; 

            google.script.run
                .withSuccessHandler((res) => {
                    const timeDiff = Date.now() - startTime;
                    const remainingTime = Math.max(0, minDelay - timeDiff);

                    setTimeout(() => {
                        // ‡∏õ‡∏¥‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÇ‡∏´‡∏•‡∏î
                        loadingUpload.value = false;
                        loadingScanner.value = false; 
                        
                        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡∏™‡∏±‡πà‡∏á‡∏õ‡∏¥‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ---
                        isScanning.value = false; 
                        if (html5QrCode) {
                            html5QrCode.clear();
                            html5QrCode = null;
                        }
                        // --------------------------------------------------------

                        if (res.success || res.isDuplicate) {
                            const user = res.userData;
                            scannedUser.value = user;
                            Swal.fire({
                                icon: res.isDuplicate ? 'warning' : 'success',
                                title: res.isDuplicate ? '‡∏™‡πÅ‡∏Å‡∏ô‡∏ã‡πâ‡∏≥!' : '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
                                text: `‡∏Ñ‡∏∏‡∏ì ${user[COL.TITLE]}${user[COL.FNAME]} ${user[COL.LNAME]}`,
                                timer: 2000,
                                showConfirmButton: false,
                                heightAuto: false
                            });
                        } else {
                            Swal.fire({
                                icon: 'error',
                                title: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
                                text: res.message,
                                confirmButtonColor: '#004085',
                                heightAuto: false
                            });
                        }
                    }, remainingTime);
                })
                .withFailureHandler((err) => {
                    loadingUpload.value = false;
                    loadingScanner.value = false;
                    isScanning.value = false; // ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
                    Swal.fire({ icon: 'error', title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏£‡∏∞‡∏ö‡∏ö', text: err.toString(), heightAuto: false });
                })
                .recordAttendance(decodedText, scanDay.value);
        };

        // ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î QrCode
        const downloadQr = (id, fname, lname) => {
          // ‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á URL
          const qrContent = id + '|' + fname + '|' + lname; // ‡πÉ‡∏ä‡πâ | ‡∏Ñ‡∏±‡πà‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
          const qrUrl = 'https://quickchart.io/qr?text=' + encodeURIComponent(qrContent) + '&size=500';
          
          // 1. ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
          window.open(qrUrl, '_blank');

          // 2. ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå
          const link = document.createElement('a');
          link.href = qrUrl;
          link.download = 'QRCode_' + id + '_' + fname + '-' + lname + '.png';
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        };

        const selectMenu = (view) => {
          // 1. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤ View ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏
          currentView.value = view;
          loading.value = false; // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏õ‡∏¥‡∏î loading ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π
          
          // 2. ‡∏™‡∏±‡πà‡∏á‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å (Hamburger Menu ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠)
          const navbarContent = document.getElementById('navbarNav');
          if (navbarContent && navbarContent.classList.contains('show')) {
            const bsCollapse = bootstrap.Collapse.getInstance(navbarContent);
            if (bsCollapse) {
              bsCollapse.hide();
            } else {
              new bootstrap.Collapse(navbarContent).hide();
            }
          }

          // 3. üü¢ ‡∏™‡∏±‡πà‡∏á‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏¢‡πà‡∏≠‡∏¢ Dropdown ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà (‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏à‡∏≠‡∏Ñ‡∏≠‡∏°‡πÅ‡∏•‡∏∞‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠)
          const openDropdowns = document.querySelectorAll('.dropdown-toggle.show');
          openDropdowns.forEach(toggle => {
            const bsDropdown = bootstrap.Dropdown.getInstance(toggle);
            if (bsDropdown) {
              bsDropdown.hide();
            }
          });
        };

        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û Profie
        const cameraZoom = ref(1.0);
        const isCameraActive = ref(false);
        const profilePreview = ref(null);
        let webcam = null;
        // ‡∏ü‡∏±‡∏á‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
        const startWebcam = async () => {
            // 1. ‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Tag <video v-if="..."> ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô HTML
            isCameraActive.value = true;
            profilePreview.value = null;

            // 2. ‡πÉ‡∏ä‡πâ Vue.nextTick ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡πÉ‡∏´‡πâ Vue ‡∏ß‡∏≤‡∏î Element <video> ‡∏•‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô
            await Vue.nextTick(); 

            const webcamElement = document.getElementById('webcam');
            const canvasElement = document.getElementById('canvas');

            // 3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ Element ‡∏Ñ‡∏£‡∏ö‡πÑ‡∏´‡∏°‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô (‡∏Å‡∏±‡∏ô‡∏û‡∏±‡∏á)
            if (!webcamElement) {
                console.error("‡∏´‡∏≤ Element ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠");
                return;
            }

            // 4. ‡∏™‡∏£‡πâ‡∏≤‡∏á instance ‡∏Ç‡∏≠‡∏á Webcam ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö webcam-easy ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ v-if)
            webcam = new Webcam(webcamElement, 'user', canvasElement);

            try {
                await webcam.start();
                console.log("‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß");
            } catch (err) {
                isCameraActive.value = false; // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏´‡πâ‡∏õ‡∏¥‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏•‡∏±‡∏ö
                Swal.fire("Error", "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á", "error");
            }
        };
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
        const stopWebcam = () => {
            if (webcam) {
                webcam.stop();
            }
            isCameraActive.value = false; // ‡∏õ‡∏¥‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ã‡πà‡∏≠‡∏ô‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏•‡∏≤‡∏¢ Element (‡πÅ‡∏Å‡πâ‡∏™‡∏µ‡∏î‡∏≥‡∏Ñ‡πâ‡∏≤‡∏á)
            cameraZoom.value = 1.0;
        };
        const retakePhoto = () => {
          profilePreview.value = null;
          cameraZoom.value = 1.0; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡∏ã‡∏π‡∏°
        };

        // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
        let cropper = null;
        const cropModal = ref(null);

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏≠‡∏ö
        const capturePhoto = () => {
          const video = document.getElementById('webcam');
          const canvas = document.getElementById('canvas');
          const context = canvas.getContext('2d');

          // ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏î‡∏¥‡∏ö (Raw) ‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
          canvas.width = video.videoWidth;
          canvas.height = video.videoHeight;
          context.drawImage(video, 0, 0, canvas.width, canvas.height);

          const rawImageData = canvas.toDataURL('image/jpeg');
          
          // ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
          if (webcam) { webcam.stop(); isCameraActive.value = false; }

          // ‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ‡πÑ‡∏õ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ñ‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà Modal
          const imageToCrop = document.getElementById('imageToCrop');
          imageToCrop.src = rawImageData;

          // ‡πÄ‡∏õ‡∏¥‡∏î Modal ‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏° Cropper
          cropModal.value.show();
          
          setTimeout(() => {
            if (cropper) cropper.destroy();
            cropper = new Cropper(imageToCrop, {
              aspectRatio: 1, // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏ï‡∏∏‡∏£‡∏±‡∏™
              viewMode: 1,
              dragMode: 'move',
              autoCropArea: 0.8,
              restore: false,
              guides: false,
              center: true,
              highlight: false,
              cropBoxMovable: true,
              cropBoxResizable: true,
              toggleDragModeOnDblclick: false,
            });
          }, 300);
        };

        // ‡∏Å‡∏î‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏≠‡∏ö‡∏™‡πà‡∏ß‡∏ô
        const applyCrop = () => {
          if (!cropper) return;

          // ‡∏î‡∏∂‡∏á‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ (‡∏Ç‡∏ô‡∏≤‡∏î 600x600 px)
          const croppedCanvas = cropper.getCroppedCanvas({
            width: 600,
            height: 600,
            imageSmoothingEnabled: true,
            imageSmoothingQuality: 'high',
          });

          profilePreview.value = croppedCanvas.toDataURL('image/jpeg', 0.8);
          
          // ‡∏õ‡∏¥‡∏î Modal ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î
          cropModal.value.hide();
          cropper.destroy();
          cropper = null;
        };

        // ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏≠‡∏ö
        const cancelCrop = () => {
          cropModal.value.hide();
          if (cropper) { cropper.destroy(); cropper = null; }
          retakePhoto(); // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå
        const handleFileUpload = (event) => {
          const file = event.target.files[0];
          if (!file) return;

          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
          if (!file.type.startsWith('image/')) {
            Swal.fire("‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î", "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô", "error");
            return;
          }

          const reader = new FileReader();
          reader.onload = (e) => {
            const imageData = e.target.result;
            
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î Modal ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏£‡∏π‡∏õ (‡πÉ‡∏ä‡πâ logic ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏ï‡∏≠‡∏ô‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ)
            openCropModal(imageData);
          };
          reader.readAsDataURL(file);
          
          // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤ input ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡πÄ‡∏î‡∏¥‡∏°‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
          event.target.value = '';
        };

        // ‡πÅ‡∏¢‡∏Å Logic ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î Modal ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏£‡∏π‡∏õ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏•‡∏≤‡∏á
        const openCropModal = (imageSrc) => {
          if (webcam) { webcam.stop(); isCameraActive.value = false; }

          const imageToCrop = document.getElementById('imageToCrop');
          imageToCrop.src = imageSrc;

          // ‡πÄ‡∏õ‡∏¥‡∏î Modal
          cropModal.value.show();
          
          // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Cropper
          setTimeout(() => {
            if (cropper) cropper.destroy();
            cropper = new Cropper(imageToCrop, {
              aspectRatio: 1, 
              viewMode: 1,
              dragMode: 'move',
              autoCropArea: 0.8,
              restore: false,
              guides: false,
              center: true,
              highlight: false,
              cropBoxMovable: true,
              cropBoxResizable: true,
              toggleDragModeOnDblclick: false,
            });
          }, 300);
        };

        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î ‡∏£‡∏π‡∏õ Qr Code
        const recentScans = ref([]); // ‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î

        // üü¢ 1. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û QR
        const handleQrUpload = (event) => {
          const file = event.target.files[0];
          if (!file) return;

          if (isScanning.value) stopScanner(); 

          loadingUpload.value = true; // [1] ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏´‡∏°‡∏∏‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
          const startTime = Date.now(); // [2] ‡∏à‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
          
          const fileScanner = new Html5Qrcode("reader");

          fileScanner.scanFile(file, true)
            .then(decodedText => {
              fileScanner.clear(); 
              // [3] ‡∏™‡πà‡∏á startTime ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡πÉ‡∏´‡πâ processAttendance ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏°‡∏∏‡∏ô‡πÉ‡∏´‡πâ‡∏¢‡∏≤‡∏ß‡∏û‡∏≠
              processAttendance(decodedText, startTime);
              event.target.value = ''; 
            })
            .catch(err => {
              fileScanner.clear(); 
              loadingUpload.value = false; // ‡∏´‡∏¢‡∏∏‡∏î‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà‡∏™‡πÅ‡∏Å‡∏ô‡∏£‡∏π‡∏õ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
              
              Swal.fire({
                icon: 'error',
                title: '‡πÑ‡∏°‡πà‡∏û‡∏ö QR Code',
                text: '‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• QR Code ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
                confirmButtonColor: '#004085',
                heightAuto: false
              });
              event.target.value = '';
            });
        };
        // ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
        const handleSlipUpload = (event) => {
          const file = event.target.files[0];
          if (!file) return;
          const reader = new FileReader();
          reader.onload = (e) => {
            form.value.slipImage = e.target.result;
            Swal.fire({ icon: 'success', title: '‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏•‡∏¥‡∏õ‡πÅ‡∏•‡πâ‡∏ß', timer: 800, showConfirmButton: false });
          };
          reader.readAsDataURL(file);
        };

        //====== ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü =================
        let typeChart = null;
        let statusChart = null;

        const renderCharts = () => {
          const ctx1 = document.getElementById('typeChart');
          const ctx2 = document.getElementById('statusChart');
          if (!ctx1 || !ctx2) return;

          // ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô Plugin
          Chart.register(ChartDataLabels);

          // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Font Global ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏Å‡∏£‡∏≤‡∏ü
          Chart.defaults.font.family = "'Sarabun', sans-serif";
          Chart.defaults.font.size = 14;

          const total = adminData.value.length;

          // 1. ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
          const types = { internal: 0, quota: 0, external: 0 };
          adminData.value.forEach(item => {
            if (item[COL.REG_TYPE] === REG_STATUS.INTERNAL) types.internal++;
            else if (item[COL.REG_TYPE] === REG_STATUS.QUOTA) types.quota++;
            else if (item[COL.REG_TYPE] === REG_STATUS.EXTERNAL) types.external++;
          });

          // 2. ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
          const stats = { attend1: 0, attend2: 0, paid: 0 };
          adminData.value.forEach(item => {
            if (item[COL.ATTEND_1] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°') stats.attend1++;
            if (item[COL.ATTEND_2] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°') stats.attend2++;
            if (item[COL.PAYMENT_STATUS] === '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢') stats.paid++;
          });

          if (typeChart) typeChart.destroy();
          if (statusChart) statusChart.destroy();

          // --- ‡∏Å‡∏£‡∏≤‡∏ü‡∏ß‡∏á‡∏Å‡∏•‡∏° (‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô + %) ---
          typeChart = new Chart(ctx1, {
            type: 'doughnut',
            data: {
              labels: ['‡∏†‡∏≤‡∏¢‡πÉ‡∏ô', '‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤', '‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å'],
              datasets: [{
                data: [types.internal, types.quota, types.external],
                backgroundColor: ['#004085', '#6610f2', '#0d6efd']
              }]
            },
            options: {
              cutout: '40%', // üü¢ ‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏≤‡∏à‡∏à‡∏∞ 50% ‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤)
              plugins: {
                legend: { position: 'bottom' },
                datalabels: {
                  color: '#fff',
                  formatter: (value, ctx) => {
                    let sum = 0;
                    let dataArr = ctx.chart.data.datasets[0].data;
                    dataArr.map(data => { sum += data; });
                    let percentage = (value * 100 / sum).toFixed(1) + "%";
                    return value > 0 ? `${value}\n(${percentage})` : ''; // ‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏•‡∏∞% ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ > 0
                  },
                  font: { weight: 'bold', size: 14 }
                }
              }
            }
          });

          // --- ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏ó‡πà‡∏á (‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô) ---
          statusChart = new Chart(ctx2, {
            type: 'bar',
            data: {
              labels: ['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 25', '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 26', '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß'],
              datasets: [{
                label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô (‡∏ó‡πà‡∏≤‡∏ô)',
                data: [stats.attend1, stats.attend2, stats.paid],
                backgroundColor: '#28a745'
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                y: {
                  beginAtZero: true,
                  // üü¢ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡πÉ‡∏ä‡πâ ticks.padding ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏Å‡∏ô Y (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ) 
                  // üü¢ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ï‡∏£‡∏á‡πÜ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏™‡∏π‡∏ï‡∏£‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô
                  afterDataLimits: (axis) => {
                    axis.max += axis.max * 0.3; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å 30% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà
                  },
                  ticks: {
                    stepSize: 1
                  }
                }
              },
              plugins: {
                datalabels: {
                  anchor: 'end',
                  align: 'top',
                  offset: 10, // 3. ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏Å‡∏±‡∏ö‡∏´‡∏±‡∏ß‡πÅ‡∏ó‡πà‡∏á‡∏Å‡∏£‡∏≤‡∏ü
                  color: '#444',
                  formatter: (value) => {
                    let percentage = (value * 100 / total).toFixed(1) + "%";
                    return value > 0 ? `${value} (${percentage})` : '0';
                  },
                  font: { weight: 'bold', size: 14 }
                }
              }
            }
          });
        };

        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏Å‡∏£‡∏≤‡∏ü
        watch([adminData, currentView], async () => {
          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: 1. ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤ Admin 2. Login ‡πÅ‡∏•‡πâ‡∏ß 3. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß
          if (currentView.value === 'dashboard' && isAdminLoggedIn.value && adminData.value.length > 0) {
            
            // ‡∏£‡∏≠‡πÉ‡∏´‡πâ Vue Render DOM (Canvas) ‡πÉ‡∏´‡πâ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πà‡∏≠‡∏ô 0.1-0.2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            await Vue.nextTick(); 
            
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ß‡πà‡∏≤ Canvas ‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏ö‡∏ô‡∏à‡∏≠‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏±‡πà‡∏á‡∏ß‡∏≤‡∏î
            if (document.getElementById('typeChart')) {
              renderCharts();
            }
          }
        }, { deep: true });

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå (‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞ ‡∏Å-‡πô ‡πÅ‡∏•‡∏∞ A-Z a-z)
        const formatName = (field, isEdit = false) => {
          const targetForm = isEdit ? editForm : form;
          // Regex: ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà ‡∏Å-‡∏Æ, ‡∏™‡∏£‡∏∞, ‡∏ß‡∏£‡∏£‡∏ì‡∏¢‡∏∏‡∏Å‡∏ï‡πå ‡πÅ‡∏•‡∏∞ A-Z a-z
          // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏° \s ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô []
          targetForm.value[field] = targetForm.value[field].replace(/[^A-Za-z‡∏Å-‡πô]/g, "");
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏• (‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞ A-Z, a-z, 0-9 ‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏µ‡πÄ‡∏°‡∏•)
        const formatEmail = (isEdit = false) => {
          const targetForm = isEdit ? editForm : form;
          if (targetForm.value.email) {
            // ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏≠‡∏≤‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå @ . _ - + ‡∏≠‡∏≠‡∏Å
            targetForm.value.email = targetForm.value.email.replace(/[^a-zA-Z0-9@._\-\+]/g, "");
          }
        };

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‡∏´‡πâ‡∏≤‡∏°‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ ‡πÅ‡∏ï‡πà‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡πÑ‡∏î‡πâ)
        const formatPassword = () => {
          // Regex: [‡∏Å-‡πô] ‡∏Ñ‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÑ‡∏ó‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
          // ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÑ‡∏ó‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏á "" ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
          login.value.pass = login.value.pass.replace(/[‡∏Å-‡πô]/g, "");
        };

        /**
         * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏ó‡∏¢
         * @param {any} dateVal - ‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (Date object ‡∏´‡∏£‡∏∑‡∏≠ String)
         * @param {boolean} isThaiYear - true = ‡∏û.‡∏®. (+543), false = ‡∏Ñ.‡∏®. (‡πÑ‡∏°‡πà‡∏ö‡∏ß‡∏Å)
         * ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (15 ‡∏Å.‡∏û. 2569 ‡πÄ‡∏ß‡∏•‡∏≤ 12:00 ‡∏ô.)
         */
        const formatThaiDate = (dateVal, isThaiYear = true) => {
          if (!dateVal || dateVal === '-' || dateVal === '') return '-';

          let date;

          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô String ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö "DD/MM/YYYY, HH:mm:ss" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
          if (typeof dateVal === 'string' && dateVal.includes('/')) {
            try {
              const cleanStr = dateVal.replace(',', ''); 
              const parts = cleanStr.split(' '); 
              const dateParts = parts[0].split('/'); 
              const timeParts = parts[1] ? parts[1].split(':') : ['00', '00'];

              date = new Date(
                parseInt(dateParts[2]), 
                parseInt(dateParts[1]) - 1, 
                parseInt(dateParts[0]),
                parseInt(timeParts[0] || 0),
                parseInt(timeParts[1] || 0)
              );
            } catch (e) {
              date = new Date(dateVal);
            }
          } else {
            date = new Date(dateVal);
          }

          // ‡∏ñ‡πâ‡∏≤‡πÅ‡∏õ‡∏•‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ
          if (isNaN(date.getTime())) return dateVal;

          const months = [
            "‡∏°.‡∏Ñ.", "‡∏Å.‡∏û.", "‡∏°‡∏µ.‡∏Ñ.", "‡πÄ‡∏°.‡∏¢.", "‡∏û.‡∏Ñ.", "‡∏°‡∏¥.‡∏¢.",
            "‡∏Å.‡∏Ñ.", "‡∏™.‡∏Ñ.", "‡∏Å.‡∏¢.", "‡∏ï.‡∏Ñ.", "‡∏û.‡∏¢.", "‡∏ò.‡∏Ñ."
          ];

          const d = date.getDate();
          const m = months[date.getMonth()];
          
          // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏ö‡∏ß‡∏Å 543 ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ---
          const y = date.getFullYear() + (isThaiYear ? 543 : 0); 
          
          const h = String(date.getHours()).padStart(2, '0');
          const min = String(date.getMinutes()).padStart(2, '0');

          return `${d} ${m} ${y} ‡πÄ‡∏ß‡∏•‡∏≤ ${h}:${min} ‡∏ô.`;
        };

        const runBatchCert = () => {
          loading.value = true;
          Swal.fire({
            title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ø',
            text: '‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏¢‡∏≠‡∏¢‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå PDF ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÇ‡∏õ‡∏£‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠...',
            allowOutsideClick: false,
            didOpen: () => { Swal.showLoading(); }
          });

          google.script.run
            .withSuccessHandler((res) => {
              loading.value = false;
              Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', res.message, 'success');
              loadAdminTable(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            })
            .batchGenerateCertificates();
        };

        // 1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤
        const currentPage = ref(1);
        const itemsPerPage = 15; // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î 15 ‡πÅ‡∏ñ‡∏ß‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£

        // 2. ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡πÜ (Pagination Logic)
        const paginatedAdminData = computed(() => {
          const start = (currentPage.value - 1) * itemsPerPage;
          const end = start + itemsPerPage;
          return filteredAdminData.value.slice(start, end);
        });

        // 3. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        const totalPages = computed(() => {
          return Math.ceil(filteredAdminData.value.length / itemsPerPage);
        });

        // 4. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤)
        const changePage = (page) => {
          if (page >= 1 && page <= totalPages.value) {
            currentPage.value = page;
            // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏à‡∏≠‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
            const tableEl = document.querySelector('.admin-desktop-table');
            if (tableEl) tableEl.scrollIntoView({ behavior: 'smooth' });
          }
        };

        // 5. ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ 1 ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
        watch([searchAdminQuery, filterRegType], () => {
          currentPage.value = 1;
        });

        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô ‡πÅ‡∏•‡∏∞ ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏Å‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£
        const canDownload = (item) => {
          // 0. ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡∏Ñ‡∏∏‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏≠‡∏∑‡πà‡∏ô
          if (!item[COL.CERT_URL] || item[COL.CERT_URL] === '-' || item[COL.CERT_URL] === '') return false;

          const isAttendBothDays = item[COL.ATTEND_1] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°' && item[COL.ATTEND_2] === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°';
          const regType = item[COL.REG_TYPE];

          // 1. ‡∏Å‡∏£‡∏ì‡∏µ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å: ‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ + ‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏ö 2 ‡∏ß‡∏±‡∏ô
          if (regType === REG_STATUS.EXTERNAL) {
            return item[COL.PAYMENT_STATUS] === '‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢' && isAttendBothDays;
          }

          // 2. ‡∏Å‡∏£‡∏ì‡∏µ‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡∏´‡∏£‡∏∑‡∏≠ ‡πÇ‡∏Ñ‡∏ß‡∏ï‡πâ‡∏≤: ‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏Ñ‡∏£‡∏ö 2 ‡∏ß‡∏±‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
          if (regType === REG_STATUS.INTERNAL || regType === REG_STATUS.QUOTA) {
            return isAttendBothDays;
          }

          return false;
        };

        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (30 ‡∏°‡∏¥.‡∏¢. 2569, 18:00)
        // ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô JavaScript ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 0 (0=‡∏°.‡∏Ñ., 5=‡∏°‡∏¥.‡∏¢.) ‡∏õ‡∏µ, ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, ‡∏ß‡∏±‡∏ô, ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á, ‡∏ô‡∏≤‡∏ó‡∏µ
        const deadlineTimestamp = ref(null);
        const isTimerLoaded = ref(false); // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î

        const loadDeadline = () => {
          google.script.run
            .withSuccessHandler((timestamp) => {
              deadlineTimestamp.value = timestamp;
              isTimerLoaded.value = true; // ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
            })
            .getDeadlineFromSheet();
        };

        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà Script ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
        loadDeadline();

        const canUserEdit = computed(() => {
          // 1. ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô Admin ‡∏´‡∏£‡∏∑‡∏≠ Editor ‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡∏•‡∏≠‡∏î (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡πÇ‡∏´‡∏•‡∏î Timer ‡∏Å‡πá‡πÑ‡∏î‡πâ)
          if (isAdminLoggedIn.value && ['admin', 'editor'].includes(userRole.value)) {
            return true;
          }
          
          // 2. ‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå/‡πÄ‡∏ß‡∏•‡∏≤‡∏¢‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏£‡πá‡∏à ‡πÉ‡∏´‡πâ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤ "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå" ‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
          if (!isTimerLoaded.value) {
            return false; 
          }

          // 3. ‡∏ñ‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ Deadline (‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å Error ‡πÉ‡∏ô Sheet) ‡πÉ‡∏´‡πâ‡∏õ‡∏¥‡∏î‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î Default
          if (!deadlineTimestamp.value) {
            return false;
          }

          // 4. ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Sheet
          const now = new Date().getTime();
          
          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á" ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
          return now < deadlineTimestamp.value;
        });

        // --- 1. ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏• ---
        const currentPageSummary = ref(1);
        const itemsPerPageSummary = 15;

        // --- 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Computed ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ---
        const paginatedComments = computed(() => {
          if (!summaryData.value || !summaryData.value.comments) return [];
          const start = (currentPageSummary.value - 1) * itemsPerPageSummary;
          const end = start + itemsPerPageSummary;
          return summaryData.value.comments.slice(start, end);
        });

        // --- 3. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---
        const totalPagesSummary = computed(() => {
          if (!summaryData.value || !summaryData.value.comments) return 0;
          return Math.ceil(summaryData.value.comments.length / itemsPerPageSummary);
        });

        // --- 4. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ---
        const changePageSummary = (page) => {
          if (page >= 1 && page <= totalPagesSummary.value) {
            currentPageSummary.value = page;
          }
        };

        // --- 5. ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà 1 ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Filter (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î) ---
        watch([() => summaryFilter.value.date, () => summaryFilter.value.origin], () => {
          currentPageSummary.value = 1;
        });

        // --- ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î-‡∏õ‡∏¥‡∏î ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏• ---
        // --- 1. ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ Reactive ---
        const assessmentTimer = ref(null);
        const isAssessmentTimerLoaded = ref(false);

        // --- 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≤‡∏Å Server (Code.gs) ---
        const loadAssessmentTimer = () => {
          google.script.run
            .withSuccessHandler((res) => {
              // res ‡∏à‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ d1o, d1c, d2o, d2c ‡πÄ‡∏õ‡πá‡∏ô Timestamp
              assessmentTimer.value = res;
              isAssessmentTimerLoaded.value = true;
            })
            .getAssessmentTimer();
        };

        // --- 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á Computed ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏¢‡∏Å‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô ---
        // ‡∏ï‡∏±‡∏ß‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1
        const isDay1Active = computed(() => {
          if (isAdminLoggedIn.value) return true;
          if (!isAssessmentTimerLoaded.value || !assessmentTimer.value) return false;

          const now = new Date().getTime();
          const t = assessmentTimer.value;
          // ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏ï‡πá‡∏°
          return (t.day1Open && t.day1Close && now >= t.day1Open && now <= t.day1Close);
        });

        const isDay2Active = computed(() => {
          if (isAdminLoggedIn.value) return true;
          if (!isAssessmentTimerLoaded.value || !assessmentTimer.value) return false;

          const now = new Date().getTime();
          const t = assessmentTimer.value;
          // ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏ï‡πá‡∏°
          return (t.day2Open && t.day2Close && now >= t.day2Open && now <= t.day2Close);
        });

        // ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°
        const canAccessAssessment = computed(() => {
          // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ "‡∏ß‡∏±‡∏ô‡πÉ‡∏î‡∏ß‡∏±‡∏ô‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà" ‡∏´‡∏£‡∏∑‡∏≠ "‡πÄ‡∏õ‡πá‡∏ô Admin"
          const access = isDay1Active.value || isDay2Active.value;
          
          // --- ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Debug (‡∏Å‡∏î F12 ‡πÉ‡∏ô Chrome ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á) ---
          if (isAssessmentTimerLoaded.value) {
            console.log("--- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô ---");
            console.log("‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:", new Date().toLocaleString());
            console.log("‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1:", isDay1Active.value ? "‡πÄ‡∏õ‡∏¥‡∏î" : "‡∏õ‡∏¥‡∏î");
            console.log("‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2:", isDay2Active.value ? "‡πÄ‡∏õ‡∏¥‡∏î" : "‡∏õ‡∏¥‡∏î");
          }
          
          return access;
        });

        // --- 5. ‡∏£‡∏∞‡∏ö‡∏ö Auto-Select: ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà ---
        watch(isAssessmentTimerLoaded, (loaded) => {
          if (loaded && !isAdminLoggedIn.value) {
            if (isDay2Active.value) {
              evalDay.value = 2; // ‡∏ñ‡πâ‡∏≤‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 2 ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÇ‡∏ä‡∏ß‡πå‡∏´‡∏ô‡πâ‡∏≤ 2
            } else if (isDay1Active.value) {
              evalDay.value = 1; // ‡∏ñ‡πâ‡∏≤‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÇ‡∏ä‡∏ß‡πå‡∏´‡∏ô‡πâ‡∏≤ 1
            }
          }
        });

        // ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö
        loadAssessmentTimer();

        // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏¥‡∏î‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
        const externalDeadline = ref(null);
        const isExternalClosed = computed(() => {
          if (!externalDeadline.value) return false;
          return Date.now() > externalDeadline.value;
        });

        //++++ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏° ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£ ++++
        const certDeadline = ref(null);
        const isCertDeadlineLoaded = ref(false);

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡∏≤‡∏Å F2
        const loadCertDeadline = () => {
          google.script.run
            .withSuccessHandler((timestamp) => {
              certDeadline.value = timestamp;
              isCertDeadlineLoaded.value = true;
            })
            .getCertDownloadDeadline();
        };

        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ "‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á"
        const isCertTimeOpen = computed(() => {
          // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô Admin ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ß‡∏•‡∏≤ (‡πÄ‡∏´‡πá‡∏ô‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏•‡∏≠‡∏î)
          if (isAdminLoggedIn.value) return true;
          
          if (!isCertDeadlineLoaded.value || !certDeadline.value) return false;
          
          const now = new Date().getTime();
          return now >= certDeadline.value; // ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô "‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö" ‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô F2
        });

        return {
          selectMenu, currentView, showPassword,       
          deadlineTimestamp, canUserEdit, // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏¥‡∏î
          formatEmail, // ‡∏≠‡∏µ‡πÄ‡∏°‡∏•
          formatName, // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å ‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•
          formatPassword, // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
          formatThaiDate, // ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
          loading, loadingUpload, loadingScanner,
          // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà
          isAdminLoggedIn, userRole, adminData, login, adminSearch, filteredAdminData,
          handleAdminLogin, logoutAdmin, loadAdminTable, savingRows, saveAdminUpdate, confirmDelete, navToAdmin,
          originalForm, isFormUnchanged, isRowChanged, cleanAdminAddress,
          // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á dashboard
          paginatedAdminData, currentPage, totalPages, changePage, itemsPerPage,
          // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏≤‡∏î‡∏Å‡∏£‡∏≤‡∏ü
          typeChart , statusChart, renderCharts,
          // Scan Qr Code
          scanDay, isScanning, startScanner, stopScanner, downloadQr,
          scannedUser, processAttendance, handleQrUpload, recentScans,
          // ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏° Modal ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
          editForm,  openAdminEditModal, submitAdminEdit,
          // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÅ‡∏•‡∏∞ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
          searchQuery, searchResult, isEditMode,
          handleSearch, prepareEdit,
          // =============== 
          OPTIONAL_POSITIONS, // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
          prefixOptions, // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤
          affiliationOptions, // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î
          professionOptions, // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û
          COL, // ‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°
          REG_STATUS, // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°
          registrationOptions, // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô         
          step, form, errors, workGroupData, currentDepts,
          onWorkGroupChange, formatPhone, formatLicense, formatTaxID,
          copyName, goToSummary, submitForm, confirmCancelEdit, resetForm,
          onDownloadClick, // ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
          canDownload, // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏Ø
          //+++ ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ú‡∏• ++++
          evalDay, evalForm, subItems, day1Questions, day2Questions, loadingEval,
          changeDay, resetEvaluationForm, submitEvaluation,         
          summaryFilter, summaryData, loadSummary, filteredQuestionsForSummary, navToSummary,
          getPercent, 
          isAssessmentTimerLoaded, assessmentTimer, canAccessAssessment,
          isDay1Active, isDay2Active, 
          // ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞ 
          currentPageSummary, paginatedComments, totalPagesSummary, changePageSummary, itemsPerPageSummary,
          //===== ‡∏à‡∏ö‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ======
          searchAdminQuery,    // ‡∏ï‡πâ‡∏≠‡∏á return ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ v-model ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
          filterRegType,       // ‡∏ï‡πâ‡∏≠‡∏á return ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ v-model ‡πÉ‡∏ô Dropdown ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
          // ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° ‡πÅ‡∏•‡∏∞ file ‡∏ß‡∏¥‡∏ó‡∏¢‡∏Å‡∏≤‡∏£  ====
          scheduleData, navToSchedule, downloadCount, handleDownload,
          openSpeakerModal, closeSpeakerModal, loadSchedule,
          hasImage, // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏£
          loadingSchedule, adminSheetUrl, onScheduleDownload,
          // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û Profile
          isCameraActive, profilePreview, webcam, cameraZoom,startWebcam, stopWebcam, capturePhoto, retakePhoto, 
          applyCrop, cancelCrop, cropModal, cropper,
          // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå
          handleFileUpload, openCropModal,
          runBatchCert, // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ì‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£
          externalDeadline, isExternalClosed, // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏ö‡∏ô
          handleSlipUpload, // ‡∏£‡∏π‡∏õ‡∏™‡∏•‡∏¥‡∏õ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
          // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏° ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£
          certDeadline, isCertTimeOpen, isCertDeadlineLoaded,
          // Scroll Buttons 
          scrollToTop,
          scrollToBottom,
        };
      }
    }).mount('#app');

  </script>

</body>
</html>
